{"version":3,"file":"dist/682.QWC2App.js","mappings":";8JAGIA,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,42BAqCtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,6DAA6D,MAAQ,GAAG,SAAW,uVAAuV,eAAiB,CAAC,u7BAAu7B,WAAa,MAE95C,S,0ZCjCIC,EAAU,CAAC,E,ujDAEfA,EAAQC,kBAAoB,IAC5BD,EAAQE,cAAgB,IACxBF,EAAQG,OAAS,SAAc,KAAM,QACrCH,EAAQI,OAAS,IACjBJ,EAAQK,mBAAqB,IAEhB,IAAI,IAASL,GAKJ,KAAW,IAAQM,QAAS,IAAQA,OCRzB,IAG3BC,EAAW,SAAAC,GAAA,SAAAD,IAAA,IAAAE,G,4FAAAC,CAAA,KAAAH,GAAA,QAAAI,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAsDZ,OAtDYC,EAAAR,EAAAS,EAAA,KAAAX,EAAA,GAAAY,OAAAL,IAAA,QAKL,CACJM,eAAgB,KAChBC,SAAU,IACbJ,EAAAR,EAAA,4BA4B2B,SAACa,GACzB,IAAMC,EAAOD,EAAGE,cAAcC,wBACxBC,GAAKJ,EAAGK,QAAUJ,EAAKK,MAAQL,EAAKM,MAAQ,EAAI,EAChDC,IAAMR,EAAGS,QAAUR,EAAKS,KAAOT,EAAKU,OAAS,EAAI,EACvDC,aAAazB,EAAK0B,uBAClB1B,EAAK0B,sBAAwBC,WAAW,kBAAM3B,EAAK4B,kBAAkBX,EAAGI,EAAE,EAAE,IAChF,GAACb,EAAAR,EAAA,oBACmB,SAACiB,EAAGI,GACpB,IAAMQ,EAAe7B,EAAK8B,MAAMC,aAAaC,qBAAqBf,EAAGI,GACrE,GAAIQ,EAAc,CACd,IAAMI,EAAIJ,EAAaK,MACvBlC,EAAKmC,SAAS,CAACxB,eAAgB,CAACsB,EAAEhB,EAAGgB,EAAEZ,EAAGY,EAAEG,IAChD,CACJ,GAAC5B,EAAAR,EAAA,cACa,SAACqC,GACPA,GACArC,EAAK8B,MAAMQ,mBAAmBD,EAAGE,aAEzC,GAACvC,CAAA,Q,qRAAAwC,CAAA1C,EAAAC,G,EAAAD,G,EAAA,EAAA2C,IAAA,oBAAAC,MA7CD,WAAoB,IAAAC,EAAA,KAChBC,KAAKd,MAAMC,aAAac,MAAMC,SAASC,iBAAiB,YAAaH,KAAKI,2BAC1EJ,KAAKd,MAAMC,aAAac,MAAME,iBAAiB,aAAc,WACzDJ,EAAKR,SAAS,CAACvB,SAAUqC,KAAKC,MAA+C,IAAzCP,EAAKb,MAAMC,aAAac,MAAMjC,UAAkB,KACxF,EACJ,GAAC,CAAA6B,IAAA,uBAAAC,MACD,WACIjB,aAAamB,KAAKlB,sBACtB,GAAC,CAAAe,IAAA,SAAAC,MACD,WACI,OACIS,EAAAA,cAAA,OAAKC,UAAU,kBAAkBC,IAAKT,KAAKU,aACvCH,EAAAA,cAAA,OAAKC,UAAU,4BACXD,EAAAA,cAAA,OAAKC,UAAU,8BAA8BG,MAAO,CAACnC,MAAOwB,KAAKY,MAAM5C,YACvEuC,EAAAA,cAAA,OAAKC,UAAU,kCAAkCR,KAAKY,MAAM5C,WAEhEuC,EAAAA,cAAA,OAAKC,UAAU,2BACfD,EAAAA,cAAA,OAAKC,UAAU,6BACTR,KAAKY,MAAM7C,gBAAkB,IAAI8C,IAAI,SAAAxC,GAAC,OAAIA,EAAEyC,QAAQ,EAAE,GAAEC,KAAK,MAEnER,EAAAA,cAAA,OAAKC,UAAU,8BACVR,KAAKd,MAAMC,aAAa6B,OAASC,EAAAA,EAAiBC,kBAAkBlB,KAAKd,MAAMC,aAAa6B,QAAQG,MAAQ,IAEjHZ,EAAAA,cAAA,OAAKC,UAAU,2BAG3B,M,6EAAC,CAnCY,CAASD,EAAAA,WAAe3C,EAAnCV,EAAW,YACM,CACfiC,aAAciC,IAAAA,OACd1B,mBAAoB0B,IAAAA,OAsD5B,SAAeC,EAAAA,EAAAA,IAAQ,iBAAO,CAAC,CAAC,EAAG,CAC/B3B,mBAAoBA,EAAAA,oBADxB,CAEGxC,G,iFCnEC,GAAU,CAAC,E,ovEAEf,GAAQN,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCF3B,IAGzBqE,GAAS,SAAAnE,GAAA,SAAAmE,IAAA,IAAAlE,G,4FAAAC,CAAA,KAAAiE,GAAA,QAAAhE,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GA2RV,OA3RUC,GAAAR,EAAAS,GAAA,KAAAyD,EAAA,GAAAxD,OAAAL,IAAA,QAKH,CACJ8D,SAAS,EACTC,eAAgB,CAAC,EACjBC,OAAQ,EACRC,OAAQ,EACRC,OAAQ,IACX/D,GAAAR,EAAA,sBA2CqB,WAClB,IAAMkC,EAAQ,IAAIsC,EAAAA,IAAQxE,EAAKwD,MAAMa,OAAQrE,EAAKwD,MAAMc,OAAQ,GAC1DG,EAAQzE,EAAKwD,MAAMe,OAAS,IAAMtB,KAAKyB,GACvCC,EAAS,IAAIH,EAAAA,IAAQvB,KAAK2B,IAAIH,GAAQxB,KAAK4B,IAAIJ,GAAQ,GACvDK,EAAY,IAAIC,EAAAA,IAChBC,EAAa,IAAID,EAAAA,IACvBD,EAAUG,8BAA8BN,EAAQzC,GAChD8C,EAAWC,8BAA8BN,EAAOO,gBAAgB,GAAIhD,GACpEiD,OAAOC,QAAQpF,EAAKwD,MAAMY,gBAAgBiB,QAAQ,SAAAC,GAAwB,IAAAC,E,05BAAAC,CAAAF,EAAA,GAAtBG,EAAQF,EAAA,GAAEG,EAAMH,EAAA,GAC1DI,EAAS,GACXD,EAAOvE,MACPwE,EAAOvG,KAAK0F,GAEZY,EAAOE,OACPD,EAAOvG,KAAK4F,GAEC,cAAbS,EACAzF,EAAK8B,MAAMC,aAAa0B,IAAIoC,eAAiBF,EAE7C3F,EAAK8B,MAAMC,aAAa+D,eAAeL,GAAUI,eAAiBF,CAE1E,GACA3F,EAAK8B,MAAMC,aAAac,MAAMkD,eAC9B/F,EAAKgG,eAAehG,EAAKwD,MAAMa,OAAQrE,EAAKwD,MAAMc,OAAQtE,EAAKwD,MAAMe,OACzE,GAAC/D,GAAAR,EAAA,qBACoB,WACjBmF,OAAOc,KAAKjG,EAAKwD,MAAMY,gBAAgBiB,QAAQ,SAAAI,GAC1B,cAAbA,EACAzF,EAAK8B,MAAMC,aAAa0B,IAAIoC,eAAiB,GAE7C7F,EAAK8B,MAAMC,aAAa+D,eAAeL,GAAUI,eAAiB,EAE1E,GACI7F,EAAK8B,MAAMoE,QACXlG,EAAKmG,gBAETnG,EAAK8B,MAAMC,aAAac,MAAMkD,cAClC,GAACvF,GAAAR,EAAA,eACc,WACXA,EAAK8B,MAAMC,aAAaqE,eAAe,kBAAmBpG,EAAKqG,QAC/DrG,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASxD,iBAAiB,SAAU/C,EAAKwG,oBAE3DxG,EAAK8B,MAAMC,aAAac,MAAM4D,SACtCC,WAAW3D,iBAAiB,cAAe/C,EAAK2G,WAC7D,GAACnG,GAAAR,EAAA,gBACe,WAAM,IAAA4G,EAAAC,EACyB,QAA3CD,EAAA5G,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,gBAAQ,IAAAK,GAAqB,QAArBC,EAA3CD,EAA6CE,2BAAmB,IAAAD,GAAhEA,EAAAE,KAAAH,EAAmE,SAAU5G,EAAKwG,oBAClFxG,EAAK8B,MAAMC,aAAaiF,kBAAkB,mBAC1ChH,EAAK8B,MAAMC,aAAac,MAAM4D,SAASC,WAAWI,oBAAoB,cAAe9G,EAAK2G,WAC9F,GAACnG,GAAAR,EAAA,aACY,SAACa,GACV,IAAMoG,EAAW,SAACC,GACd,IAAMpG,EAAOoG,EAAMC,OAAOnG,wBACpBC,GAAMiG,EAAMhG,QAAUJ,EAAKK,MAAQL,EAAKM,MAAS,EAAI,EACrDC,IAAO6F,EAAM5F,QAAUR,EAAKS,KAAOT,EAAKU,OAAU,EAAI,EAC5D,OAAO,IAAI4F,EAAAA,IAAQnG,EAAGI,EAC1B,EACMgG,EAASrH,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAC5CC,EAAY,IAAIC,EAAAA,IAGtB,GAFAD,EAAUE,cAAcP,EAASpG,GAAKwG,GACnBC,EAAUG,gBAAgBzH,EAAKqG,QAAQjG,OAAS,EACnE,CAGA,IAAMsH,GAAQ,IAAI3C,EAAAA,KAAQE,8BAA8B,IAAIT,EAAAA,IAAQ,EAAG,EAAG,GAAIxE,EAAKqG,OAAOsB,UACpFC,EAAWN,EAAUO,IAAIC,eAAeJ,EAAO,IAAIlD,EAAAA,KACnDuD,EAAW,IAAIX,EAAAA,IAAQpH,EAAKwD,MAAMa,OAAQrE,EAAKwD,MAAMc,QACrDG,EAAQzE,EAAKwD,MAAMe,OAAS,IAAMtB,KAAKyB,GACvCsD,EAAc,IAAIxD,EAAAA,IAAQvB,KAAK2B,IAAIH,GAAQxB,KAAK4B,IAAIJ,GAAQ,GAC5DwD,EAAa,SAACf,GAChBI,EAAUE,cAAcP,EAASC,GAAQG,GACzCK,EAAMzC,8BAA8B,IAAIT,EAAAA,IAAQ,EAAG,EAAG,GAAIxE,EAAKqG,OAAOsB,UACtE,IAAMO,EAAMZ,EAAUO,IAAIC,eAAeJ,EAAO,IAAIlD,EAAAA,KAC9C2D,EAAQH,EAAYI,QAAQlD,gBAC9B,IAAIV,EAAAA,KAAU6D,KAAKH,EAAII,IAAIV,IAAWW,IAAIP,IAE9ChI,EAAKmC,SAAS,CAACkC,OAAQ0D,EAAS9G,EAAIkH,EAAMlH,EAAGqD,OAAQyD,EAAS1G,EAAI8G,EAAM9G,IACxErB,EAAKgG,eAAe+B,EAAS9G,EAAIkH,EAAMlH,EAAG8G,EAAS1G,EAAI8G,EAAM9G,EAAGrB,EAAKwD,MAAMe,OAC/E,EACAvE,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASpC,SAAU,EACtDtD,EAAGyF,KAAKvD,iBAAiB,cAAekF,GACxCpH,EAAGyF,KAAKvD,iBAAiB,YAAa,WAClC/C,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASpC,SAAU,EACtDtD,EAAGyF,KAAKQ,oBAAoB,cAAemB,EAC/C,EAAG,CAACO,MAAM,GArBV,CAsBJ,GAAChI,GAAAR,EAAA,qBACoB,WACjB,IAAMyI,EAAezI,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOiB,QAClE3D,EAAQzE,EAAKwD,MAAMe,OAAS,IAAMtB,KAAKyB,GACvCgE,EAAM,IAAIlE,EAAAA,IAAQvB,KAAK4B,IAAIJ,IAASxB,KAAK2B,IAAIH,GAAQ,GACrDkE,EAAS,IAAInE,EAAAA,IAAQxE,EAAKwD,MAAMa,OAAQrE,EAAKwD,MAAMc,OAAQ,GAC3DsE,EAASD,EAAOE,IAAIH,EAAIxD,eAAeuD,EAAaH,IAAIK,GAAQJ,IAAIG,KAC1E1I,EAAKmC,SAAS,CAACkC,OAAQuE,EAAO3H,EAAGqD,OAAQsE,EAAOvH,IAChDrB,EAAKgG,eAAe4C,EAAO3H,EAAG2H,EAAOvH,EAAGrB,EAAKwD,MAAMe,OACvD,GAAC/D,GAAAR,EAAA,iBACgB,SAACiB,EAAGI,EAAGoD,GACpB,IAAM0C,EAAS,IAAI3C,EAAAA,IAAQvD,EAAGI,EAAG,GAC3ByH,EAAW9I,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASoB,WAAW5B,GACzE6B,EAAQ/F,KAAKgG,IAAI,EAAGH,EAAW,KAE/BI,EAAc,IAAIC,EAAAA,GAAYnJ,EAAK8B,MAAMC,aAAa6B,OAAQ3C,EAAGI,EAAG,GACpE+H,EAASpJ,EAAK8B,MAAMC,aAAa0B,IAAI4F,aAAa,CAACH,YAAAA,IACrD9G,EAAI,EACJgH,EAAOE,QAAQlJ,OAAS,IACxBgJ,EAAOE,QAAQC,KAAK,SAACC,EAAGC,GAAC,OAAKD,EAAEE,WAAaD,EAAEC,UAAU,GACzDtH,EAAIgH,EAAOE,QAAQ,GAAGK,WAG1B3J,EAAKqG,OAAOsB,SAAS1G,EAAIkG,EAAOlG,EAChCjB,EAAKqG,OAAOsB,SAAStG,EAAI8F,EAAO9F,EAChCrB,EAAKqG,OAAOsB,SAASvF,EAAIA,EACzBpC,EAAKqG,OAAOuD,SAASxH,GAAKqC,EAAQ,IAAMxB,KAAKyB,GAC7C1E,EAAKqG,OAAO2C,MAAMa,IAAIb,EAAOA,EAAOA,GACpChJ,EAAKqG,OAAOyD,mBAChB,GAACtJ,GAAAR,EAAA,aAeY,WACT,IAAM+B,EAAe/B,EAAK8B,MAAMC,aAC1BgI,EAAOC,GAAA,CAAIC,UAAW,CAACC,WAAW,EAAMC,MAAOC,EAAAA,EAAYC,GAAG,mBAAsBtI,EAAauI,cACjGC,EAAYpF,OAAOc,KAAK8D,GAASS,OAAO,SAAA/E,GAAQ,OAAIsE,EAAQtE,GAAUyE,SAAS,GACrF,OACI/G,EAAAA,cAAA,OAAKC,UAAU,iBAAiBqH,KAAK,QACjCtH,EAAAA,cAAA,OAAKC,UAAU,kBAAkBsH,QAAS1K,EAAK2K,eAC3CxH,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAM7K,EAAKwD,MAAMW,QAAU,UAAY,cAC7ChB,EAAAA,cAAA,YAAOiH,EAAAA,EAAYC,GAAG,+BAE1BlH,EAAAA,cAAA,OAAKC,UAAU,qBACV,CAAC,OAAQ,SAASK,IAAI,SAAAqH,GACnB,IAAMC,EAAY/K,EAAKwD,MAAMY,eACzB4G,EAAgB,UAChBC,GAAiB,EACfC,EAAiBX,EAAUY,OAAO,SAACC,EAAK9L,GAAE,IAAA+L,EAAA,OAAKD,GAAmB,QAAhBC,EAAGN,EAAUzL,UAAG,IAAA+L,OAAA,EAAbA,EAAgBP,GAAQ,EAAE,GAOrF,OANII,IAAmBX,EAAUnK,QAC7B4K,EAAgB,YAChBC,GAAiB,GACVC,EAAiB,IACxBF,EAAgB,YAGhB7H,EAAAA,cAAA,OAAKC,UAAU,oBAAoBX,IAAK,WAAaqI,GACjD3H,EAAAA,cAAA,OACIC,UAAU,0CACVsH,QAAS1K,EAAKwD,MAAMW,QAAU,kBAAMnE,EAAKsL,iBAAiBR,EAASP,EAAWU,EAAe,EAAG,KAChGd,MAAOC,EAAAA,EAAYC,GAAG,wBAEtBlH,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,0BAA0BmI,UAAWvL,EAAKwD,MAAMW,QAAS0G,KAAMG,IAC/E7H,EAAAA,cAAA,YAAOiH,EAAAA,EAAYC,GAAG,yBAEzBE,EAAU9G,IAAI,SAAAgC,GAAQ,IAAA+F,EAAAC,EAAAC,EAAA,OACnBvI,EAAAA,cAAA,OACIC,UAAU,iBACVX,IAAKgD,EACLiF,QAAS1K,EAAKwD,MAAMW,QAAU,kBAAMnE,EAAK2L,aAAab,EAASrF,EAAS,EAAG,KAC3E0E,MAA8B,QAAzBqB,EAAEzB,EAAQtE,GAAU0E,aAAK,IAAAqB,EAAAA,EAAI/F,GAElCtC,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,0BAA0BmI,UAAWvL,EAAKwD,MAAMW,QAAS0G,KAAyB,QAAnBY,EAAAV,EAAUtF,UAAS,IAAAgG,GAAnBA,EAAsBX,GAAW,YAAc,YAC9H3H,EAAAA,cAAA,YAA8B,QAA9BuI,EAAO3B,EAAQtE,GAAU0E,aAAK,IAAAuB,EAAAA,EAAIjG,GAChC,GAItB,IAEJtC,EAAAA,cAAA,OAAKC,UAAU,mBAAmBgH,EAAAA,EAAYC,GAAG,wBACjDlH,EAAAA,cAAA,SAAOC,UAAU,yBACbD,EAAAA,cAAA,aACIA,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAI,KACJA,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAACL,UAAWvL,EAAKwD,MAAMW,QAAS0H,SAAU,SAAA5K,GAAC,OAAIjB,EAAKmC,SAAS,CAACkC,OAAQpD,GAAG,EAAEyB,MAAO1C,EAAKwD,MAAMa,WAEjHlB,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAI,KACJA,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAACL,UAAWvL,EAAKwD,MAAMW,QAAS0H,SAAU,SAAAxK,GAAC,OAAIrB,EAAKmC,SAAS,CAACmC,OAAQjD,GAAG,EAAEqB,MAAO1C,EAAKwD,MAAMc,WAEjHnB,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAI,KACJA,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAACL,UAAWvL,EAAKwD,MAAMW,QAAS0H,SAAU,SAAArC,GAAC,OAAIxJ,EAAKmC,SAAS,CAACoC,OAAQiF,GAAG,EAAEsC,OAAO,IAAIpJ,MAAO1C,EAAKwD,MAAMe,aAMhJ,GAAC/D,GAAAR,EAAA,gBACe,WACZA,EAAKmC,SAAS,SAAAqB,GACV,IAAMuI,EAAW,CAAC5H,SAAUX,EAAMW,SAOlC,OANI4H,EAAS5H,UAET4H,EAAS1H,OAASrE,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOlG,EACrE8K,EAASzH,OAAStE,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAO9F,EACrE0K,EAASxH,QAAUvE,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASyF,oBAAsB/I,KAAKyB,GAAK,IAAM,IAElGqH,CACX,EACJ,GAACvL,GAAAR,EAAA,eACc,SAAC8K,EAASrF,GACrBzF,EAAKmC,SAAS,SAAAqB,GAAK,IAAAyI,EAAA,MAAK,CACpB7H,eAAc4F,GAAAA,GAAA,GACPxG,EAAMY,gBAAc,GAAA5D,GAAA,GACtBiF,EAAQuE,GAAAA,GAAA,GACFxG,EAAMY,eAAeqB,IAAS,GAAAjF,GAAA,GAChCsK,IAAyC,QAA/BmB,EAACzI,EAAMY,eAAeqB,UAAS,IAAAwG,GAA9BA,EAAiCnB,QAGxD,EACL,GAACtK,GAAAR,EAAA,mBACkB,SAAC8K,EAASP,EAAW7H,GACpC1C,EAAKmC,SAAS,SAAAqB,GAAK,MAAK,CACpBY,eAAgBmG,EAAUY,OAAO,SAACC,EAAK3F,GAAQ,OAAAuE,GAAAA,GAAA,GACxCoB,GAAG,GAAA5K,GAAA,GACLiF,EAAQuE,GAAAA,GAAA,GACFxG,EAAMY,eAAeqB,IAAS,GAAAjF,GAAA,GAChCsK,EAAUpI,KAAK,EAEpB,CAAC,GACR,EACL,GAAC1C,CAAA,Q,sRAAAwC,CAAA0B,EAAAnE,G,EAAAmE,G,EAAA,EAAAzB,IAAA,oBAAAC,MA/QD,WAAoB,IAAAC,EAAA,MACD,IAAIuJ,EAAAA,GACZC,K,ypTAAiB,SAACC,GACrBA,EAAKvJ,MAAMwJ,SAAS,SAACC,GACbA,EAAOC,SACPD,EAAOE,SAASC,WAAY,EAC5BH,EAAOE,SAASE,YAAa,EAErC,GACAN,EAAKvJ,MAAM8J,YAAc,QAEzB,IAAMC,EAAYR,EAAKvJ,MAAMuF,QAC7BwE,EAAUjF,SAAStG,GAAK,EACxBuL,EAAUhD,SAASxH,GAAM,GAAMa,KAAKyB,GACpC,IAAMmI,EAAaT,EAAKvJ,MAAMuF,QAC9ByE,EAAWlF,SAAStG,EAAI,EACxBwL,EAAWjD,SAASxH,EAAI,GAAMa,KAAKyB,GACnC/B,EAAK0D,OAAS,IAAIyG,EAAAA,IAClBnK,EAAK0D,OAAOwC,IAAI+D,GAChBjK,EAAK0D,OAAOwC,IAAIgE,EACpB,EACJ,GAAC,CAAApK,IAAA,uBAAAC,MACD,WACIE,KAAKmK,qBACLnK,KAAKyD,OAAOgG,SAAS,SAAAW,GAAG,IAAAC,EAAA,OAAe,QAAfA,EAAID,EAAIE,eAAO,IAAAD,OAAA,EAAXA,EAAAlG,KAAAiG,EAAe,EAC/C,GAAC,CAAAvK,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GACtBxK,KAAKY,MAAMW,SAAWvB,KAAKd,MAAMoE,SAAWiH,EAAUjH,OACtDtD,KAAKyK,eACEzK,KAAKY,MAAMW,UAAYvB,KAAKd,MAAMoE,QAAUiH,EAAUjH,QAC7DtD,KAAKuD,gBAELvD,KAAKY,MAAMW,SAAWvB,KAAKY,QAAU4J,GACjCxK,KAAKd,MAAMoE,SAAWkH,EAAUjJ,SAChCvB,KAAKyK,eAGTzK,KAAK0K,wBACG1K,KAAKY,MAAMW,SAAWiJ,EAAUjJ,SACxCvB,KAAKmK,oBAEb,GAAC,CAAAtK,IAAA,SAAAC,MAoHD,WAAS,IAAA6K,EAAA,KACL,OACIpK,EAAAA,cAAA,WACIA,EAAAA,cAACqK,EAAAA,EAAO,CAAC3C,KAAK,SAASvL,GAAG,YACtB6K,MAAOC,EAAAA,EAAYC,GAAG,2BACtBjJ,MAAM,QAEL,iBAAO,CACJqM,KAAMF,EAAKG,aACd,GAIjB,M,8EAAC,CAtLU,CAASvK,EAAAA,WAAe3C,GAAjC0D,GAAS,YACQ,CACfgC,OAAQlC,IAAAA,KACRjC,aAAciC,IAAAA,SA2RtB,UAAeC,EAAAA,EAAAA,IAAQ,SAAAT,GAAK,MAAK,CAC7B0C,OAA0B,cAAlB1C,EAAMmK,KAAKrO,GACtB,EAAG,CAEJ,EAJA,CAIG4E,I,0oEC1SiD,IAG/B0J,GAAY,SAAA7N,GAAA,SAAA6N,IAAA,IAAA5N,G,4FAAAC,CAAA,KAAA2N,GAAA,QAAA1N,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAuG5B,OAvG4BC,GAAAR,E,yYAAAS,CAAA,KAAAmN,EAAA,GAAAlN,OAAAL,IAAA,iBA0CZ,SAACQ,GACd,IAAMC,EAAOD,EAAGsG,OAAOnG,wBACjBC,GAAMJ,EAAGK,QAAUJ,EAAKK,MAAQL,EAAKM,MAAS,EAAI,EAClDC,IAAOR,EAAGS,QAAUR,EAAKS,KAAOT,EAAKU,OAAU,EAAI,EACnDK,EAAe7B,EAAK8B,MAAMC,aAAaC,qBAAqBf,EAAGI,GACrE,GAAIQ,EAAc,CACd,IAAMI,EAAIJ,EAAaK,MACvBlC,EAAK6N,WAAWC,UAAU,CAAC7L,GAC/B,MACIjC,EAAK6N,WAAWC,UAAU,IAE9B9N,EAAK8B,MAAMC,aAAac,MAAMkD,cAClC,GAACvF,GAAAR,EAAA,qBACoB,SAACa,GAClB,GAAkB,IAAdA,EAAGkN,OAAc,CACjB,IAAMtH,EAAWzG,EAAK8B,MAAMC,aAAac,MAAM4D,SAC/CA,EAASC,WAAW3D,iBAAiB,YAAa/C,EAAKgO,UAAW,CAACxF,MAAM,IACzE/B,EAASC,WAAW3D,iBAAiB,cAAe,WAChD0D,EAASC,WAAWI,oBAAoB,YAAa9G,EAAKgO,UAC9D,EACJ,CACJ,GAACxN,GAAAR,EAAA,YACW,WACR,IAAMiO,EAAYjO,EAAK8B,MAAMC,aAAa+D,eAAe9F,EAAK8B,MAAMoM,aACpE,GAAsC,IAAlClO,EAAK6N,WAAWM,OAAO/N,QAAiB6N,EAA5C,CAGA,IAAIG,EAAW,KACTC,EAAIrO,EAAK8B,MAAMwM,SACrB,GAA4B,WAAxBtO,EAAK8B,MAAMyM,SACXH,EAAW,IAAII,EAAAA,IAAaH,EAAGA,EAAGA,QAC/B,GAA4B,UAAxBrO,EAAK8B,MAAMyM,SAAsB,CACxC,IAAME,EAAQ,IAAIC,EAAAA,IAClBD,EAAME,QAAQ,GAAMN,GAAI,GAAMA,GAC9BI,EAAMG,OAAO,GAAMP,GAAI,GAAMA,GAC7BI,EAAMG,OAAO,GAAMP,EAAG,GAAMA,GAC5BI,EAAMG,QAAQ,GAAMP,GAAI,GAAMA,GAC9BD,EAAW,IAAIS,EAAAA,IAAgBJ,EAAO,CAACK,MAAOT,GAClD,KAAmC,aAAxBrO,EAAK8B,MAAMyM,SAClBH,EAAW,IAAIW,EAAAA,IAAkB,GAAMV,EAAG,GAAMA,EAAGA,GACpB,YAAxBrO,EAAK8B,MAAMyM,UAGlBH,GAFAA,EAAW,IAAIY,EAAAA,IAAc,GAAMX,EAAIpL,KAAKgM,KAAK,GAAIZ,EAAG,EAAG,GAAG,EAAOpL,KAAKyB,GAAK,IAE3DwK,gBACXC,uBACsB,WAAxBnP,EAAK8B,MAAMyM,SAClBH,EAAW,IAAIgB,EAAAA,IAAgB,GAAMf,GACN,SAAxBrO,EAAK8B,MAAMyM,WAClBH,EAAW,IAAIY,EAAAA,IAAc,GAAMX,EAAGA,IAE1C,GAAID,EAAU,CACVA,EAASiB,QAAQpM,KAAKyB,GAAK,GAC3B,IAAM8H,EAAW,IAAI8C,EAAAA,IAAqB,CAACC,MAAKC,GAAMC,EAAAA,IAAKC,GAAI1P,EAAK8B,MAAMyN,MAAM9L,IAAI,SAAAkM,GAAC,OAAIA,EAAI,GAAG,OAC1FC,EAAO,IAAIC,EAAAA,IAAMzB,EAAU5B,GACjCyB,EAAUpF,IAAI+G,GACdA,EAAKjI,SAASU,KAAKrI,EAAK6N,WAAWM,OAAO,IAC1CyB,EAAKjI,SAASvF,GAAK,GAAMiM,EACzBuB,EAAK9F,oBACL9J,EAAK8B,MAAMC,aAAac,MAAMkD,eAC9B/F,EAAK8B,MAAMgO,cAAcF,EAC7B,CAlCA,CAmCJ,GAAC5P,CAAA,Q,sRAAAwC,CAAAoL,EAAA7N,G,EAAA6N,G,EAAA,EAAAnL,IAAA,oBAAAC,MA5FD,WACIE,KAAKiL,WAAa,IAAIkC,GAAAA,GAAU,CAC5BC,cAAc,IAElBpN,KAAKd,MAAMC,aAAaqE,eAAe,eAAgBxD,KAAKiL,YAC5D,IAAMpH,EAAW7D,KAAKd,MAAMC,aAAac,MAAM4D,SAC/CA,EAASC,WAAW3D,iBAAiB,cAAeH,KAAKqN,gBACzDxJ,EAASC,WAAW3D,iBAAiB,cAAeH,KAAKsN,mBAC7D,GAAC,CAAAzN,IAAA,uBAAAC,MACD,WACIE,KAAKd,MAAMC,aAAaiF,kBAAkB,gBAC1C,IAAMP,EAAW7D,KAAKd,MAAMC,aAAac,MAAM4D,SAC/CA,EAASC,WAAWI,oBAAoB,cAAelE,KAAKqN,gBAC5DxJ,EAASC,WAAWI,oBAAoB,cAAelE,KAAKsN,mBAChE,GAAC,CAAAzN,IAAA,SAAAC,MACD,WACI,OACIS,EAAAA,cAAA,OAAKC,UAAU,yBACXD,EAAAA,cAAA,YACIA,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,yBAAyByH,KAAK,MAAMsF,KAAK,UACzDhN,EAAAA,cAACiN,GAAAA,EAAW,CAAC3L,OAAO,EAAO8K,MAAO3M,KAAKd,MAAMyN,MAAOc,eAAgBzN,KAAKd,MAAMwO,gBAEnFnN,EAAAA,cAAA,YACIA,EAAAA,cAAA,YAAOiH,EAAAA,EAAYC,GAAG,kBAAkB,MACxClH,EAAAA,cAACyI,EAAAA,EAAW,CAAC3C,IAAK,GAAIsH,IAAK,EAAGC,QAAM,EAChC3E,SAAUjJ,KAAKd,MAAM2O,gBACrB/N,MAAOE,KAAKd,MAAMwM,YAItC,M,8EAAC,CAzC4B,CAASnL,EAAAA,WAAe3C,GAApCoN,GAAY,YACV,CACfU,SAAUtK,IAAAA,OACVyM,gBAAiBzM,IAAAA,KACjBuL,MAAOvL,IAAAA,MACPsM,aAActM,IAAAA,KACdkK,YAAalK,IAAAA,OACbuK,SAAUvK,IAAAA,OACV8L,cAAe9L,IAAAA,KACfjC,aAAciC,IAAAA,S,w1ECd8B,IAG/B0M,GAAc,SAAA3Q,GAY/B,SAAA2Q,EAAY5O,GAAO,IAAA9B,EAG2D,O,4FAH3DC,CAAA,KAAAyQ,GACFlQ,GAAbR,EAAAS,GAAA,KAAAiQ,EAAA,CAAM5O,IAAO,QANT,CACJoG,IAAK,CAAC,EAAG,EAAG,GACZyI,IAAK,CAAC,EAAG,EAAG,GACZ3H,MAAO,CAAC,EAAG,EAAG,KACjBxI,GAAAR,EAAA,wBAuDuB,WAChBA,EAAK8B,MAAM8O,eACX5Q,EAAKmC,SAAS,CACV+F,IAAKlI,EAAK8B,MAAM8O,eAAejJ,SAASkJ,UACxCF,IAAK3Q,EAAK8B,MAAM8O,eAAehH,SAASiH,UAAUC,MAAM,EAAG,GAAGrN,IAAI,SAAAxC,GAAC,OAAIA,EAAIgC,KAAKyB,GAAK,GAAG,GACxFsE,MAAOhJ,EAAK8B,MAAM8O,eAAe5H,MAAM6H,YAG3C7Q,EAAKmC,SAAS,CACV+F,IAAK,CAAC,EAAG,EAAG,GACZyI,IAAK,CAAC,EAAG,EAAG,GACZ3H,MAAO,CAAC,EAAG,EAAG,IAG1B,GAACxI,GAAAR,EAAA,iBACgB,SAAC+Q,EAAKrO,GAAU,IAAAsO,EACvBpI,EAAM8G,GAAO1P,EAAKwD,MAAM0E,KAC9BU,EAAOmI,GAAOrO,GACdsO,EAAAhR,EAAK8B,MAAM8O,eAAejJ,UAASkC,IAAGoH,MAAAD,EAAAtB,GAAI9G,IAC1C5I,EAAKkR,QACT,GAAC1Q,GAAAR,EAAA,iBACgB,SAAC+Q,EAAKrO,GAAU,IAAAyO,EACvBC,EAAM1B,GAAO1P,EAAKwD,MAAMmN,KAC9BS,EAAOL,GAAOrO,GACdyO,EAAAnR,EAAK8B,MAAM8O,eAAehH,UAASC,IAAGoH,MAAAE,EAAAzB,GAC/B0B,EAAO3N,IAAI,SAAAxC,GAAC,OAAIA,EAAI,IAAMgC,KAAKyB,EAAE,IAAChE,OAAA,CACrCV,EAAK8B,MAAM8O,eAAehH,SAASyH,SAEvCrR,EAAKkR,QACT,GAAC1Q,GAAAR,EAAA,cACa,SAAC+Q,EAAKrO,GAAU,IAAA4O,EACpBC,EAAQ7B,GAAO1P,EAAKwD,MAAMwF,OAChCuI,EAASR,GAAOrO,GAChB4O,EAAAtR,EAAK8B,MAAM8O,eAAe5H,OAAMa,IAAGoH,MAAAK,EAAA5B,GAAI6B,IACvCvR,EAAKkR,QACT,GAAC1Q,GAAAR,EAAA,SACQ,WACLA,EAAK8B,MAAM8O,eAAe9G,oBAC1B9J,EAAK8B,MAAM0P,kBAAkBC,YAAY3H,oBACzC9J,EAAK0R,wBACL1R,EAAK8B,MAAMC,aAAac,MAAMkD,cAClC,GA7FI/F,EAAKqC,GAAKsP,SAASC,cAAc,OACjC5R,EAAK8B,MAAMC,aAAac,MAAMC,SAAS+O,cAAcC,YAAY9R,EAAKqC,IAAIrC,CAC9E,CAAC,O,sRAAAwC,CAAAkO,EAAA3Q,G,EAAA2Q,G,EAAA,EAAAjO,IAAA,oBAAAC,MACD,WACIE,KAAKd,MAAM0P,kBAAkBzO,iBAAiB,SAAUH,KAAK8O,uBAC7D9O,KAAK8O,uBACT,GAAC,CAAAjP,IAAA,qBAAAC,MACD,SAAmByK,GACXvK,KAAKd,MAAM8O,iBAAmBzD,EAAUyD,gBACxChO,KAAK8O,uBAEb,GAAC,CAAAjP,IAAA,uBAAAC,MACD,WACIE,KAAKd,MAAMC,aAAac,MAAMC,SAAS+O,cAAcE,YAAYnP,KAAKP,IACtEO,KAAKd,MAAM0P,kBAAkB1K,oBAAoB,SAAUlE,KAAK8O,sBACpE,GAAC,CAAAjP,IAAA,SAAAC,MACD,WAAS,IAAAC,EAAA,KACCuF,EAAMtF,KAAKY,MAAM0E,IACjByI,EAAM/N,KAAKY,MAAMmN,IACjB3H,EAAQpG,KAAKY,MAAMwF,MACnBuC,GAAY3I,KAAKd,MAAM8O,eACvBoB,EACF7O,EAAAA,cAAC8O,GAAAA,EAAgB,CAACC,WAAS,EAACrH,KAAK,eAAesH,aAAc,IAAKC,UAAW,EAC1EC,QAASzP,KAAKd,MAAMwQ,mBAAoBC,YAAU,EAACpI,MAAOC,EAAAA,EAAYC,GAAG,wBACzElH,EAAAA,cAAA,OAAKC,UAAU,4BAA4BqH,KAAK,QAC5CtH,EAAAA,cAAA,aACIA,EAAAA,cAAA,aACIA,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAKiH,EAAAA,EAAYC,GAAG,oBACpBlH,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAA5K,GAAC,OAAI0B,EAAK8P,eAAe,EAAGxR,EAAE,EAAEyB,MAAOwF,EAAI,MACvG/E,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAAxK,GAAC,OAAIsB,EAAK8P,eAAe,EAAGpR,EAAE,EAAEqB,MAAOwF,EAAI,MACvG/E,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAAzJ,GAAC,OAAIO,EAAK8P,eAAe,EAAGrQ,EAAE,EAAEM,MAAOwF,EAAI,OAE3G/E,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAKiH,EAAAA,EAAYC,GAAG,oBACpBlH,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAA5K,GAAC,OAAI0B,EAAK+P,eAAe,EAAGzR,EAAE,EAAE6K,OAAO,IAAIpJ,MAAOiO,EAAI,MAClHxN,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAAxK,GAAC,OAAIsB,EAAK+P,eAAe,EAAGrR,EAAE,EAAEyK,OAAO,IAAIpJ,MAAOiO,EAAI,MAClHxN,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAAzJ,GAAC,OAAIO,EAAK+P,eAAe,EAAGtQ,EAAE,EAAE0J,OAAO,IAAIpJ,MAAOiO,EAAI,OAEtHxN,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAKiH,EAAAA,EAAYC,GAAG,oBACpBlH,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAA5K,GAAC,OAAI0B,EAAKgQ,YAAY,EAAG1R,EAAE,EAAEyB,MAAOsG,EAAM,MACtG7F,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAAxK,GAAC,OAAIsB,EAAKgQ,YAAY,EAAGtR,EAAE,EAAEqB,MAAOsG,EAAM,MACtG7F,EAAAA,cAAA,UAAIA,EAAAA,cAACyI,EAAAA,EAAW,CAAC4G,SAAU,EAAGjH,SAAUA,EAAUM,SAAU,SAAAzJ,GAAC,OAAIO,EAAKgQ,YAAY,EAAGvQ,EAAE,EAAEM,MAAOsG,EAAM,WAO9H,OAAO4J,GAAAA,aAAsBZ,EAAUpP,KAAKP,GAChD,M,8EAAC,CAjE8B,CAASc,EAAAA,W,srDAAe3C,GAAtCkQ,GAAc,YACZ,CACf3O,aAAciC,IAAAA,OACd4M,eAAgB5M,IAAAA,OAChBsO,mBAAoBtO,IAAAA,KACpBwN,kBAAmBxN,IAAAA,SCNmB,IAGzB6O,GAAU,SAAA9S,GAAA,SAAA8S,IAAA,IAAA7S,G,4FAAAC,CAAA,KAAA4S,GAAA,QAAA3S,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GA2I1B,OA3I0BC,GAAAR,EAAAS,GAAA,KAAAoS,EAAA,GAAAnS,OAAAL,IAAA,QASnB,CACJyS,KAAM,YACNC,cAAc,IACjBvS,GAAAR,EAAA,uBAoFsB,SAACa,GACpB,GAAkB,IAAdA,EAAGkN,SAAiB/N,EAAKwR,kBAAkBwB,SAAU,CACrD,IAAMvM,EAAWzG,EAAK8B,MAAMC,aAAac,MAAM4D,SAC/CA,EAASC,WAAW3D,iBAAiB,YAAa/C,EAAKiT,YAAa,CAACzK,MAAM,IAC3E/B,EAASC,WAAW3D,iBAAiB,cAAe,WAChD0D,EAASC,WAAWI,oBAAoB,YAAa9G,EAAKiT,YAC9D,EACJ,CACJ,GAACzS,GAAAR,EAAA,cACa,SAACa,GACX,IAAMC,EAAOD,EAAGsG,OAAOnG,wBACjBC,GAAMJ,EAAGK,QAAUJ,EAAKK,MAAQL,EAAKM,MAAS,EAAI,EAClDC,IAAOR,EAAGS,QAAUR,EAAKS,KAAOT,EAAKU,OAAU,EAAI,EACnDK,EAAe7B,EAAK8B,MAAMC,aAAaC,qBAAqBf,EAAGI,GACrE,GAAIQ,EAAc,CAId,IAFA,IAAMyK,EAASzK,EAAayK,OACtB2B,EAAYjO,EAAK8B,MAAMC,aAAa+D,eAAe9F,EAAK8B,MAAMoM,aAC3DgF,EAAS5G,EAAO4G,OAAQA,EAAQA,EAASA,EAAOA,OACrD,GAAIA,IAAWjF,EAEX,YADAjO,EAAK8B,MAAMqR,aAAa7G,GAIhCtM,EAAK8B,MAAMqR,aAAa,KAC5B,CACJ,GAAC3S,GAAAR,EAAA,wBACuB,WACpBA,EAAKwR,kBAAkBC,YAAY3H,oBACnC9J,EAAK8B,MAAMC,aAAac,MAAMkD,cAClC,GAACvF,GAAAR,EAAA,cACa,WAAM,IAAAgR,EAAAG,EACS,QAAzBH,EAAAhR,EAAK8B,MAAM8O,sBAAc,IAAAI,GAAmB,QAAnBG,EAAzBH,EAA2BlH,yBAAiB,IAAAqH,GAA5CA,EAAApK,KAAAiK,GACAhR,EAAKwR,kBAAkBC,YAAY3H,oBACnC9J,EAAK8B,MAAMC,aAAac,MAAMkD,cAClC,GAACvF,GAAAR,EAAA,YACW,SAACa,GACM,WAAXA,EAAG4B,KACHzC,EAAKwR,kBAAkB4B,OAE/B,GAAC5S,GAAAR,EAAA,qBACoB,WACjBA,EAAKmC,SAAS,SAAAqB,GAAK,MAAK,CAACuP,cAAevP,EAAMuP,aAAa,EAC/D,GAAC/S,CAAA,Q,sRAAAwC,CAAAqQ,EAAA9S,G,EAAA8S,G,EAAA,EAAApQ,IAAA,oBAAAC,MA9HD,WAAoB,IAAAC,EAAA,KACV0E,EAASzE,KAAKd,MAAMC,aAAac,MAAMyD,KAAKe,OAC5CZ,EAAW7D,KAAKd,MAAMC,aAAac,MAAM4D,SAC/C7D,KAAK4O,kBAAoB,IAAI6B,GAAAA,GAAmBhM,EAAQZ,EAASC,YACjE9D,KAAKd,MAAMC,aAAac,MAAMgG,IAAIjG,KAAK4O,kBAAkBC,aACzD7O,KAAK4O,kBAAkB8B,QAAQ1Q,KAAKY,MAAMsP,MAC1ClQ,KAAK4O,kBAAkBzO,iBAAiB,SAAUH,KAAK2Q,aACvD3Q,KAAK4O,kBAAkBzO,iBAAiB,UAAWH,KAAK2Q,aACxD3Q,KAAK4O,kBAAkBzO,iBAAiB,mBAAoB,SAACmE,GACzDvE,EAAKb,MAAMC,aAAac,MAAMyD,KAAKC,SAASpC,SAAW+C,EAAMxE,KACjE,GACA+D,EAASC,WAAW3D,iBAAiB,cAAeH,KAAK4Q,sBACzD/M,EAASC,WAAW3D,iBAAiB,UAAWH,KAAK6Q,WACjD7Q,KAAKd,MAAM8O,iBACXhO,KAAK4O,kBAAkBkC,OAAO9Q,KAAKd,MAAM8O,gBACzChO,KAAK4O,kBAAkBC,YAAY3H,oBACnClH,KAAKd,MAAMwO,aAAa1N,KAAKd,MAAM8O,eAAepE,SAAS+C,MAAMsB,UAAUpN,IAAI,SAAAkM,GAAC,OAAQ,IAAJA,CAAO,KAE/F/M,KAAKd,MAAMC,aAAac,MAAMyD,KAAKC,SAASxD,iBAAiB,SAAUH,KAAK+Q,uBAC5E/Q,KAAKd,MAAMC,aAAac,MAAMkD,cAClC,GAAC,CAAAtD,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GAiB6C,IAAAkE,EAhBnE1O,KAAKd,MAAM8O,iBAAmBzD,EAAUyD,iBACpCzD,EAAUyD,gBACVhO,KAAK4O,kBAAkBoC,SAEvBhR,KAAKd,MAAM8O,iBACXhO,KAAK4O,kBAAkBkC,OAAO9Q,KAAKd,MAAM8O,gBACzChO,KAAKd,MAAMwO,aAAa1N,KAAKd,MAAM8O,eAAepE,SAAS+C,MAAMsB,UAAUpN,IAAI,SAAAkM,GAAC,OAAQ,IAAJA,CAAO,KAE/F/M,KAAK4O,kBAAkBC,YAAY3H,oBACnClH,KAAKd,MAAMC,aAAac,MAAMkD,gBAE9BnD,KAAKY,MAAMsP,OAAS1F,EAAU0F,OAC9BlQ,KAAK4O,kBAAkB8B,QAAQ1Q,KAAKY,MAAMsP,MAC1ClQ,KAAK4O,kBAAkBC,YAAY3H,oBACnClH,KAAKd,MAAMC,aAAac,MAAMkD,gBAE9BnD,KAAKd,MAAMyN,QAAUpC,EAAUoC,OAAS3M,KAAKd,MAAM8O,kBACnDU,EAAA1O,KAAKd,MAAM8O,eAAepE,SAAS+C,OAAMsE,OAAM5C,MAAAK,E,ynBAAA5B,CAAI9M,KAAKd,MAAMyN,MAAM9L,IAAI,SAAAkM,GAAC,OAAIA,EAAI,GAAG,KACpF/M,KAAKd,MAAMC,aAAac,MAAMkD,eAEtC,GAAC,CAAAtD,IAAA,uBAAAC,MACD,WACIE,KAAK4O,kBAAkBoC,SACvBhR,KAAKd,MAAMC,aAAac,MAAMiR,OAAOlR,KAAK4O,kBAAkBC,aAC5D7O,KAAK4O,kBAAkBtE,UACvB,IAAMxG,EAAa9D,KAAKd,MAAMC,aAAac,MAAM4D,SAASC,WAC1D9D,KAAKd,MAAMC,aAAac,MAAMyD,KAAKC,SAASO,oBAAoB,SAAUlE,KAAK+Q,uBAC/EjN,EAAWI,oBAAoB,cAAelE,KAAK4Q,sBACnD9M,EAAWI,oBAAoB,UAAWlE,KAAK6Q,WAC/C7Q,KAAKd,MAAMC,aAAac,MAAMkD,cAClC,GAAC,CAAAtD,IAAA,SAAAC,MACD,WAAS,IAAA6K,EAAA,KACCwG,EAAc,CAChB,CAACtR,IAAK,YAAasB,MAAOqG,EAAAA,EAAYC,GAAG,qBACzC,CAAC5H,IAAK,QAASsB,MAAOqG,EAAAA,EAAYC,GAAG,iBACrC,CAAC5H,IAAK,SAAUsB,MAAOqG,EAAAA,EAAYC,GAAG,mBAEpC2J,EAAe,CACjB,CAACvR,IAAK,eAAgBwR,QAAS7J,EAAAA,EAAYC,GAAG,uBAAwBQ,KAAM,iBAEhF,OACI1H,EAAAA,cAAA,OAAKC,UAAU,yBACXD,EAAAA,cAAA,YACIA,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,yBAAyByH,KAAK,MAAMsF,KAAK,UACzDhN,EAAAA,cAACiN,GAAAA,EAAW,CAAC3L,OAAO,EAAO8K,MAAO3M,KAAKd,MAAMyN,MAAOc,eAAgBzN,KAAKd,MAAMwO,gBAEnFnN,EAAAA,cAAA,YACIA,EAAAA,cAAC+Q,GAAAA,EAAS,CAAChO,OAAQtD,KAAKY,MAAMsP,KAAMqB,QAASJ,EAAarJ,QAAS,SAAAoI,GAAI,OAAIvF,EAAKpL,SAAS,CAAC2Q,KAAAA,GAAM,KAEpG3P,EAAAA,cAAA,QAAMC,UAAU,mBACZD,EAAAA,cAAC+Q,GAAAA,EAAS,CAAChO,OAAQtD,KAAKY,MAAMuP,aAAe,eAAiB,KAAMoB,QAASH,EAActJ,QAAS9H,KAAK0P,sBAE5G1P,KAAKY,MAAMuP,aACR5P,EAAAA,cAACuN,GAAc,CACX3O,aAAca,KAAKd,MAAMC,aAAc6O,eAAgBhO,KAAKd,MAAM8O,eAClE0B,mBAAoB1P,KAAK0P,mBAAoBd,kBAAmB5O,KAAK4O,oBAEzE,KAGhB,M,8EAAC,CA/F0B,CAASrO,EAAAA,WAAe3C,GAAlCqS,GAAU,YACR,CACftD,MAAOvL,IAAAA,MACPsM,aAActM,IAAAA,KACdkK,YAAalK,IAAAA,OACbmP,aAAcnP,IAAAA,KACdjC,aAAciC,IAAAA,OACd4M,eAAgB5M,IAAAA,S,gBChBpB,GAAU,CAAC,E,mlFAEf,GAAQxE,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCH9B,IAEPuU,GAAM,SAAArU,GAAA,SAAAqU,IAAA,IAAApU,G,4FAAAC,CAAA,KAAAmU,GAAA,QAAAlU,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAkJtB,OAlJsBC,GAAAR,EAAAS,GAAA,KAAA2T,EAAA,GAAA1T,OAAAL,IAAA,QAIf,CACJgU,OAAQ,KACR/F,SAAU,GACViB,MAAO,CAAC,IAAK,IAAO,EAAG,GACvBhB,SAAU,KACVL,YAAa,GACb0C,eAAgB,OACnBpQ,GAAAR,EAAA,SACQ,WAEL,IAAMiO,EAAY9I,OAAOC,QAAQpF,EAAK8B,MAAMC,aAAauI,cAAcgK,KAAK,SAAAhP,GAAoB,IAAAC,EAAAC,GAAAF,EAAA,GAC5F,OAD6EC,EAAA,IAChD,IADyDA,EAAA,GACvE0I,SACnB,QACkBsG,IAAdtG,EACAjO,EAAKwU,aAAapK,EAAAA,EAAYC,GAAG,oBAEjCrK,EAAKmC,SAAS,CAAC+L,YAAaD,EAAU,KAE1CjO,EAAKmC,SAAS,CAACkS,OAAQ,QAC3B,GAAC7T,GAAAR,EAAA,SACQ,WAELmF,OAAOC,QAAQpF,EAAK8B,MAAMC,aAAauI,cAAcE,OAAO,SAAAiK,GAAyB,IAAAC,EAAAlP,GAAAiP,EAAA,GACjF,OADkEC,EAAA,IACrC,IAD8CA,EAAA,GAC5DzG,SACnB,GAAG5I,QAAQ,SAAAsP,GAAyB,IAAAC,EAAApP,GAAAmP,EAAA,GAAvBlP,EAAQmP,EAAA,GAASA,EAAA,GAEK,IADhB5U,EAAK8B,MAAMC,aAAa+D,eAAeL,GAC3CoP,SAASzU,QAChBJ,EAAK8B,MAAMC,aAAaiF,kBAAkBvB,EAElD,EACJ,GAACjF,GAAAR,EAAA,kBACiB,WACd,IAAM8U,EAAU1K,EAAAA,EAAYC,GAAG,yBAEzB0K,EAAOC,OAAOF,GAChBC,GACA/U,EAAKwU,aAAaO,EAE1B,GAACvU,GAAAR,EAAA,eACc,SAAC+U,GACZ,IAAMtP,GAAWwP,EAAAA,GAAAA,KACX1V,EAAU,CACZ0O,WAAW,EACX/D,WAAW,EACXC,MAAO4K,GAEX/U,EAAK8B,MAAMC,aAAaqE,eAAeX,EAAU,IAAIqH,EAAAA,IAASvN,GAC9DS,EAAKmC,SAAS,CAAC+L,YAAazI,GAChC,GAACjF,GAAAR,EAAA,aACY,WACT,IAAMkV,EAAqC,WAAtBlV,EAAKwD,MAAM6Q,OAAsBrU,EAAKwD,MAAM+K,SAAWvO,EAAKwD,MAAM6Q,OACjFc,EAAc,CAChB,CAAC1S,IAAK,SAAUwR,QAAS7J,EAAAA,EAAYC,GAAG,iBAAkBQ,KAAM,SAAUuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,WAC7G,CAAC9L,IAAK,QAASwR,QAAS7J,EAAAA,EAAYC,GAAG,gBAAiBQ,KAAM,QAASuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,UAC1G,CAAC9L,IAAK,WAAYwR,QAAS7J,EAAAA,EAAYC,GAAG,mBAAoBQ,KAAM,WAAYuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,aACnH,CACI,CAAC9L,IAAK,UAAWwR,QAAS7J,EAAAA,EAAYC,GAAG,kBAAmBQ,KAAM,UAAWuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,YAChH,CAAC9L,IAAK,SAAUwR,QAAS7J,EAAAA,EAAYC,GAAG,iBAAkBQ,KAAM,SAAUuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,WAC7G,CAAC9L,IAAK,OAAQwR,QAAS7J,EAAAA,EAAYC,GAAG,eAAgBQ,KAAM,OAAQuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,WAGzGwF,EAAc,CAChB,CAACtR,IAAK,OAAQwR,QAAS7J,EAAAA,EAAYC,GAAG,eAAgBQ,KAAM,WAAYuK,KAAM,CAACf,OAAQ,OAAQ9F,SAAU,OACzG,CAAC9L,IAAK,SAAUwR,QAAS7J,EAAAA,EAAYC,GAAG,iBAAkBQ,KAAM,QAASuK,KAAM,CAACf,OAAQ,SAAU9F,SAAU,MAAOhD,UAAWvL,EAAKwD,MAAMoN,iBAEvIyE,EAAalQ,OAAOC,QAAQpF,EAAK8B,MAAMC,aAAauI,cAAcE,OAAO,SAAA8K,GAAA,IAAAC,EAAA/P,GAAA8P,EAAA,GAAY,OAAPC,EAAA,IAAiC,IAA1BA,EAAA,GAAYtH,SAAkB,GACzH,OACI9K,EAAAA,cAAA,WACIA,EAAAA,cAAA,OAAKC,UAAU,0BACXD,EAAAA,cAAA,OAAKC,UAAU,mBACXD,EAAAA,cAAA,WAAMiH,EAAAA,EAAYC,GAAG,oBACrBlH,EAAAA,cAAA,OAAKC,UAAU,gBACXD,EAAAA,cAAA,UAAQ0I,SAAU,SAAChL,GAAE,OAAKb,EAAKmC,SAAS,CAAC+L,YAAarN,EAAGsG,OAAOzE,OAAO,EAAEA,MAAO1C,EAAKwD,MAAM0K,aACtFmH,EAAW5R,IAAI,SAAA+R,GAAA,IAAAC,EAAAjQ,GAAAgQ,EAAA,GAAE/P,EAAQgQ,EAAA,GAAElW,EAAOkW,EAAA,UAC/BtS,EAAAA,cAAA,UAAQV,IAAKgD,EAAU/C,MAAO+C,GAAWlG,EAAQ4K,MAAe,IAGxEhH,EAAAA,cAAA,UAAQC,UAAU,SAASsH,QAAS1K,EAAK0V,iBAAiBvS,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,YAG7E1H,EAAAA,cAAA,OAAKC,UAAU,mBACXD,EAAAA,cAAA,WAAMiH,EAAAA,EAAYC,GAAG,mBACrBlH,EAAAA,cAAA,YACIA,EAAAA,cAAC+Q,GAAAA,EAAS,CAAChO,OAAQgP,EAAcf,QAASgB,EAAazK,QAAS,SAACjI,EAAK2S,GAAI,OAAKpV,EAAK2V,cAAcP,EAAK,MAG/GjS,EAAAA,cAAA,OAAKC,UAAU,mBACXD,EAAAA,cAAA,WAAMiH,EAAAA,EAAYC,GAAG,mBACrBlH,EAAAA,cAAC+Q,GAAAA,EAAS,CAAChO,OAAQgP,EAAcf,QAASJ,EAAarJ,QAAS,SAACjI,EAAK2S,GAAI,OAAKpV,EAAK2V,cAAcP,EAAK,MAG9GpV,EAAK4V,gBAGlB,GAACpV,GAAAR,EAAA,gBACe,WACZ,MAA0B,WAAtBA,EAAKwD,MAAM6Q,OAEPlR,EAAAA,cAACyK,GAAY,CACTU,SAAUtO,EAAKwD,MAAM8K,SAAUmC,gBAAiB,SAAAnC,GAAQ,OAAItO,EAAKmC,SAAS,CAACmM,SAAAA,GAAU,EACrFiB,MAAOvP,EAAKwD,MAAM+L,MAAOe,aAAc,SAAAf,GAAK,OAAIvP,EAAKmC,SAAS,CAACoN,MAAAA,GAAO,EACtErB,YAAalO,EAAKwD,MAAM0K,YAAaK,SAAUvO,EAAKwD,MAAM+K,SAC1DuB,cAAe9P,EAAK8P,cAAe/N,aAAc/B,EAAK8B,MAAMC,eAEvC,SAAtB/B,EAAKwD,MAAM6Q,OAEdlR,EAAAA,cAAC0P,GAAU,CACPtD,MAAOvP,EAAKwD,MAAM+L,MAAOe,aAAc,SAAAf,GAAK,OAAIvP,EAAKmC,SAAS,CAACoN,MAAAA,GAAO,EACtErB,YAAalO,EAAKwD,MAAM0K,YAAaiF,aAAcnT,EAAKmT,aACxDpR,aAAc/B,EAAK8B,MAAMC,aACzB6O,eAAgB5Q,EAAKwD,MAAMoN,iBAGhC,IACX,GAACpQ,GAAAR,EAAA,gBAUe,SAACoV,GACO,WAAhBA,EAAKf,QACLrU,EAAK6V,uBACL7V,EAAKmC,SAAS,CAACkS,OAAQ,OAAQ9F,SAAU,KAAMqC,eAAgB,QAE/D5Q,EAAKmC,SAAS,CAACkS,OAAQe,EAAKf,OAAQ9F,SAAU6G,EAAK7G,SAAUqC,eAAgB,MAErF,GAACpQ,GAAAR,EAAA,uBACsB,WACnBA,EAAK8B,MAAMC,aAAa+D,eAAe9F,EAAKwD,MAAM0K,aAAa4F,OAAO9T,EAAKwD,MAAMoN,gBACjF5Q,EAAKwD,MAAMoN,eAAevE,SAAS,SAAAW,GAAG,IAAAC,EAAA,OAAe,QAAfA,EAAID,EAAIE,eAAO,IAAAD,OAAA,EAAXA,EAAAlG,KAAAiG,EAAe,GACzDhN,EAAK8B,MAAMC,aAAac,MAAMkD,cAClC,GAACvF,GAAAR,EAAA,gBACe,SAACsM,GACbtM,EAAKmC,SAAS,CAACkS,OAAQ,OAAQ9F,SAAU,KAAMqC,eAAgBtE,GACnE,GAAC9L,GAAAR,EAAA,eACc,SAACsM,GACZtM,EAAKmC,SAAS,CAACyO,eAAgBtE,GACnC,GAACtM,CAAA,Q,sRAAAwC,CAAA4R,EAAArU,G,EAAAqU,G,EAAA,EAAA3R,IAAA,SAAAC,MA3BD,WAAS,IAAAC,EAAA,KACL,OACIQ,EAAAA,cAAC2S,GAAAA,EAAO,CAACC,OAAQnT,KAAKmT,OAAQC,OAAQpT,KAAKoT,OAAQrI,KAAK,UACnD,iBAAO,CACJF,KAAM9K,EAAK+K,aACd,EAGb,M,8EAAC,CA/HsB,CAASvK,EAAAA,WAAe3C,GAA9B4T,GAAM,YACJ,CACfrS,aAAciC,IAAAA,S,uCCdlB,GAAU,CAAC,E,srDAEf,GAAQxE,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCPzB,IAGZoW,GAAW,SAAAlW,GAAA,SAAAkW,IAAA,IAAAjW,G,4FAAAC,CAAA,KAAAgW,GAAA,QAAA/V,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAqE3B,OArE2BC,GAAAR,EAAAS,GAAA,KAAAwV,EAAA,GAAAvV,OAAAL,IAAA,aAkBf,WACT,IAAM0B,EAAe/B,EAAK8B,MAAMC,aAChC,OACIoB,EAAAA,cAAA,OAAKC,UAAU,8BACXD,EAAAA,cAAA,OAAKC,UAAU,uBAAuBgH,EAAAA,EAAYC,GAAG,wBACpDlF,OAAOC,QAAQrD,EAAauI,cAAc7G,IAAI,SAAA6B,GAAuB,IAAA4Q,EAAAC,EAAA5Q,E,05BAAAC,CAAAF,EAAA,GAArBG,EAAQF,EAAA,GAAE6Q,EAAK7Q,EAAA,GAC5D,IAAK6Q,EAAMlM,UACP,OAAO,KAEX,IAAMmM,EAAUC,KAAW,CACvB,oBAAoB,EACpB,6BAA8BF,EAAMG,UAExC,OACIpT,EAAAA,cAAA,OAAKC,UAAWiT,EAAS5T,IAAKgD,GAC1BtC,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,4BACZyH,KAAMuL,EAAMG,QAAU,UAAY,YAClC7L,QAAS,WAAF,OAAQ3I,EAAayU,kBAAkB/Q,EAAU,CAAC8Q,SAAUH,EAAMG,SAAS,IAEtFpT,EAAAA,cAAA,QAAMC,UAAU,yBAAyB+G,MAAkB,QAAb+L,EAAEE,EAAMjM,aAAK,IAAA+L,EAAAA,EAAIzQ,GAAsB,QAAb0Q,EAAEC,EAAMjM,aAAK,IAAAgM,EAAAA,EAAI1Q,GACzFtC,EAAAA,cAAA,QAAMC,UAAU,iCACZD,EAAAA,cAAA,SAAOC,UAAU,uCAAuC6F,IAAI,MAAMsH,IAAI,IAClE1E,SAAU,SAAChL,GAAE,OAAKkB,EAAayU,kBAAkB/Q,EAAU,CAACgR,QAASC,SAAS7V,EAAGsG,OAAOzE,MAAO,IAAM,KAAK,EAC1GiU,KAAK,IAAIC,KAAK,QAAQlU,MAAuB,IAAhB0T,EAAMK,WAIvD,GACAtT,EAAAA,cAAA,OAAKC,UAAU,uBAAuBgH,EAAAA,EAAYC,GAAG,uBACpDtI,EAAa8U,YAAYpT,IAAI,SAAA2S,GAC1B,IAAMC,EAAUC,KAAW,CACvB,oBAAoB,EACpB,6BAA8BF,EAAMU,aAExC,OACI3T,EAAAA,cAAA,OAAKC,UAAWiT,EAAS5T,IAAK2T,EAAM9W,IAChC6D,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,4BACZyH,KAAMuL,EAAMU,WAAa,UAAY,YACrCpM,QAAS,WAAF,OAAQ3I,EAAagV,iBAAiBX,EAAM9W,GAAI,CAACwX,YAAaV,EAAMU,YAAY,IAE3F3T,EAAAA,cAAA,QAAMC,UAAU,yBAAyB+G,MAAOiM,EAAMjM,OAAQiM,EAAMjM,OACpEhH,EAAAA,cAAA,QAAMC,UAAU,iCACZD,EAAAA,cAAA,SAAOC,UAAU,uCAAuC6F,IAAI,MAAMsH,IAAI,IAClE1E,SAAU,SAAChL,GAAE,OAAKkB,EAAagV,iBAAiBX,EAAM9W,GAAI,CAACmX,QAASC,SAAS7V,EAAGsG,OAAOzE,MAAO,KAAK,EACnGiU,KAAK,IAAIC,KAAK,QAAQlU,MAAO0T,EAAMK,WAIvD,GAGZ,GAACzW,CAAA,Q,sRAAAwC,CAAAyT,EAAAlW,G,EAAAkW,G,EAAA,EAAAxT,IAAA,SAAAC,MAjED,WAAS,IAAAC,EAAA,KACL,OACIQ,EAAAA,cAAA,WACIA,EAAAA,cAACqK,EAAAA,EAAO,CAAC3C,KAAK,SAASvL,GAAG,cACtB6K,MAAOC,EAAAA,EAAYC,GAAG,6BACtBjJ,MAAM,QAEL,iBAAO,CACJqM,KAAM9K,EAAK+K,aACd,GAIjB,M,8EAAC,CAjB2B,CAASvK,EAAAA,WAAe3C,GAAnCyV,GAAW,YACT,CACflU,aAAciC,IAAAA,S,+DCXlB,GAAU,CAAC,E,+kDAEf,GAAQxE,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCJ1B,IAGXmX,GAAU,SAAAjX,GAQ3B,SAAAiX,EAAYlV,GAAO,IAAA9B,G,4FAAAC,CAAA,KAAA+W,GACFxW,GAAbR,EAAAS,GAAA,KAAAuW,EAAA,CAAMlV,IAAO,QALT,CACJmV,YAAY,EACZC,UAAW,IACd1W,GAAAR,EAAA,aA8CY,WACT,IAAMmX,EAAO,IAAIC,KAAKpX,EAAKwD,MAAM0T,WAC3BG,EAAOF,EAAKG,cACZC,EAAQC,OAAOL,EAAKM,WAAa,GAAGC,SAAS,EAAG,KAChDC,EAAMH,OAAOL,EAAKS,WAAWF,SAAS,EAAG,KACzCG,EAAQL,OAAOL,EAAKW,YAAYJ,SAAS,EAAG,KAC5CK,EAAUP,OAAOL,EAAKa,aAAeb,EAAKc,aAAe,GAAK,EAAI,GAAGP,SAAS,EAAG,KACjFQ,EAAM,GAAHxX,OAAM2W,EAAI,KAAA3W,OAAI6W,EAAK,KAAA7W,OAAIiX,GAC1BQ,EAAK,GAAHzX,OAAMmX,EAAK,KAAAnX,OAAIqX,GACvB,OACI5U,EAAAA,cAAA,OAAKC,UAAU,mBACXD,EAAAA,cAAA,aACIA,EAAAA,cAAA,aACIA,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAI,eACJA,EAAAA,cAAA,UAAIA,EAAAA,cAACiV,GAAAA,EAAY,CAAClS,OAAQlG,EAAKwD,MAAMyT,WAAYpL,SAAU7L,EAAKqY,qBAEpElV,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAI,QACJA,EAAAA,cAAA,UAAIA,EAAAA,cAACmV,GAAAA,EAAK,CAAC/M,SAAUvL,EAAKwD,MAAMyT,WAAYpL,SAAU7L,EAAKuY,WAAY3B,KAAK,OAAOlU,MAAOwV,MAE9F/U,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAI,QACJA,EAAAA,cAAA,UAAIA,EAAAA,cAACmV,GAAAA,EAAK,CAAC/M,SAAUvL,EAAKwD,MAAMyT,WAAYpL,SAAU7L,EAAKwY,WAAY5B,KAAK,OAAOlU,MAAOyV,QAMlH,GAAC3X,GAAAR,EAAA,mBACkB,SAACkG,GACZA,EACAlG,EAAKyY,sBAELhX,aAAazB,EAAK0Y,qBAEtB1Y,EAAKmC,SAAS,CAAC8U,WAAY/Q,GAC/B,GAAC1F,GAAAR,EAAA,aACY,SAAC0C,GACLA,GAGL1C,EAAKmC,SAAS,SAAAqB,GACV,IAAM2T,EAAO,IAAIC,KAAK5T,EAAM0T,WACtBgB,EAAMxV,EAAMiW,MAAM,KAAKlV,IAAImV,QAIjC,OAHAzB,EAAK0B,YAAYX,EAAI,IACrBf,EAAK2B,SAASZ,EAAI,GAAK,GACvBf,EAAK4B,QAAQb,EAAI,IACV,CAAChB,WAAYC,EACxB,EACJ,GAAC3W,GAAAR,EAAA,aACY,SAAC0C,GACLA,GAGL1C,EAAKmC,SAAS,SAAAqB,GACV,IAAM2T,EAAO,IAAIC,KAAK5T,EAAM0T,WACtBiB,EAAKzV,EAAMiW,MAAM,KAAKlV,IAAImV,QAGhC,OAFAzB,EAAK6B,SAASb,EAAG,IACjBhB,EAAK8B,WAAWd,EAAG,IACZ,CAACjB,WAAYC,EACxB,EACJ,GAAC3W,GAAAR,EAAA,sBACqB,WAElB,IAAMmX,EAAO,IAAIC,KACX8B,EAAmB,GAAK/B,EAAKc,aAAed,EAAKgC,kBAAoB,IAC3EnZ,EAAKmC,SAAS,CAAC+U,WAAYC,IAC3BnX,EAAK0Y,oBAAsB/W,WAAW3B,EAAKyY,oBAAqB,IAAOS,EAC3E,GAAC1Y,GAAAR,EAAA,sBACqB,WAAmB,IAAlBoZ,EAAKjZ,UAAAC,OAAA,QAAAmU,IAAApU,UAAA,IAAAA,UAAA,GAClB4B,EAAe/B,EAAK8B,MAAMC,aAC1BsX,EAAmBtX,EAAa+D,eAAe,sBAGrD,GAAIsT,GAASC,EAAiBlS,OAAOQ,SAASoB,WAAWhH,EAAac,MAAMyD,KAAKC,SAASY,QAAU,IAAO,CAEvG,IAAMlG,EAAIc,EAAac,MAAMyD,KAAKC,SAASY,OAAOlG,EAC5CI,EAAIU,EAAac,MAAMyD,KAAKC,SAASY,OAAO9F,EAC5CiY,EAASzV,EAAAA,EAAiB0V,UAAU,CAACtY,EAAGI,GAAIU,EAAa6B,OAAQ,aAEjE4V,EAASC,KAAAA,YAAoB,IAAIrC,KAAKpX,EAAKwD,MAAM0T,WAAYoC,EAAO,GAAIA,EAAO,IAC/EI,EAAKF,EAAOG,QAAU1W,KAAKyB,GAC3BkV,EAAMJ,EAAOK,SAEb/Q,EAAW,IAEjBuQ,EAAiB1R,SAAS1G,EAAIA,EAAIgC,KAAK4B,IAAI+U,GAAO3W,KAAK2B,IAAI8U,GAAM5Q,EACjEuQ,EAAiB1R,SAAStG,EAAIA,EAAI4B,KAAK4B,IAAI+U,GAAO3W,KAAK4B,IAAI6U,GAAM5Q,EACjEuQ,EAAiB1R,SAASvF,EAAIa,KAAK2B,IAAIgV,GAAO9Q,EAC9CuQ,EAAiBvP,oBAEjBuP,EAAiBlS,OAAOQ,SAAS1G,EAAIA,EACrCoY,EAAiBlS,OAAOQ,SAAStG,EAAIA,EACrCgY,EAAiBlS,OAAOQ,SAASvF,EAAI,EACrCiX,EAAiBlS,OAAO2C,oBAExB,IAAMrF,EAAQxB,KAAKgG,IAAI,EAAG2Q,GAAO,GAAM3W,KAAKyB,KACtCoV,EAAY,KAAOrV,GAASA,EAAQ,KAE1C1C,EAAa0B,IAAIsW,YAAYJ,QAAUD,EAAKzW,KAAKyB,GAAK,IACtD3C,EAAa0B,IAAIsW,YAAYC,OAAS,GAAiB,GAAZF,EAC3C/X,EAAa0B,IAAIsW,YAAYD,UAAY,EAAI,GAAMA,EACnD/X,EAAa0B,IAAIsW,YAAYE,qBAAsB,EAGnDlY,EAAa+D,eAAe,kBAAkBgU,UAAY,IAAO,IAAOA,EACxE/X,EAAa+D,eAAe,sBAAsBgU,UAAY,GAAM,IAAMA,EAE1E/X,EAAac,MAAMkD,aAAahE,EAAa0B,KAC7C1B,EAAac,MAAM4D,SAASyT,OAAOnY,EAAac,MAAMA,MAAOd,EAAac,MAAMyD,KAAKe,OACzF,CACJ,GA3JIrH,EAAK0Y,oBAAsB,KAC3B,IAAMyB,EAAM,IAAI/C,KAIY,OAH5B+C,EAAInB,SAAS,IACbmB,EAAIlB,WAAW,GACfkB,EAAIC,WAAW,GACfpa,EAAKwD,MAAM0T,WAAaiD,EAAIna,CAChC,CAAC,O,sRAAAwC,CAAAwU,EAAAjX,G,EAAAiX,G,EAAA,EAAAvU,IAAA,oBAAAC,MACD,WACIE,KAAKyX,mBAAmB,CAAC,EAC7B,GAAC,CAAA5X,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GAAW,IAAAkN,EAAA3X,EAAA,KACrC,GAAIC,KAAKd,MAAMC,aAAac,SAAgC,QAA3ByX,EAAKnN,EAAUpL,oBAAY,IAAAuY,OAAA,EAAtBA,EAAwBzX,OAAO,CACjE,IAAM0X,EAAe,IAAIC,EAAAA,IAAa,QAAS,IAC/C5X,KAAKd,MAAMC,aAAaqE,eAAe,iBAAkBmU,GAEzD,IAAMlB,EAAmB,IAAIoB,EAAAA,IAAiB,SAAU,KACxD7X,KAAKd,MAAMC,aAAaqE,eAAe,qBAAsBiT,GAE7DzW,KAAKd,MAAMC,aAAac,MAAMyD,KAAKC,SAASxD,iBAAiB,SAAU,kBAAMJ,EAAK+X,qBAAqB,GAEvG9X,KAAK+X,sBAAwBC,YAAY,kBAAMjY,EAAK+X,qBAAoB,EAAK,EAAE,KAC/E9X,KAAK8X,qBACT,MAAW9X,KAAKY,MAAM0T,YAAc9J,EAAU8J,WAC1CtU,KAAK8X,qBAAoB,EAEjC,GAAC,CAAAjY,IAAA,uBAAAC,MACD,WACImY,cAAcjY,KAAK+X,sBACvB,GAAC,CAAAlY,IAAA,SAAAC,MACD,WAAS,IAAA6K,EAAA,KACL,OACIpK,EAAAA,cAAA,WACIA,EAAAA,cAACqK,EAAAA,EAAO,CAAC3C,KAAK,QAAQvL,GAAG,aACrB6K,MAAOC,EAAAA,EAAYC,GAAG,4BACtBjJ,MAAM,QAEL,iBAAO,CACJqM,KAAMF,EAAKG,aACd,GAIjB,M,8EAAC,CApD0B,CAASvK,EAAAA,WAAe3C,GAAlCwW,GAAU,YACR,CACfjV,aAAciC,IAAAA,S,4BCdlB,GAAU,CAAC,E,+kDAEf,GAAQxE,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCNvB,IAGdib,GAAa,SAAA/a,GAI9B,SAAA+a,EAAYhZ,GAAO,IAAA9B,EAIQ,O,4FAJRC,CAAA,KAAA6a,GACFta,GAAbR,EAAAS,GAAA,KAAAqa,EAAA,CAAMhZ,IAAO,QAKT,CACJiZ,aAAa,IAChBva,GAAAR,EAAA,aAiEY,SAACkH,GACNA,EAAM8T,SAEe,YAAd9T,EAAMzE,IACTyE,EAAM+T,QAASjb,EAAKkb,KAAKhU,EAAO,EAAG,GAAG,GACrClH,EAAKmb,IAAIjU,EAAO,EAAG,GAAG,GACN,cAAdA,EAAMzE,IACTyE,EAAM+T,QAASjb,EAAKkb,KAAKhU,EAAO,GAAI,GAAG,GACtClH,EAAKmb,IAAIjU,EAAO,GAAI,GAAG,GACP,cAAdA,EAAMzE,IACTyE,EAAM+T,QAASjb,EAAKkb,KAAKhU,EAAO,EAAG,GAAG,GACrClH,EAAKmb,IAAIjU,EAAO,EAAG,GAAG,GACN,eAAdA,EAAMzE,MACTyE,EAAM+T,QAASjb,EAAKkb,KAAKhU,GAAQ,EAAG,GAAG,GACtClH,EAAKmb,IAAIjU,GAAQ,EAAG,GAAG,IAEpC,GAAC1G,GAAAR,EAAA,OACM,WACHA,EAAKob,mBACL,IAAMC,EAASrb,EAAK8B,MAAMC,aAAa0B,IAAI4X,OACrCC,EAAS,CAACD,EAAOE,KAAMF,EAAOG,MAAOH,EAAOI,KAAMJ,EAAOK,OAC/D1b,EAAK2b,gBAAgBL,EACzB,GAAC9a,GAAAR,EAAA,MACK,SAACa,EAAI+a,EAAIC,GAAyB,IAArBC,EAAQ3b,UAAAC,OAAA,QAAAmU,IAAApU,UAAA,IAAAA,UAAA,GAEjB4b,EAAI/b,EAAKwD,MAAMuX,YACjB,IAEA,KAAO/a,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASvF,EAAIpC,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAO/E,GAAK,IAEpH+F,EAAQ,IAAIf,EAAAA,IAAQwU,EAAIC,GAAI3W,eAAe6W,GACjD/b,EAAKgc,sBAAuB,EAC5B,IAAIC,EAAgB,IAAI7E,KAAS,IAC3B8E,EAAU,WACZ,IAAIlc,EAAKgc,qBAAT,CAIA,IAAM9E,EAAY,IAAIE,KAAS,IACzB+E,EAAIjF,EAAY+E,EACtBA,EAAgB/E,EAChBlX,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAAS6V,KAAKjU,EAAMlH,EAAIkb,EAAGhU,EAAM9G,EAAI8a,GACxEnc,EAAK8B,MAAMC,aAAac,MAAMkD,eAC9BsW,sBAAsBH,EAPtB,CAQJ,EACAG,sBAAsBH,GACtB,IACMhV,EAAQ4U,EAAW,QAAU,WADnBA,EAAWjb,EAAGsG,OAAStG,EAAGyF,MAElCvD,iBAAiBmE,EAAO,WAC5BlH,EAAKgc,sBAAuB,CAChC,EAAG,CAACxT,MAAM,GACd,GAAChI,GAAAR,EAAA,OACM,SAACa,EAAIyb,EAAK5C,GAAyB,IAArBoC,EAAQ3b,UAAAC,OAAA,QAAAmU,IAAApU,UAAA,IAAAA,UAAA,GACrBH,EAAKwD,MAAMuX,cACXrB,IAAO,EACP4C,IAAQ,GAGZtc,EAAKgc,sBAAuB,EAC5B,IAAIC,EAAgB,IAAI7E,KAAS,IAC3B8E,EAAU,WACZ,IAAIlc,EAAKgc,qBAAT,CAIA,IAAM9E,EAAY,IAAIE,KAAS,IACzB+E,EAAIjF,EAAY+E,EACtBA,EAAgB/E,EACZwC,GACA1Z,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASgW,UAAU7C,EAAKyC,GAE3DG,GACAtc,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASiW,YAAYF,EAAMH,GAElEnc,EAAK8B,MAAMC,aAAac,MAAMkD,eAC9BsW,sBAAsBH,EAZtB,CAaJ,EACAG,sBAAsBH,GACtB,IACMhV,EAAQ4U,EAAW,QAAU,WADnBA,EAAWjb,EAAGsG,OAAStG,EAAGyF,MAElCvD,iBAAiBmE,EAAO,WAC5BlH,EAAKgc,sBAAuB,CAChC,EAAG,CAACxT,MAAM,GACd,GAAChI,GAAAR,EAAA,YACW,WACR,GAAIA,EAAKwD,MAAMuX,YAAa,CACxB,IAAM5T,EAASnH,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OACrDsV,EAAYzc,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAC5D3H,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAO0C,IAAI1C,EAAOlG,EAAGkG,EAAO9F,EAAGob,EAAUra,EACzF,KAAO,CAEH,IAAM+E,EAASnH,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OACrDuV,EAAc1c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASS,QACjEuU,EAAS3c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASyF,oBACrD4Q,EAAc,IAAIpY,EAAAA,IAAQ2C,EAAOlG,EAAGkG,EAAO9F,EAAG8F,EAAO4B,WAAW2T,IAChEG,EAAY,IAAIzF,KAAS,IAE/BpX,EAAKgc,sBAAuB,EAC5B,IAAME,EAAU,WACZ,GAAKlc,EAAK8B,MAAMC,aAAac,QAAS7C,EAAKgc,qBAA3C,CAGA,IACMc,EAAU,IAAI1F,KAAS,IAAOyF,EAC9B5b,EAAI6b,EAFO,EAGXX,EAAK,IAAO,EAAIlZ,KAAK4B,IAAI5D,EAAIgC,KAAKyB,KAElCqY,GAAkB,IAAIvY,EAAAA,KAAUwY,YAAYN,EAAaE,EAAaT,GAC5EY,EAAgB9b,GAAKkG,EAAOlG,EAC5B8b,EAAgB1b,GAAK8F,EAAO9F,EAC5B0b,EAAgBE,eAAe,IAAIzY,EAAAA,IAAQ,EAAG,EAAG,IAAKmY,EAASR,GAC/DY,EAAgB9b,GAAKkG,EAAOlG,EAC5B8b,EAAgB1b,GAAK8F,EAAO9F,EAC5BrB,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASU,KAAK0U,GACxD/c,EAAK8B,MAAMC,aAAac,MAAMkD,eAE1B+W,EAda,EAebT,sBAAsBH,IAEtBlc,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASU,KAAKuU,GACxD5c,EAAK8B,MAAMC,aAAac,MAAMkD,eAnBlC,CAqBJ,EACAsW,sBAAsBH,EAC1B,CACJ,GAAC1b,GAAAR,EAAA,kBACiB,SAACsb,GAAsB,IAAA4B,EAAdC,EAAKhd,UAAAC,OAAA,QAAAmU,IAAApU,UAAA,GAAAA,UAAA,GAAG,EAC3BH,EAAKwD,MAAMuX,aACX/a,EAAKob,mBAGT,IAAMgC,EAAS,CACXnc,EAAG,IAAOqa,EAAO,GAAKA,EAAO,IAC7Bja,EAAG,IAAOia,EAAO,GAAKA,EAAO,KAE3B+B,EAAkBrd,EAAK8B,MAAMC,aAAa0B,IAAI4F,aAAa,CAACH,YAAa,IAAIC,EAAAA,GAAYnJ,EAAK8B,MAAMC,aAAa6B,OAAQwZ,EAAOnc,EAAGmc,EAAO/b,KAChJgc,EAAgB/T,QAAQC,KAAK,SAACC,EAAGC,GAAC,OAAKD,EAAEE,WAAaD,EAAEC,UAAU,GAClE0T,EAAOhb,GAA8B,QAA1B8a,EAAAG,EAAgB/T,QAAQ,UAAE,IAAA4T,OAAA,EAA1BA,EAA4BvT,YAAa,EAapD,IAVA,IAAM2T,EAAM,GAAK,IAAMra,KAAKyB,GACtB6Y,GAAgBjC,EAAO,GAAKA,EAAO,KAAO,EAAIrY,KAAKua,IAAIF,EAAM,IAG7DZ,EAAc1c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASS,QACjEqV,EAAYzd,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOiB,QAC/DuU,EAAS3c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASyF,oBACrD4Q,EAAc,IAAIpY,EAAAA,IAAQ4Y,EAAOnc,EAAGmc,EAAO/b,EAAG+b,EAAOhb,EAAImb,GACzDG,EAAY,IAAIlZ,EAAAA,IAAQ4Y,EAAOnc,EAAGmc,EAAO/b,EAAG+b,EAAOhb,GACrDub,GAAehB,EAASQ,EACrBQ,EAAc1a,KAAKyB,IACtBiZ,GAAe,EAAI1a,KAAKyB,GAE5B,KAAOiZ,GAAe1a,KAAKyB,IACvBiZ,GAAe,EAAI1a,KAAKyB,GAE5B,IAAMmY,EAAY,IAAIzF,KAAS,IAE/BpX,EAAKgc,sBAAuB,EAC5B,IAAME,EAAU,WACZ,GAAKlc,EAAK8B,MAAMC,aAAac,QAAS7C,EAAKgc,qBAA3C,CAGA,IACMc,EAAU,IAAI1F,KAAS,IAAOyF,EAC9B5b,EAAI6b,EAFO,EAGXX,EAAK,IAAO,EAAIlZ,KAAK4B,IAAI5D,EAAIgC,KAAKyB,KAElCqY,GAAkB,IAAIvY,EAAAA,KAAUwY,YAAYN,EAAaE,EAAaT,GACtEpb,GAAgB,IAAIyD,EAAAA,KAAUwY,YAAYS,EAAWC,EAAWvB,GACtEY,EAAgB9b,GAAKF,EAAcE,EACnC8b,EAAgB1b,GAAKN,EAAcM,EACnC0b,EAAgBE,eAAe,IAAIzY,EAAAA,IAAQ,EAAG,EAAG,GAAImZ,EAAcxB,GACnEY,EAAgB9b,GAAKF,EAAcE,EACnC8b,EAAgB1b,GAAKN,EAAcM,EACnCrB,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASU,KAAK0U,GACxD/c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOkB,KAAKtH,GACxDf,EAAK8B,MAAMC,aAAac,MAAMkD,eAE1B+W,EAhBa,EAiBbT,sBAAsBH,IAEtBlc,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASU,KAAKuU,GACxD5c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOkB,KAAKqV,GACxD1d,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASiW,aAAaW,GACzDnd,EAAK8B,MAAMC,aAAac,MAAMkD,eAvBlC,CAyBJ,EACAsW,sBAAsBH,EAC1B,GAAC1b,GAAAR,EAAA,uBACsB,WAAM,IAAA4d,EAAAC,EACnB1W,EAASnH,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAC3D,KAAInH,EAAK8d,YAAc9d,EAAK8d,WAAWC,kBAAkB5W,GAAU,IAAnE,CAGAnH,EAAK8d,WAAa3W,EAAOiB,QACzB,IAAMnH,EAAIkG,EAAOlG,EACXI,EAAI8F,EAAO9F,EACXiG,EAAY,IAAIC,EAAAA,IAEtBD,EAAUuC,IAAI,IAAIrF,EAAAA,IAAQvD,EAAGI,EAAG8F,EAAO/E,EAAI,KAAS,IAAIoC,EAAAA,IAAQ,EAAG,GAAI,IACvE,IAAMwZ,EAAY1W,EAAU2W,iBAAiB,CAACje,EAAK8B,MAAMC,aAAa0B,IAAIya,WAAW1T,OAAO,SAAApB,GAAM,OAAsC,IAAlCA,EAAOkD,OAAOuI,SAASzU,MAAY,GAAE,GACrI+d,EAAmC,QAAtBP,EAAGI,SAAgB,QAAPH,EAATG,EAAW9b,aAAK,IAAA2b,OAAA,EAAhBA,EAAkBzb,SAAC,IAAAwb,EAAAA,EAAI,EAE7C,KAAIO,GAAiB,GAArB,CAIA,GAAIne,EAAKwD,MAAMuX,YAAa,CACxB,IAAM5S,EAASgW,EAAgBne,EAAKoe,aAAgBpe,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASvF,EAGvG,OAFApC,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASvF,GAAK+F,OACxDnI,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAO/E,GAAK+F,EAE5D,CACA,IAAMoV,EAAevd,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASvF,EAGlEic,EAAeF,EAAgB,EAAIA,EAAgBlb,KAAKgG,IAAI,EAAG,GAAKsU,EAAeY,GAAiBA,GAAiB,EAC3Hne,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAO/E,EAAIic,CAZvD,CAZA,CAyBJ,GAAC7d,GAAAR,EAAA,iBACgB,WACbA,EAAKgc,sBAAuB,CAChC,GAACxb,GAAAR,EAAA,0BACyB,SAACa,GAClBb,EAAKwD,MAAMuX,aACZ/a,EAAKse,iBAAiBzd,EAE9B,GAACL,GAAAR,EAAA,4BAC2B,WACpBA,EAAKwD,MAAMuX,YACX/a,EAAKob,mBAELpb,EAAK8B,MAAMC,aAAac,MAAM6D,WAAW3D,iBAAiB,QAAS/C,EAAKse,iBAAkB,CAAC9V,MAAM,GAEzG,GAAChI,GAAAR,EAAA,mBACkB,SAACa,GAChB,IAAMC,EAAOD,EAAGsG,OAAOnG,wBACjBud,GAAW1d,EAAGK,QAAUJ,EAAKK,MAAQL,EAAKM,MAAS,EAAI,EACvDod,IAAY3d,EAAGS,QAAUR,EAAKS,KAAOT,EAAKU,OAAU,EAAI,EACxDK,EAAe7B,EAAK8B,MAAMC,aAAaC,qBAAqBuc,EAAQC,GAAQ,GAClF,GAAK3c,EAAL,CAGA,IAAMqG,EAAMrG,EAAaK,MACzBlC,EAAK8B,MAAMC,aAAa0c,iBAAiB,CAACvW,EAAIjH,EAAGiH,EAAI7G,IAAIqd,KAAK,SAAAtc,GAE1D,IAAMsa,EAAc1c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASS,QACjEqV,EAAYzd,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOiB,QAC/DwU,EAAc,IAAIpY,EAAAA,IAAQ0D,EAAIjH,EAAGiH,EAAI7G,EAAGe,EAAIpC,EAAKoe,cACjDV,EAAY,IAAIlZ,EAAAA,IAAQ0D,EAAIjH,EAAGiH,EAAI7G,EAAI,IAAKe,EAAIpC,EAAKoe,cACrDvB,EAAY,IAAIzF,KAAS,IAE/BpX,EAAKgc,sBAAuB,EAC5B,IAAME,EAAU,WACZ,GAAKlc,EAAK8B,MAAMC,aAAac,QAAS7C,EAAKgc,qBAA3C,CAGA,IACMc,EAAU,IAAI1F,KAAS,IAAOyF,EAC9B5b,EAAI6b,EAFO,EAGXX,EAAK,IAAO,EAAIlZ,KAAK4B,IAAI5D,EAAIgC,KAAKyB,KAElCqY,GAAkB,IAAIvY,EAAAA,KAAUwY,YAAYN,EAAaE,EAAaT,GACtEpb,GAAgB,IAAIyD,EAAAA,KAAUwY,YAAYS,EAAWC,EAAWvB,GACtEnc,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASU,KAAK0U,GACxD/c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAOkB,KAAKtH,GACxDf,EAAK8B,MAAMC,aAAac,MAAMkD,eAE1B+W,EAXa,EAYbT,sBAAsBH,IAEtBlc,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASU,KAAKuU,GACxD5c,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKC,SAASY,OAAO0C,IAAI3B,EAAIjH,EAAGiH,EAAI7G,EAAI,GAAKe,EAAIpC,EAAKoe,cACpFpe,EAAK8B,MAAMC,aAAac,MAAMkD,eAE9B/F,EAAKuG,SAASoY,cAAgB,GAAM1b,KAAKyB,GACzC1E,EAAKuG,SAASqY,SAAW,IACzB5e,EAAKuG,SAASsY,YAAa,EAC3B7e,EAAKmC,SAAS,CAAC4Y,aAAa,IAtBhC,CAwBJ,EACAsB,sBAAsBH,EAC1B,EAxCA,CAyCJ,GAAC1b,GAAAR,EAAA,mBACkB,WACfA,EAAKuG,SAASoY,cAA0B,GAAV1b,KAAKyB,GACnC1E,EAAKuG,SAASqY,SAAW,EACzB5e,EAAKuG,SAASsY,YAAa,EAE3B7e,EAAKmC,SAAS,CAAC4Y,aAAa,GAAQ,WAChC,IAAM+D,EAAY9e,EAAK8B,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SACtD2T,EAAS,CAACwD,EAAU7d,EAAI,IAAM6d,EAAUzd,EAAI,IAAMyd,EAAU7d,EAAI,IAAM6d,EAAUzd,EAAI,KAC1FrB,EAAK2b,gBAAgBL,EACzB,EACJ,GA7WItb,EAAKgc,sBAAuB,EAC5Bhc,EAAKoe,aAAe,EACpBpe,EAAK8d,WAAa,KAAK9d,CAC3B,CAAC,O,sRAAAwC,CAAAsY,EAAA/a,G,EAAA+a,G,EAAA,EAAArY,IAAA,oBAAAC,MAID,WACI,IAAMqc,EAAenc,KAAKd,MAAMC,aAAac,MAAM6D,WACnDqY,EAAaC,SAAW,EACxBpc,KAAK2D,SAAW,IAAI0Y,GAAAA,EAAYrc,KAAKd,MAAMC,aAAac,MAAMyD,KAAKe,OAAQ0X,GAC3Enc,KAAK2D,SAAS2Y,cAAe,EAC7Btc,KAAK2D,SAAS4Y,eAAgB,EAC9Bvc,KAAK2D,SAAS6Y,cAAgB,GAC9Bxc,KAAK2D,SAASoY,cAA0B,GAAV1b,KAAKyB,GACnCqa,EAAahc,iBAAiB,UAAWH,KAAKyc,YAC9Czc,KAAKd,MAAMC,aAAac,MAAMyD,KAAKgZ,YAAY1c,KAAK2D,UAEpD,IAAMgZ,EAAY3c,KAAKd,MAAMC,aAAac,MAAMyD,KAAKe,OAAOM,SAASS,QACrEmX,EAAUnd,EAAI,EACdQ,KAAK2D,SAASY,OAASoY,EACvB3c,KAAK2D,SAASxD,iBAAiB,SAAUH,KAAK4c,sBAE9CT,EAAahc,iBAAiB,WAAYH,KAAK6c,wBACnD,GAAC,CAAAhd,IAAA,uBAAAC,MACD,WACIE,KAAKoZ,sBAAuB,EACPpZ,KAAKd,MAAMC,aAAac,MAAM6D,WACtC3D,iBAAiB,UAAWH,KAAKyc,YAC9Czc,KAAK2D,SAASO,oBAAoB,SAAUlE,KAAK4c,sBACjD5c,KAAKd,MAAMC,aAAac,MAAMyD,KAAKgZ,YAAY,MAC/C1c,KAAK2D,SAAS2G,UACdtK,KAAK2D,SAAW,KAChB3D,KAAKd,MAAMC,aAAac,MAAM6D,WAAWI,oBAAoB,WAAYlE,KAAK6c,wBAClF,GAAC,CAAAhd,IAAA,SAAAC,MACD,WAAS,IAAAC,EAAA,KACC+c,EAA2BpJ,KAAW,CACxC,4BAA4B,EAC5B,kCAAmC1T,KAAKY,MAAMuX,cAElD,MAAO,CACH5X,EAAAA,cAAA,OAAKC,UAAU,gBAAgBX,IAAI,gBAC/BU,EAAAA,cAAA,aACAA,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,aAAa8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKwY,IAAIta,EAAI,EAAG,EAAE,IAC/DsC,EAAAA,cAAA,aACAA,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,eAAe8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKwY,IAAIta,EAAI,EAAG,EAAE,IACjEsC,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,OAAOH,QAAS,WAAF,OAAQ/H,EAAKid,MAAM,IAC5Czc,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,gBAAgB8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKwY,IAAIta,GAAK,EAAG,EAAE,IACnEsC,EAAAA,cAAA,aACAA,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,eAAe8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKwY,IAAIta,EAAI,GAAI,EAAE,IAClEsC,EAAAA,cAAA,cAIJA,EAAAA,cAAA,OAAKC,UAAU,mBAAmBX,IAAI,mBAClCU,EAAAA,cAAA,aACAA,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,UAAU8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKuY,KAAKra,EAAI,EAAG,EAAE,IAC7DsC,EAAAA,cAAA,aACAA,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,YAAY8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKuY,KAAKra,EAAI,EAAG,EAAE,IAC/DsC,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,QAAQH,QAAS,WAAF,OAAQ/H,EAAKkd,WAAW,IAClD1c,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,aAAa8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKuY,KAAKra,GAAK,EAAG,EAAE,IACjEsC,EAAAA,cAAA,aACAA,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,YAAY8U,YAAa,SAAC9e,GAAE,OAAK8B,EAAKuY,KAAKra,EAAI,GAAI,EAAE,IAChEsC,EAAAA,cAAA,cAGJA,EAAAA,cAAA,OAAKC,UAAWsc,EAA0Bjd,IAAI,oBAAoBiI,QAAS9H,KAAKkd,2BAC5E3c,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,YAGvB,M,8EAAC,CA5E6B,CAAS1H,EAAAA,WAAe3C,GAArCsa,GAAa,YACX,CACf/Y,aAAciC,IAAAA,S,0JCZlB,GAAU,CAAC,E,uPCVf,IAAA+b,EAAAC,EAAAC,EAAA,mBAAAC,OAAAA,OAAA,GAAAC,EAAAF,EAAAG,UAAA,aAAAC,EAAAJ,EAAAK,aAAA,yBAAAC,EAAAN,EAAAE,EAAAE,EAAAE,GAAA,IAAA5Q,EAAAwQ,GAAAA,EAAAK,qBAAAC,EAAAN,EAAAM,EAAAC,EAAAvb,OAAAwb,OAAAhR,EAAA6Q,WAAA,OAAAI,GAAAF,EAAA,mBAAAT,EAAAE,EAAAE,GAAA,IAAAE,EAAA5Q,EAAA+Q,EAAAG,EAAA,EAAA5e,EAAAoe,GAAA,GAAAhf,GAAA,EAAAyf,EAAA,CAAA7e,EAAA,EAAAke,EAAA,EAAAY,EAAAhB,EAAAvW,EAAAuS,EAAA8E,EAAA9E,EAAAiF,KAAAjB,EAAA,GAAAhE,EAAA,SAAAiE,EAAAC,GAAA,OAAAM,EAAAP,EAAArQ,EAAA,EAAA+Q,EAAAX,EAAAe,EAAAX,EAAAF,EAAAzW,CAAA,YAAAuS,EAAAkE,EAAAE,GAAA,IAAAxQ,EAAAsQ,EAAAS,EAAAP,EAAAH,EAAA,GAAA3e,GAAAwf,IAAAR,GAAAL,EAAA/d,EAAA7B,OAAA4f,IAAA,KAAAK,EAAAE,EAAAte,EAAA+d,GAAAjE,EAAA+E,EAAA7e,EAAAgf,EAAAV,EAAA,GAAAN,EAAA,GAAAI,EAAAY,IAAAd,KAAAO,EAAAH,GAAA5Q,EAAA4Q,EAAA,OAAA5Q,EAAA,MAAA4Q,EAAA,GAAAA,EAAA,GAAAR,GAAAQ,EAAA,IAAAxE,KAAAsE,EAAAJ,EAAA,GAAAlE,EAAAwE,EAAA,KAAA5Q,EAAA,EAAAmR,EAAAC,EAAAZ,EAAAW,EAAAX,EAAAI,EAAA,IAAAxE,EAAAkF,IAAAZ,EAAAJ,EAAA,GAAAM,EAAA,GAAAJ,GAAAA,EAAAc,KAAAV,EAAA,GAAAN,EAAAM,EAAA,GAAAJ,EAAAW,EAAAX,EAAAc,EAAAtR,EAAA,OAAA0Q,GAAAJ,EAAA,SAAAzW,EAAA,MAAAnI,GAAA,EAAA8e,CAAA,iBAAAE,EAAApe,EAAAgf,GAAA,GAAAJ,EAAA,QAAAK,UAAA,oCAAA7f,GAAA,IAAAY,GAAA8Z,EAAA9Z,EAAAgf,GAAAtR,EAAA1N,EAAAye,EAAAO,GAAAjB,EAAArQ,EAAA,EAAAoQ,EAAAW,KAAArf,GAAA,CAAAkf,IAAA5Q,EAAAA,EAAA,GAAAA,EAAA,IAAAmR,EAAAX,GAAA,GAAApE,EAAApM,EAAA+Q,IAAAI,EAAAX,EAAAO,EAAAI,EAAAC,EAAAL,GAAA,OAAAG,EAAA,EAAAN,EAAA,IAAA5Q,IAAA0Q,EAAA,QAAAL,EAAAO,EAAAF,GAAA,MAAAL,EAAAA,EAAAjZ,KAAAwZ,EAAAG,IAAA,MAAAQ,UAAA,wCAAAlB,EAAAmB,KAAA,OAAAnB,EAAAU,EAAAV,EAAAtd,MAAAiN,EAAA,IAAAA,EAAA,YAAAA,IAAAqQ,EAAAO,EAAA,SAAAP,EAAAjZ,KAAAwZ,GAAA5Q,EAAA,IAAA+Q,EAAAQ,UAAA,oCAAAb,EAAA,YAAA1Q,EAAA,GAAA4Q,EAAAR,CAAA,UAAAC,GAAA3e,EAAAyf,EAAAX,EAAA,GAAAO,EAAAT,EAAAlZ,KAAAoZ,EAAAW,MAAAtX,EAAA,YAAAwW,GAAAO,EAAAR,EAAApQ,EAAA,EAAA+Q,EAAAV,CAAA,SAAAa,EAAA,UAAAne,MAAAsd,EAAAmB,KAAA9f,EAAA,GAAA4e,EAAAI,EAAAE,IAAA,GAAAG,CAAA,KAAAlX,EAAA,YAAAiX,IAAA,UAAAW,IAAA,UAAAC,IAAA,CAAArB,EAAA7a,OAAAmc,eAAA,IAAA3R,EAAA,GAAAwQ,GAAAH,EAAAA,EAAA,GAAAG,QAAAS,GAAAZ,EAAA,GAAAG,EAAA,yBAAAH,GAAAU,EAAAW,EAAAb,UAAAC,EAAAD,UAAArb,OAAAwb,OAAAhR,GAAA,SAAAkR,EAAAd,GAAA,OAAA5a,OAAAoc,eAAApc,OAAAoc,eAAAxB,EAAAsB,IAAAtB,EAAAyB,UAAAH,EAAAT,GAAAb,EAAAM,EAAA,sBAAAN,EAAAS,UAAArb,OAAAwb,OAAAD,GAAAX,CAAA,QAAAqB,EAAAZ,UAAAa,EAAAT,GAAAF,EAAA,cAAAW,GAAAT,GAAAS,EAAA,cAAAD,GAAAA,EAAAK,YAAA,oBAAAb,GAAAS,EAAAhB,EAAA,qBAAAO,GAAAF,GAAAE,GAAAF,EAAAL,EAAA,aAAAO,GAAAF,EAAAP,EAAA,yBAAAS,GAAAF,EAAA,oDAAAgB,GAAA,kBAAAC,EAAApB,EAAAqB,EAAAf,EAAA,cAAAD,GAAAb,EAAAE,EAAAE,EAAAH,GAAA,IAAAO,EAAApb,OAAA0c,eAAA,IAAAtB,EAAA,gBAAAR,GAAAQ,EAAA,EAAAK,GAAA,SAAAb,EAAAE,EAAAE,EAAAH,GAAA,SAAAK,EAAAJ,EAAAE,GAAAS,GAAAb,EAAAE,EAAA,SAAAF,GAAA,YAAA+B,QAAA7B,EAAAE,EAAAJ,EAAA,GAAAE,EAAAM,EAAAA,EAAAR,EAAAE,EAAA,CAAAvd,MAAAyd,EAAA4B,YAAA/B,EAAAgC,cAAAhC,EAAAiC,UAAAjC,IAAAD,EAAAE,GAAAE,GAAAE,EAAA,UAAAA,EAAA,WAAAA,EAAA,cAAAO,GAAAb,EAAAE,EAAAE,EAAAH,EAAA,UAAAkC,GAAA/B,EAAAH,EAAAD,EAAAE,EAAAI,EAAA7W,EAAAmG,GAAA,QAAA4Q,EAAAJ,EAAA3W,GAAAmG,GAAA+Q,EAAAH,EAAA7d,KAAA,OAAAyd,GAAA,YAAAJ,EAAAI,EAAA,CAAAI,EAAAY,KAAAnB,EAAAU,GAAAyB,QAAAC,QAAA1B,GAAAhC,KAAAuB,EAAAI,EAAA,UAAAgC,KAAA,OAAAA,GAAAld,OAAAmd,OAAAnd,OAAAmd,OAAAtB,OAAA,SAAAb,GAAA,QAAAJ,EAAA,EAAAA,EAAA5f,UAAAC,OAAA2f,IAAA,KAAAC,EAAA7f,UAAA4f,GAAA,QAAAE,KAAAD,GAAA,IAAAuC,eAAAxb,KAAAiZ,EAAAC,KAAAE,EAAAF,GAAAD,EAAAC,GAAA,QAAAE,CAAA,EAAAkC,GAAApR,MAAA,KAAA9Q,UAAA,UAAAqiB,GAAAzC,EAAAE,GAAA,IAAAD,EAAA7a,OAAAc,KAAA8Z,GAAA,GAAA5a,OAAAsd,sBAAA,KAAApC,EAAAlb,OAAAsd,sBAAA1C,GAAAE,IAAAI,EAAAA,EAAA7V,OAAA,SAAAyV,GAAA,OAAA9a,OAAAud,yBAAA3C,EAAAE,GAAA8B,UAAA,IAAA/B,EAAA5gB,KAAA6R,MAAA+O,EAAAK,EAAA,QAAAL,CAAA,UAAAhW,GAAA+V,GAAA,QAAAE,EAAA,EAAAA,EAAA9f,UAAAC,OAAA6f,IAAA,KAAAD,EAAA,MAAA7f,UAAA8f,GAAA9f,UAAA8f,GAAA,GAAAA,EAAA,EAAAuC,GAAArd,OAAA6a,IAAA,GAAA3a,QAAA,SAAA4a,GAAAzf,GAAAuf,EAAAE,EAAAD,EAAAC,GAAA,GAAA9a,OAAAwd,0BAAAxd,OAAAyd,iBAAA7C,EAAA5a,OAAAwd,0BAAA3C,IAAAwC,GAAArd,OAAA6a,IAAA3a,QAAA,SAAA4a,GAAA9a,OAAA0c,eAAA9B,EAAAE,EAAA9a,OAAAud,yBAAA1C,EAAAC,GAAA,UAAAF,CAAA,UAAA8C,GAAA5C,EAAAzW,IAAA,MAAAA,GAAAA,EAAAyW,EAAA7f,UAAAoJ,EAAAyW,EAAA7f,QAAA,QAAA2f,EAAA,EAAAI,EAAA7f,MAAAkJ,GAAAuW,EAAAvW,EAAAuW,IAAAI,EAAAJ,GAAAE,EAAAF,GAAA,OAAAI,CAAA,UAAA2C,GAAA/C,EAAAE,GAAA,QAAAD,EAAA,EAAAA,EAAAC,EAAA7f,OAAA4f,IAAA,KAAAK,EAAAJ,EAAAD,GAAAK,EAAA0B,WAAA1B,EAAA0B,aAAA,EAAA1B,EAAA2B,cAAA,YAAA3B,IAAAA,EAAA4B,UAAA,GAAA9c,OAAA0c,eAAA9B,EAAAgD,GAAA1C,EAAA5d,KAAA4d,EAAA,WAAA5f,GAAAuf,EAAAK,EAAAN,GAAA,OAAAM,EAAA2C,GAAA3C,GAAA,SAAAL,EAAAD,GAAA,GAAAA,IAAA,UAAAkD,GAAAlD,IAAA,mBAAAA,GAAA,OAAAA,EAAA,YAAAA,EAAA,UAAAmB,UAAA,4EAAAnB,GAAA,YAAAA,EAAA,UAAAmD,eAAA,oEAAAnD,CAAA,CAAAoD,CAAAnD,EAAA,CAAAoD,CAAApD,EAAAqD,KAAAC,QAAAC,UAAAlD,EAAAN,GAAA,GAAAiD,GAAAhD,GAAAwD,aAAAnD,EAAApP,MAAA+O,EAAAD,GAAA,UAAAsD,KAAA,QAAArD,GAAAyD,QAAAjD,UAAAkD,QAAA3c,KAAAuc,QAAAC,UAAAE,QAAA,wBAAAzD,GAAA,QAAAqD,GAAA,mBAAArD,CAAA,cAAAgD,GAAAhD,GAAA,OAAAgD,GAAA7d,OAAAoc,eAAApc,OAAAmc,eAAAN,OAAA,SAAAhB,GAAA,OAAAA,EAAAwB,WAAArc,OAAAmc,eAAAtB,EAAA,EAAAgD,GAAAhD,EAAA,UAAA2D,GAAA3D,EAAAD,GAAA,OAAA4D,GAAAxe,OAAAoc,eAAApc,OAAAoc,eAAAP,OAAA,SAAAhB,EAAAD,GAAA,OAAAC,EAAAwB,UAAAzB,EAAAC,CAAA,EAAA2D,GAAA3D,EAAAD,EAAA,UAAAvf,GAAAuf,EAAAE,EAAAD,GAAA,OAAAC,EAAA8C,GAAA9C,MAAAF,EAAA5a,OAAA0c,eAAA9B,EAAAE,EAAA,CAAAvd,MAAAsd,EAAA+B,YAAA,EAAAC,cAAA,EAAAC,UAAA,IAAAlC,EAAAE,GAAAD,EAAAD,CAAA,UAAAgD,GAAA/C,GAAA,IAAAO,EAAA,SAAAP,GAAA,aAAAiD,GAAAjD,KAAAA,EAAA,OAAAA,EAAA,IAAAD,EAAAC,EAAAE,OAAA0D,aAAA,YAAA7D,EAAA,KAAAQ,EAAAR,EAAAhZ,KAAAiZ,EAAAC,UAAA,aAAAgD,GAAA1C,GAAA,OAAAA,EAAA,UAAAW,UAAA,uDAAA1J,OAAAwI,EAAA,CAAA6D,CAAA7D,GAAA,gBAAAiD,GAAA1C,GAAAA,EAAAA,EAAA,GDYA,GAAQ/gB,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCEzB,IAG3BikB,GAAW,SAAA/jB,GAAA,SAAA+jB,IAAA,IAAA9jB,GA5BjB,SAAAwJ,EAAA2W,GAAA,KAAA3W,aAAA2W,GAAA,UAAAe,UAAA,qCA4BiBjhB,CAAA,KAAA6jB,GAAA,QAAA5jB,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAiTZ,OAjTYC,GAAAR,EAAAS,GAAA,KAAAqjB,EAAA,GAAApjB,OAAAL,IAAA,QAOL,CACJ0jB,WAAW,EACXC,eAAgB,aAChBC,OAAQ,GACRhjB,EAAG,EACHI,EAAG,EACHD,MAAO,EACPI,OAAQ,EACR0iB,WAAW,IACd1jB,GAAAR,EAAA,SACQ,WAAM,IAAAmkB,EACX,IAAKC,KAAwB,QAAjBD,EAACnkB,EAAK8B,MAAMuiB,aAAK,IAAAF,OAAA,EAAhBA,EAAkBG,OAAQ,CACnC,IAAMC,EAAUvkB,EAAK8B,MAAMuiB,MAAMC,MAAM9Z,OAAO,SAAAyW,GAAC,OAAIA,EAAExd,GAAG,GAAE8F,KAAK,SAACC,EAAGC,GAC/D,OAAOD,EAAEuL,KAAKyP,cAAc/a,EAAEsL,UAAMR,EAAW,CAACkQ,SAAS,GAC7D,GACMR,EAASM,EAAQjQ,KAAK,SAAA2M,GAAC,OAAIA,EAAC,OAAQ,IAAKsD,EAAQ,GACvDvkB,EAAKmC,SAAS,CAAC8hB,OAAQA,GAC3B,CACJ,GAACzjB,GAAAR,EAAA,gBACe,SAACa,GACbb,EAAKmC,SAAS,CAAC6hB,eAAgBnjB,EAAGsG,OAAOzE,OAC7C,GAAClC,GAAAR,EAAA,gBACe,SAACa,GACb,IAAMojB,EAASjkB,EAAK8B,MAAMuiB,MAAMC,MAAMhQ,KAAK,SAAAoQ,GAAI,OAAIA,EAAK3P,OAASlU,EAAGsG,OAAOzE,KAAK,GAChF1C,EAAKmC,SAAS,CAAC8hB,OAAQA,GAC3B,GAACzjB,GAAAR,EAAA,aACY,WAAM,IAAA2kB,EAAAC,EAAAC,EAOTN,EAAUvkB,EAAK8B,MAAMuiB,MAAMC,MAAM9Z,OAAO,SAAAyW,GAAC,OAAIA,EAAExd,GAAG,GAAE8F,KAAK,SAACC,EAAGC,GAC/D,OAAOD,EAAEuL,KAAKyP,cAAc/a,EAAEsL,UAAMR,EAAW,CAACkQ,SAAS,GAC7D,GACMK,EAAiB9kB,EAAKwD,MAAM0gB,WAAkC,IAArBlkB,EAAKwD,MAAMpC,OACxB,oBAA9BpB,EAAKwD,MAAMwgB,iBAAyChkB,EAAKwD,MAAMygB,OAE7Dc,GAA2B,QAAjBJ,EAAA3kB,EAAKwD,MAAMygB,cAAM,IAAAU,GAAK,QAALA,EAAjBA,EAAmBlhB,WAAG,IAAAkhB,OAAA,EAAtBA,EAAwB5P,OAAQ,GAChD,OACI5R,EAAAA,cAAA,OAAKC,UAAU,kBACXD,EAAAA,cAAA,QAAM6hB,SAAUhlB,EAAA,QACZmD,EAAAA,cAAA,SAAOC,UAAU,iBACbD,EAAAA,cAAA,aACIA,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAKiH,EAAAA,EAAYC,GAAG,qBACpBlH,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAQ4R,KAAK,SAASlJ,SAAU7L,EAAKilB,cAAeviB,MAAO1C,EAAKwD,MAAMwgB,gBACjE7e,OAAOC,QAtBtB,CACd,aAAc,OACd,YAAa,MACb,aAAc,OACd,kBAAmB,QAkBoC3B,IAAI,SAAA6B,GAAA,IAAAC,EApFvE,SAAA0a,EAAAF,GAAA,gBAAAE,GAAA,GAAA3f,MAAA4kB,QAAAjF,GAAA,OAAAA,CAAA,CAAAkF,CAAAlF,IAAA,SAAAA,EAAAgB,GAAA,IAAAjB,EAAA,MAAAC,EAAA,yBAAAC,QAAAD,EAAAC,OAAAE,WAAAH,EAAA,uBAAAD,EAAA,KAAAD,EAAAI,EAAAI,EAAAG,EAAAlX,EAAA,GAAAqX,GAAA,EAAAR,GAAA,SAAAE,GAAAP,EAAAA,EAAAjZ,KAAAkZ,IAAAmF,KAAA,IAAAnE,EAAA,IAAA9b,OAAA6a,KAAAA,EAAA,OAAAa,GAAA,cAAAA,GAAAd,EAAAQ,EAAAxZ,KAAAiZ,IAAAmB,QAAA3X,EAAApK,KAAA2gB,EAAArd,OAAA8G,EAAApJ,SAAA6gB,GAAAJ,GAAA,UAAAZ,GAAAI,GAAA,EAAAF,EAAAF,CAAA,iBAAAY,GAAA,MAAAb,EAAA,SAAAU,EAAAV,EAAA,SAAA7a,OAAAub,KAAAA,GAAA,kBAAAL,EAAA,MAAAF,CAAA,SAAA3W,CAAA,EAAA6b,CAAApF,EAAAF,IAAA,SAAAE,EAAAzW,GAAA,GAAAyW,EAAA,qBAAAA,EAAA,OAAA4C,GAAA5C,EAAAzW,GAAA,IAAAwW,EAAA,GAAAsF,SAAAve,KAAAkZ,GAAAnP,MAAA,uBAAAkP,GAAAC,EAAAuD,cAAAxD,EAAAC,EAAAuD,YAAAzO,MAAA,QAAAiL,GAAA,QAAAA,EAAA1f,MAAAilB,KAAAtF,GAAA,cAAAD,GAAA,2CAAAwF,KAAAxF,GAAA6C,GAAA5C,EAAAzW,QAAA,GAAAic,CAAAxF,EAAAF,IAAA,qBAAAmB,UAAA,6IAAAwE,EAAA,CAoFuElgB,CAAAF,EAAA,GAAEqgB,EAAMpgB,EAAA,GAAExB,EAAKwB,EAAA,UAC1CpC,EAAAA,cAAA,UAAQV,IAAKkjB,EAAQjjB,MAAOijB,GAAS5hB,EAAe,MAKrC,oBAA9B/D,EAAKwD,MAAMwgB,eACR7gB,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAKiH,EAAAA,EAAYC,GAAG,iBACpBlH,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAQ0I,SAAU7L,EAAK4lB,cAAeljB,MAAO1C,EAAKwD,MAAMygB,OAAOlP,MAC1DwP,EAAQ9gB,IAAI,SAAAihB,GAAI,OACbvhB,EAAAA,cAAA,UAAQV,IAAKiiB,EAAK3P,KAAMrS,MAAOgiB,EAAK3P,MAAO2P,EAAK3P,KAAK4D,MAAM,KAAKkN,MAAe,MAK/F,KAC2B,oBAA9B7lB,EAAKwD,MAAMwgB,iBAAyD,QAAjBY,EAAA5kB,EAAKwD,MAAMygB,cAAM,IAAAW,OAAA,EAAjBA,EAAmBkB,SAAU,IAAIriB,IAAI,SAAAM,GAAS,IAAAgiB,EAE9F,GAAIhiB,EAAMiiB,WAAW,MACjB,OAAO,KAEX,IAAMC,EAAIjc,GAAA,CACNkc,KAAM,EACNnR,KAAMhR,EAAMoiB,eACwB,QADXJ,EACtB/lB,EAAK8B,MAAMuiB,MAAM+B,wBAAgB,IAAAL,OAAA,EAAjCA,EAAoChiB,IAE3C,OAAO/D,EAAKqmB,sBAAsBtiB,EAAOkiB,EAC7C,GAAK,OAGkB,oBAA9BjmB,EAAKwD,MAAMwgB,eACR7gB,EAAAA,cAAA,WACIA,EAAAA,cAAA,SAAO4R,KAAK,WAAW6B,KAAK,SAASlU,OAAwB,QAAjBmiB,EAAA7kB,EAAKwD,MAAMygB,cAAM,IAAAY,OAAA,EAAjBA,EAAmB9P,OAAQ,KACvE5R,EAAAA,cAAA,SAAO4R,KAAK,aAAa6B,KAAK,SAASlU,MAAO4jB,GAAAA,EAAUC,iBACxDpjB,EAAAA,cAAA,SAAO4R,KAAMgQ,EAAU,UAAWyB,UAAQ,EAAC5P,KAAK,SAASlU,MAAM,YAC/DS,EAAAA,cAAA,SAAO4R,KAAK,UAAUyR,UAAQ,EAAC5P,KAAK,SAASlU,MAAM,QACnDS,EAAAA,cAAA,SAAO4R,KAAK,UAAUyR,UAAQ,EAAC5P,KAAK,SAASlU,MAAO1C,EAAK8B,MAAMuiB,MAAMoC,UACrEtjB,EAAAA,cAAA,SAAO4R,KAAK,UAAUyR,UAAQ,EAAC5P,KAAK,SAASlU,MAAM,aACnDS,EAAAA,cAAA,SAAO4R,KAAK,cAAcyR,UAAQ,EAAC5P,KAAK,SAASlU,MAAM,SACvDS,EAAAA,cAAA,SAAO4R,KAAK,MAAMyR,UAAQ,EAAC5P,KAAK,SAASlU,MAAO1C,EAAK8B,MAAMuiB,MAAMzgB,SACjET,EAAAA,cAAA,SAAO4R,KAAK,SAASyR,UAAQ,EAAC5P,KAAK,SAASlU,MAAM,KAClDS,EAAAA,cAAA,SAAO4R,KAAMgQ,EAAU,UAAWyB,UAAQ,EAAC5P,KAAK,SAASlU,MAAO,MAEpE,KACJS,EAAAA,cAAA,OAAKC,UAAU,cACXD,EAAAA,cAAA,UAAQC,UAAU,SAASmI,SAAUuZ,EAAgBlO,KAAK,UACrD5W,EAAKwD,MAAM0gB,UACR/gB,EAAAA,cAAA,QAAMC,UAAU,kBAAiBD,EAAAA,cAACujB,GAAAA,EAAO,MAAG,IAAEtc,EAAAA,EAAYC,GAAG,mBAC7DD,EAAAA,EAAYC,GAAG,uBAM3C,GAAC7J,GAAAR,EAAA,oBACmB,WAChB,IAAM2mB,EAAW,CACbxlB,KAAMnB,EAAKwD,MAAMvC,EAAI,KACrBM,IAAKvB,EAAKwD,MAAMnC,EAAI,KACpBD,MAAOpB,EAAKwD,MAAMpC,MAAQ,KAC1BI,OAAQxB,EAAKwD,MAAMhC,OAAS,MAEhC,OACI2B,EAAAA,cAAA,OAAKC,UAAU,8BAA8BwjB,cAAe5mB,EAAK6mB,gBAC7D1jB,EAAAA,cAAA,OAAKC,UAAU,oBAAoBG,MAAOojB,GACtCxjB,EAAAA,cAAA,QAAMC,UAAU,2BACXpD,EAAKwD,MAAMpC,MAAQ,MAAQpB,EAAKwD,MAAMhC,SAK3D,GAAChB,GAAAR,EAAA,iBAkBgB,SAACa,GACd,GAAIA,EAAGimB,SAAU,CACb,IAAM3f,EAAStG,EAAGE,cACZuF,EAAOzF,EAAGyF,KAShB,OARAA,EAAKvD,iBAAiB,YAAa,WAC/BoE,EAAO5D,MAAMwjB,cAAgB,GAC7BzgB,EAAKqL,SAASlE,KAAKlK,MAAMyjB,WAAa,EAC1C,EAAG,CAACxe,MAAM,IAEVrB,EAAO5D,MAAMwjB,cAAgB,OAC7BzgB,EAAKqL,SAASlE,KAAKlK,MAAMyjB,WAAa,YACtChnB,EAAK8B,MAAMC,aAAac,MAAM6D,WAAWugB,cAAc,IAAIC,aAAa,cAAermB,GAE3F,CAAO,GAAkB,IAAdA,EAAGkN,OAAc,CACxB,IAAMjN,EAAOD,EAAGE,cAAcC,wBAC9BhB,EAAKmC,SAAS,CACVlB,EAAGgC,KAAKC,MAAMrC,EAAGK,QAAUJ,EAAKK,MAChCE,EAAG4B,KAAKC,MAAMrC,EAAGS,QAAUR,EAAKS,KAChCH,MAAO,EACPI,OAAQ,IAEZ,IAAM2lB,EAA+C,oBAA9BnnB,EAAKwD,MAAMwgB,gBAAwChkB,EAAKwD,MAAMygB,OAC/EmD,EAAQD,EAAiBnnB,EAAKwD,MAAMygB,OAAOxgB,IAAIjC,OAASxB,EAAKwD,MAAMygB,OAAOxgB,IAAIrC,MAAQ,KACtFimB,EAAc,SAACngB,GACjBlH,EAAKmC,SAAS,SAACqB,GACX,IAAMpC,EAAQ6B,KAAKC,MAAMD,KAAKgG,IAAI,EAAGhG,KAAKC,MAAMgE,EAAMhG,QAAUJ,EAAKK,MAAQqC,EAAMvC,IAEnF,MAAO,CACHG,MAAOA,EACPI,OAHW2lB,EAAiBlkB,KAAKC,MAAM9B,EAAQgmB,GAASnkB,KAAKC,MAAMD,KAAKgG,IAAI,EAAGhG,KAAKC,MAAMgE,EAAM5F,QAAUR,EAAKS,KAAOiC,EAAMnC,IAKpI,EACJ,EACAR,EAAGyF,KAAKvD,iBAAiB,cAAeskB,GACxCxmB,EAAGyF,KAAKvD,iBAAiB,YAAa,WAClClC,EAAGyF,KAAKQ,oBAAoB,cAAeugB,EAC/C,EAAG,CAAC7e,MAAM,GACd,CACJ,GAAChI,GAAAR,EAAA,SACQ,SAACa,GACNA,EAAGymB,iBACH,IAAMC,EAAO1mB,EAAGsG,OAChBnH,EAAKmC,SAAS,CAAC+hB,WAAW,IAC1B,IAAAsD,EAA8BxnB,EAAKwD,MAA5BvC,EAACumB,EAADvmB,EAAGI,EAACmmB,EAADnmB,EAAGD,EAAKomB,EAALpmB,MAAOI,EAAMgmB,EAANhmB,OACpB,GAAIJ,EAAQ,GAAKI,EAAS,EAAG,CACzB,IAAM4T,EAAOpV,EAAK8B,MAAMC,aAAac,MAAM4D,SAASC,WAAW+gB,UAAU,aACnEC,EAAS/V,SAASC,cAAc,UAChC+V,EAAMD,EAAOE,WAAW,MACxBC,EAAM,IAAIC,MAChBD,EAAIE,IAAM3S,EACVyS,EAAIG,OAAS,WAIT,GAHAN,EAAOtmB,MAAQA,EACfsmB,EAAOlmB,OAASA,EAChBmmB,EAAIM,UAAUJ,GAAM5mB,GAAII,GACU,oBAA9BrB,EAAKwD,MAAMwgB,eACX0D,EAAOQ,OAAO,SAACC,GACXA,EAAKC,cAAc1J,KAAK,SAAA2J,GAAS,OAAIroB,EAAKsoB,YAAYf,EAAMc,EAAU,EAC1E,EAAG,kBACA,GAAkC,eAA9BroB,EAAKwD,MAAMwgB,eAAiC,CACnD,IAAMuE,EAAYZ,EAAIa,aAAa,EAAG,EAAGpnB,EAAOI,GAC1C2mB,EAAO,IAAIM,KAAK,CAACC,KAAAA,YAAiBH,EAAUnT,KAAMhU,EAAOI,IAAU,CAAEoV,KAAM,eACjF+R,KAAAA,OAAiBR,EAAM,UAAYnoB,EAAKwD,MAAMwgB,eAAe4E,QAAQ,OAAQ,KAC7E5oB,EAAKmC,SAAS,CAAC+hB,WAAW,GAC9B,MACIwD,EAAOQ,OAAO,SAACC,GACXQ,KAAAA,OAAiBR,EAAM,UAAYnoB,EAAKwD,MAAMwgB,eAAe4E,QAAQ,OAAQ,KAC7E5oB,EAAKmC,SAAS,CAAC+hB,WAAW,GAC9B,EAAGlkB,EAAKwD,MAAMwgB,eAEtB,CACJ,CACJ,GAACxjB,GAAAR,EAAA,wBAuCuB,SAAC+D,EAAOkiB,GAC5B,IAAI4C,EAAe5C,EAAK4C,cAAgB,GACpCC,GAAgB,EAQpB,GAPI/kB,IAAU/D,EAAK8B,MAAMuiB,MAAM0E,2BAC3BF,EAAe7oB,EAAKgpB,uBACpBF,GAAgB,GACT/kB,IAAU/D,EAAK8B,MAAMuiB,MAAM4E,2BAClCJ,EAAe7oB,EAAKkpB,sBACpBJ,GAAgB,GAEhBA,GAAiB9oB,EAAK8B,MAAMqnB,wBAC5B,OAAQhmB,EAAAA,cAAA,MAAIV,IAAK,SAAWsB,GAAOZ,EAAAA,cAAA,MAAIimB,QAAQ,KAAIjmB,EAAAA,cAAA,SAAO0lB,aAAcA,EAAc9T,KAAMkR,EAAKlR,KAAM6B,KAAK,aAE5G,GAAIqP,EAAK1mB,QACL,OACI4D,EAAAA,cAAA,MAAIV,IAAK,SAAWsB,GAChBZ,EAAAA,cAAA,UAAKmjB,GAAAA,EAAU+C,gBAAgBtlB,IAC/BZ,EAAAA,cAAA,UACIA,EAAAA,cAAA,UAAQ0lB,aAAcA,EAAc9T,KAAMkR,EAAKlR,MAC1CkR,EAAK1mB,QAAQkE,IAAI,SAAAf,GAAK,OAAKS,EAAAA,cAAA,UAAQV,IAAKC,EAAOA,MAAOA,GAAQA,EAAe,MAM9F,IAAMa,EAAQ,CAAC,EAOf,OANI0iB,EAAKC,MAAQD,EAAKqD,QAClB/lB,EAAMgmB,OAAS,QAEftD,EAAKqD,OACL/lB,EAAMnC,MAAQ,WAGd+B,EAAAA,cAAA,MAAIV,IAAK,SAAWsB,GAChBZ,EAAAA,cAAA,UAAKmjB,GAAAA,EAAU+C,gBAAgBtlB,IAC/BZ,EAAAA,cAAA,UAAIA,EAAAA,cAAA,WAAAkf,GAAA,GAAc4D,EAAI,CAAE4C,aAAcA,EAAcrC,SAAUsC,EAAevlB,MAAOA,MAKxG,GAAC/C,GAAAR,EAAA,uBACsB,WAEnB,MAAO,EACX,GAACQ,GAAAR,EAAA,sBACqB,WAElB,MAAO,EACX,GAACA,CAAA,QA7UL,SAAAggB,EAAAD,GAAA,sBAAAA,GAAA,OAAAA,EAAA,UAAAmB,UAAA,sDAAAlB,EAAAQ,UAAArb,OAAAwb,OAAAZ,GAAAA,EAAAS,UAAA,CAAAgD,YAAA,CAAA9gB,MAAAsd,EAAAiC,UAAA,EAAAD,cAAA,KAAA7c,OAAA0c,eAAA7B,EAAA,aAAAiC,UAAA,IAAAlC,GAAA4D,GAAA3D,EAAAD,EAAA,CA6UKvd,CAAAshB,EAAA/jB,GA7ULggB,EA6UK+D,EA7UL7D,EA6UK,EAAAxd,IAAA,SAAAC,MA/KD,WAAS,IAAAC,EAAA,KACC6mB,EAAgB5mB,KAAKY,MAAMugB,UAAY3Z,EAAAA,EAAYC,GAAG,kBAAoBD,EAAAA,EAAYC,GAAG,kBACzFof,EAAa7mB,KAAKY,MAAMugB,UAAY,eAAiB,aACrD2F,EACFvmB,EAAAA,cAACyH,EAAAA,EAAI,CAACxH,UAAU,8BAA8ByH,KAAM4e,EAAY/e,QAAS,WAAF,OAAQ/H,EAAKR,SAAS,SAACqB,GAAK,MAAM,CAACugB,WAAYvgB,EAAMugB,UAAU,EAAE,EAAE5Z,MAAOqf,IAErJ,OACIrmB,EAAAA,cAACqK,EAAAA,EAAO,CAACmc,aAAa,YAAYD,qBAAsBA,EAAsB7e,KAAM,eAChFvL,GAAG,cAAc0W,OAAQpT,KAAKoT,OAAQ7L,MAAOC,EAAAA,EAAYC,GAAG,6BAA8BjJ,MAAM,QAE/F,iBAAO,CACJqM,KAAM9K,EAAK+K,aACXkc,MAAOjnB,EAAKknB,oBACf,EAGb,GAAC,CAAApnB,IAAA,cAAAC,OA9KLyd,EA8KKuB,KAAAE,EAyED,SAAAkI,EAAkBvC,EAAMc,GAAS,IAAA0B,EAAA3U,EAAA1P,EAAAskB,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAppB,EAAAI,EAAAD,EAAAI,EAAA8oB,EAAAnC,EAAA,OAAAzG,KAAAC,EAAA,SAAA4I,GAAA,cAAAA,EAAApK,GAAA,OAW5B,OAVK4J,EAAQ/f,GAAAA,GAAA,GACPwgB,KAAgB,IAAIC,SAASlD,KAC7BpiB,OAAOulB,aAAa9nB,KAAKd,MAAMuiB,MAAMsG,sBAAwB,IAAIhS,MAAM,KAAKnO,OAAOiZ,SAAShgB,IAAI,SAAA2S,GAAK,OAAIA,EAAMuC,MAAM,IAAI,KAE1HvD,EAAOjQ,OAAOC,QAAQ2kB,GAAUtmB,IAAI,SAACmnB,GAAI,OAC3CA,EAAKnnB,IAAI,SAAA2S,GAAK,OAAIyU,mBAAmBzU,GAAOwS,QAAQ,OAAQ,IAAI,GAAEjlB,KAAK,IAAI,GAC7EA,KAAK,KACD+B,EAAS,CACXolB,QAAS,CAAC,eAAgB,qCAC1BC,aAAc,eACjBR,EAAApK,EAAA,EACsB6K,GAAAA,EAAMC,KAAKroB,KAAKd,MAAMuiB,MAAM6G,SAAU9V,EAAM1P,GAAO,OAA5D,KAARskB,EAAQO,EAAAxJ,GACA,CAAFwJ,EAAApK,EAAA,eAAAoK,EAAApK,EAAA,EACoB,+BAAiB,OAA3B,OAA2B8J,EAAAM,EAAAxJ,EAAtCmJ,EAAWD,EAAXC,YAAWK,EAAApK,EAAA,EACA+J,EAAY/d,KAAK6d,EAAS5U,MAAK,OACnB,OADxB+U,EAAGI,EAAAxJ,EACHqJ,EAAOD,EAAIgB,WAAW,GAAEZ,EAAApK,EAAA,EACPgK,EAAIiB,SAAS/C,GAAU,OAU3C,OAVGgC,EAAQE,EAAAxJ,EACR9f,EAA8B,OAA1B2B,KAAKY,MAAMygB,OAAOxgB,IAAIxC,EAC1BI,EAA8B,OAA1BuB,KAAKY,MAAMygB,OAAOxgB,IAAIpC,EAC1BD,EAAsC,OAA9BwB,KAAKY,MAAMygB,OAAOxgB,IAAIrC,MAC9BI,EAAwC,OAA/BoB,KAAKY,MAAMygB,OAAOxgB,IAAIjC,OACrC4oB,EAAKnC,UAAUoC,EAAU,CACrBppB,EAAGA,EACHI,EAAGA,EACHD,MAAOA,EACPI,OAAQA,IACT+oB,EAAApK,EAAA,EACmBgK,EAAIkB,OAAM,OAA1Bf,EAAOC,EAAAxJ,EACPoH,EAAO,IAAIM,KAAK,CAAC6B,GAAU,CAAE1T,KAAM,oBACzC+R,KAAAA,OAAiBR,EAAMvlB,KAAKY,MAAMygB,OAAOlP,KAAO,QAChDnS,KAAKT,SAAS,CAAC+hB,WAAW,IAAQqG,EAAApK,EAAA,eAGlCmL,MAAM,gBACN1oB,KAAKT,SAAS,CAAC+hB,WAAW,IAAQ,cAAAqG,EAAA/gB,EAAA,KAAAsgB,EAAA,QA5GzCyB,EA9KL,eAAAvL,EAAA,KAAAD,EAAA5f,UAAA,WAAAgiB,QAAA,SAAAlC,EAAAI,GAAA,IAAA7W,EAAA2W,EAAAlP,MAAA+O,EAAAD,GAAA,SAAAyL,EAAArL,GAAA+B,GAAA1Y,EAAAyW,EAAAI,EAAAmL,EAAAC,EAAA,OAAAtL,EAAA,UAAAsL,EAAAtL,GAAA+B,GAAA1Y,EAAAyW,EAAAI,EAAAmL,EAAAC,EAAA,QAAAtL,EAAA,CAAAqL,OAAA,MA4RK,SArCgBE,EAAAC,GAAA,OAAAJ,EAAAta,MAAC,KAAD9Q,UAAA,KAvPrB8f,GAAA6C,GAAA/C,EAAAS,UAAAP,GAAA9a,OAAA0c,eAAA9B,EAAA,aAAAkC,UAAA,IAAAlC,EAAA,IAAAA,EAAAE,EAAAE,EA8KKoL,CAyEgB,CA3NJ,CAASpoB,EAAAA,WAAe3C,GAAnCsjB,GAAW,YACM,CACfqF,wBAAyBnlB,IAAAA,KACzBjC,aAAciC,IAAAA,OACd4nB,eAAgB5nB,IAAAA,KAChBqgB,MAAOrgB,IAAAA,SA+Sf,UAAeC,EAAAA,EAAAA,IAAQ,SAACT,GAAK,MAAM,CACnC,CAAC,EAAG,CACAooB,eAAgBA,EAAAA,gBAFpB,CAGG9H,I,8jGClTH+H,GAAAA,GAAQC,SACJC,GAAAA,GACAC,GAAAA,GACAC,GAAAA,GACAC,GAAAA,GACAC,GAAAA,GACAC,GAAAA,GACAC,GAAAA,IACF,IAEIC,GAAwB,SAAAC,GAO1B,SAAAD,EAAYxqB,GAAO,IAAA9B,EAKK,OALLC,GAAA,KAAAqsB,GACF9rB,GAAbR,EAAAS,GAAA,KAAA6rB,EAAA,CAAMxqB,IAAO,QAMT,CACJ0qB,aAAa,EACbC,SAAU,KACbjsB,GAAAR,EAAA,mBAmBkB,WACfA,EAAK0sB,eAAeC,OACxB,GAACnsB,GAAAR,EAAA,mBACkB,WACfA,EAAK0sB,eAAe3pB,iBAAiB,eAAgB/C,EAAK8B,MAAMuQ,SAAS,GACzE,IAAMua,EAAY5sB,EAAK0sB,eAAe/a,SAASkb,eAAe,0BAC9D,GAAID,EAAW,CACX,IAAME,EAAW9sB,EAAK0sB,eAAe/a,SAASC,cAAc,OAC5Dkb,EAASxtB,GAAK,QACdwtB,EAASvpB,MAAMwpB,aAAe,MAC9BD,EAASE,UAAY,4HACsC5iB,EAAAA,EAAYC,GAAG,uBAAyB,YACnGuiB,EAAU9a,YAAYgb,GAEtB9sB,EAAKitB,QAAUjtB,EAAK0sB,eAAe/a,SAASC,cAAc,OAC1D5R,EAAKitB,QAAQD,UAAY5iB,EAAAA,EAAYC,GAAG,8BACxCuiB,EAAU9a,YAAY9R,EAAKitB,SAE3BjtB,EAAKktB,SAAWltB,EAAK0sB,eAAe/a,SAASC,cAAc,OAC3D5R,EAAKktB,SAAS5tB,GAAK,UACnBstB,EAAU9a,YAAY9R,EAAKktB,UAE3BltB,EAAKmC,SAAS,CAACqqB,aAAa,IAC5BxsB,EAAK0sB,eAAe/a,SAASlE,KAAKlK,MAAM4pB,UAAY,QACxD,MACIntB,EAAK0sB,eAAe/a,SAASlE,KAAKuf,UAAY,wEAEtD,GAACxsB,GAAAR,EAAA,uBACsB,WACnByB,aAAazB,EAAKotB,gBAClBptB,EAAKotB,eAAiBzrB,WAAW3B,EAAKqtB,aAAc,IACxD,GAAC7sB,GAAAR,EAAA,eACc,WACX,IAAM+nB,EAAM/nB,EAAK8B,MAAMC,aAAac,MAAM4D,SAASC,WAAW+gB,UAAU,aAClErmB,EAAQpB,EAAK8B,MAAMC,aAAac,MAAM4D,SAASC,WAAW4mB,YAChEttB,EAAKitB,QAAQD,UAAY,aAAHtsB,OAAgBqnB,EAAG,qCAAArnB,OAAoCU,EAAK,SACtF,GAACZ,GAAAR,EAAA,gBACe,WACRA,EAAKutB,OACLvtB,EAAKutB,MAAMhE,QAEnB,GApEIvpB,EAAK0sB,eAAiB,KACtB1sB,EAAKutB,MAAQ,KACbvtB,EAAKktB,SAAW,KAChBltB,EAAKitB,QAAU,KAAKjtB,CACxB,CAAC,OAAAwC,GAAA8pB,EAAAC,GAAAiB,GAAAlB,EAAA,EAAA7pB,IAAA,oBAAAC,MAKD,WACI,IAAM+qB,EAAenH,GAAAA,EAAUoH,kBAAkB9qB,KAAKd,MAAM2rB,cAC5D7qB,KAAK8pB,eAAiBiB,OAAOC,KAAKH,EAAcrjB,EAAAA,EAAYC,GAAG,uBAAwB,iGACvFzH,KAAK8pB,eAAe3pB,iBAAiB,OAAQH,KAAKirB,kBAAkB,GACpEjrB,KAAK8pB,eAAe3pB,iBAAiB,SAAUH,KAAKkrB,eAAe,GACnEH,OAAO5qB,iBAAiB,eAAgBH,KAAKmrB,kBAC7CnrB,KAAKd,MAAMC,aAAac,MAAMyD,KAAKC,SAASxD,iBAAiB,SAAUH,KAAKorB,qBAChF,GAAC,CAAAvrB,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GACrBxK,KAAKY,MAAMgpB,cAAgBpf,EAAUof,aACtC5pB,KAAKyqB,cAEb,GAAC,CAAA5qB,IAAA,uBAAAC,MACD,WACIE,KAAKmrB,mBACLJ,OAAO7mB,oBAAoB,eAAgBlE,KAAKmrB,kBAChDnrB,KAAKd,MAAMC,aAAac,MAAMyD,KAAKC,SAASO,oBAAoB,SAAUlE,KAAKorB,qBACnF,GAAC,CAAAvrB,IAAA,SAAAC,MA2CD,WAAS,IAAAC,EAAA,KACL,OAAKC,KAAKY,MAAMgpB,YAGT5Z,GAAAA,aAAsBhQ,KAAKd,MAAM+S,SAAS,SAAAxS,GAAOM,EAAK4qB,MAAQlrB,CAAG,GAAG,GAAQO,KAAKsqB,UAF7E,IAGf,IAAC,CAnFyB,CAAS/pB,EAAAA,eAAmB3C,GAApD8rB,GAAwB,YACP,CACfzX,SAAU7Q,IAAAA,KACVqO,QAASrO,IAAAA,KACTjC,aAAciC,IAAAA,OACdypB,aAAczpB,IAAAA,SACjB,IAiFgBiqB,GAAa,SAAAluB,GAoB9B,SAAAkuB,EAAYnsB,GAAO,IAAAyL,EAGgB,OAHhBtN,GAAA,KAAAguB,GACFztB,GAAb+M,EAAA9M,GAAA,KAAAwtB,EAAA,CAAMnsB,IAAO,QALT,CACJosB,aAAa,EACb3X,SAAS,IACZ/V,GAAA+M,EAAA,UAwBS,WACNA,EAAKpL,SAAS,CAACoU,SAAS,EAAO2X,aAAa,IAC5C3gB,EAAK4gB,OAAO5X,SAAU,CAC1B,GAAC/V,GAAA+M,EAAA,sBA0BqB,SAAC6gB,EAASC,GAC5B,IAAMC,EAAclkB,EAAAA,EAAYC,GAAG,0BAC7BkkB,EAAYnkB,EAAAA,EAAYC,GAAG,wBAC3BmkB,EAASpkB,EAAAA,EAAYC,GAAG,qBAExB+K,EAAO,CACT0Q,OAAQvY,EAAKzL,MAAMsT,KAAK3R,IAAI,SAAA2S,GAAK,OAAIA,EAAM,EAAE,GAC7CqY,SAAU,CACN,CACIrZ,KAAM7H,EAAKzL,MAAMsT,KAAK3R,IAAI,SAAA2S,GAAK,OAAIA,EAAM,EAAE,GAC3CsY,MAAM,EACNC,gBAAiB,oBACjBC,YAAa,eACbC,YAAa,EACbC,YAAa,EACbzd,MAAO,KAKb0d,EAAYxhB,EAAKzL,MAAMsT,KAAK7H,EAAKzL,MAAMsT,KAAKhV,OAAS,GAAG,GACxD4uB,EAAY/rB,KAAKgG,IAAGgI,MAARhO,KAAIyM,GAAQnC,EAAKzL,MAAMsT,KAAK3R,IAAI,SAAAxC,GAAC,OAAIA,EAAE,EAAE,KACrDguB,EAAehsB,KAAKisB,IAAI,GAAIjsB,KAAKksB,KAAKlsB,KAAKmsB,MAAML,EAAY,MAC7DM,EAAWpsB,KAAKC,MAAM6rB,EAAaE,GAAiBA,EAAe,GACnEK,EAAO/hB,EAAKzL,MAAMytB,uBAClBhwB,EAAU,CACZiwB,YAAY,EACZC,qBAAqB,EACrBC,UAAW,CACPC,SAAU,GAEdC,QAAS,CACLC,OAAQ,CACJC,SAAS,GAEb7b,QAAS,CACL9P,QAASkqB,EACT0B,WAAW,EACXC,eAAe,EACfC,SAAU,CAACC,OAAQ,QACnBC,UAAW,CACPhmB,MAAO,SAACwd,GAAG,OAAM2G,EAAc,KAAO8B,GAAAA,EAAaC,kBAAkB1I,EAAI,GAAG2I,OAAOrvB,GAAG,EAAO,SAAS,EACtG8C,MAAO,SAAC4jB,GAAG,OAAM4G,EAAY,KAAO6B,GAAAA,EAAaC,kBAAkB1I,EAAI2I,OAAOjvB,GAAG,EAAO,KAAO,IAAMmtB,CAAM,KAIvH+B,OAAQ,CACJtvB,EAAG,CACC2V,KAAM,SACN4Z,MAAO,CACHnB,SAAUA,EACVoB,KAAM,CAACtgB,KAAM,IACbugB,SAAU,SAAChuB,GAAK,OAAKA,CAAK,GAE9ByH,MAAO,CACH2lB,SAAS,EACTa,KAAMrC,EAAc,OACpBsC,QAAS,GAEb3nB,IAAKhG,KAAKksB,KAAKJ,IAEnB1tB,EAAG,CACCmvB,MAAO,CACHC,KAAM,CAACtgB,KAAM,IACbugB,SAAU,SAAChuB,GAAK,OAAKA,EAAMgB,QAAQ4rB,EAAK,GAE5CnlB,MAAO,CACH2lB,SAAS,EACTa,KAAMpC,EAAY,OAASC,EAAS,KAExCvlB,IAAKhG,KAAKksB,KAAKH,KAGvB6B,QAASxC,EAAc,SAACyC,EAAKC,EAAWxD,GACpC,IAAMyD,EAAYzD,EAAMyD,UAClBC,EAAShuB,KAAKsN,IAAItN,KAAKgG,IAAI6nB,EAAI7vB,EAAI+vB,EAAU7vB,MAAO6vB,EAAU5vB,OACpEmM,EAAK2jB,aAAaD,EAASD,EAAU5vB,MAAQ2tB,EACjD,OAAIxa,GAGR,OACIpR,EAAAA,cAAA,OAAKC,UAAU,iCAAiC+tB,aAAc5jB,EAAK6jB,WAAY3mB,KAAK,OAAOlH,MAAO,CAACoE,SAAU,aACzGxE,EAAAA,cAACkuB,GAAAA,GAAI,CAACjc,KAAMA,EAAM7V,QAASA,EAAS8D,IAAK+qB,IAGrD,GAAC5tB,GAAA+M,EAAA,cACa,WACNA,EAAKggB,OACLhgB,EAAKggB,MAAMhE,QAEnB,GAAC/oB,GAAA+M,EAAA,eACc,SAAC+jB,GACZ,IAAMlc,EAAO7H,EAAKzL,MAAMsT,KAClBmL,EAAInL,EAAKmc,UAAU,SAAAtwB,GAAC,OAAIA,EAAE,IAAMqwB,CAAI,GAC1C,GAAU,IAAN/Q,EACAhT,EAAK4gB,OAAOrgB,UAAU,CAAA0B,GAAKhL,EAAAA,IAAOkL,GAAI0F,EAAK,WACxC,CACH,IAAMoc,GAAUF,EAAOlc,EAAKmL,EAAI,GAAG,KAAOnL,EAAKmL,GAAG,GAAKnL,EAAKmL,EAAI,GAAG,IAC7Dte,EAAI,IAAIuC,EAAAA,IACV4Q,EAAKmL,EAAI,GAAG,GAAKiR,GAAUpc,EAAKmL,GAAG,GAAKnL,EAAKmL,GAAG,IAChDnL,EAAKmL,EAAI,GAAG,GAAKiR,GAAUpc,EAAKmL,GAAG,GAAKnL,EAAKmL,GAAG,IAChDnL,EAAKmL,EAAI,GAAG,GAAKiR,GAAUpc,EAAKmL,GAAG,GAAKnL,EAAKmL,GAAG,KAEpDhT,EAAK4gB,OAAOrgB,UAAU,CAAC7L,GAC3B,CACAsL,EAAK4gB,OAAO5X,SAAU,CAC1B,GAAC/V,GAAA+M,EAAA,aACY,WACTA,EAAK4gB,OAAO5X,SAAU,CAC1B,GAAC/V,GAAA+M,EAAA,gBACe,WACZ,IAAIkkB,EAAM,GACVA,GAAO,+BACPlkB,EAAKzL,MAAMsT,KAAK/P,QAAQ,SAAC+Q,EAAOrF,GAC5B,IAAM2gB,EAAatb,EAAM,GAAnBsb,EAA0Btb,EAAM,GAChCkZ,EAAO/hB,EAAKzL,MAAMytB,uBAClBzmB,EAAW7F,KAAKC,MAAMwuB,EAAWzuB,KAAKisB,IAAI,GAAII,IAASrsB,KAAKisB,IAAI,GAAII,GACpE9tB,EAASyB,KAAKC,MAAMwuB,EAAWzuB,KAAKisB,IAAI,GAAII,IAASrsB,KAAKisB,IAAI,GAAII,GACxEmC,GAAOja,OAAOzG,GAAK6X,QAAQ,IAAK,MAAQ,KAClCpR,OAAO1O,GAAY,KACnB0O,OAAOhW,GAAU,IAC3B,GACAmnB,KAAAA,OAAiB,IAAIF,KAAK,CAACgJ,GAAM,CAAC7a,KAAM,6BAA8B,oBAC1E,GA7KIrJ,EAAKggB,MAAQ,KACbhgB,EAAKokB,mBAAqB,KAAKpkB,CACnC,CAAC,OAAA/K,GAAAyrB,EAAAluB,GAAAytB,GAAAS,EAAA,EAAAxrB,IAAA,oBAAAC,MACD,WACIE,KAAKurB,OAAS,IAAIzf,GAAAA,GAAM,CACpBkjB,kBAAkB,EAClBC,UAAU,EACV7hB,cAAc,EACd8hB,qBAAsB,SAAFxsB,GAAA,IAAIqC,EAAQrC,EAARqC,SAAQ,OAAMyoB,GAAAA,EAAaC,kBAAkB1oB,EAASvF,GAAG,EAAO,IAAI,IAEhGQ,KAAKurB,OAAO5X,SAAU,EACtB3T,KAAKd,MAAMC,aAAac,MAAMgG,IAAIjG,KAAKurB,OAC3C,GAAC,CAAA1rB,IAAA,uBAAAC,MACD,WACIE,KAAKd,MAAMC,aAAac,MAAMiR,OAAOlR,KAAKurB,OAC9C,GAAC,CAAA1rB,IAAA,qBAAAC,MACD,SAAmByK,GACXvK,KAAKd,MAAMsT,OAASjI,EAAUiI,MAC9BxS,KAAKT,SAAS,CAACoU,SAAS,GAEhC,GAAC,CAAA9T,IAAA,SAAAC,MAKD,WAAS,IAAAqvB,EAAA,KACL,IAAKnvB,KAAKY,MAAM+S,QACZ,OAAO,KAEX,IAAMyb,EAAgB,CAClB,CAACnnB,KAAM,SAAU6lB,SAAU9tB,KAAKqvB,cAAe9nB,MAAOC,EAAAA,EAAYC,GAAG,yBACrE,CAACQ,KAAM,QAAS3E,OAAQtD,KAAKY,MAAM0qB,YAAawC,SAAU,WAAF,OAAQqB,EAAK5vB,SAAS,SAAAqB,GAAK,MAAK,CAAC0qB,aAAc1qB,EAAM0qB,YAAY,EAAE,EAAE/jB,MAAOC,EAAAA,EAAYC,GAAG,yBAEvJ,MAAO,CACHlH,EAAAA,cAAC8O,GAAAA,EAAgB,CACbigB,SAAS,SAASF,cAAeA,EAAennB,KAAK,OACrDsnB,cAAevvB,KAAKd,MAAMN,OAAQ2Q,aAAc,IAAKigB,iBAAe,EACpE3vB,IAAI,gBAAgB4P,QAASzP,KAAKyP,QAASggB,wBAAyBzvB,KAAK0vB,YACzEC,uBAAqB,EACrBpoB,MAAOC,EAAAA,EAAYC,GAAG,uBAAwBmoB,WAAW,GAExD5vB,KAAK6vB,oBAAoB,SAACpwB,GAAS0vB,EAAKxE,MAAQlrB,CAAI,GAAG,IAGhEO,KAAKY,MAAM0qB,YACP/qB,EAAAA,cAACmpB,GAAwB,CAAC7pB,IAAI,qBAAqB4P,QAAS,WAAF,OAAQ0f,EAAK5vB,SAAS,CAAC+rB,aAAa,GAAO,EAAEnsB,aAAca,KAAKd,MAAMC,aAAc0rB,aAAc7qB,KAAKd,MAAM2rB,cAClK7qB,KAAK6vB,qBAEV,KACR,IAAC,CAvE6B,CAAStvB,EAAAA,W,+kDAAe3C,GAArCytB,GAAa,YACX,CACf7Y,KAAMpR,IAAAA,MAENxC,OAAQwC,IAAAA,OAERurB,uBAAwBvrB,IAAAA,OACxBjC,aAAciC,IAAAA,OAEdypB,aAAczpB,IAAAA,SACjBxD,GAVgBytB,GAAa,eAWR,CAClBsB,uBAAwB,EACxB/tB,OAAQ,IACRisB,aAAc,wC,SCpHmB,IAGpBiF,GAAS,SAAA3yB,GAiB1B,SAAA2yB,EAAY5wB,GAAO,IAAA9B,EAGc,O,4FAHdC,CAAA,KAAAyyB,GACFlyB,GAAbR,EAAAS,GAAA,KAAAiyB,EAAA,CAAM5wB,IAAO,QART,CACJgR,KAAM,KACN1J,OAAQ,KACRupB,QAAS,SACTC,SAAU,SACVC,SAAU,aACbryB,GAAAR,EAAA,SAiBQ,SAAC8S,GACN9S,EAAKmC,SAAS,CAAC2Q,KAAMA,QAAAA,EAAQ,UAC7B9S,EAAK8yB,gBAAkB,IAAIC,gBAC3B/yB,EAAKgzB,YAAc,IAAIC,GAAAA,GAAS,CAC5BC,SAAUlzB,EAAK8B,MAAMC,aAAac,QAEtC7C,EAAKmzB,UAAY,IAAIC,GAAAA,EAAW,CAC5BC,OAAQ,IAAIC,GAAAA,EAAa,CACrBle,KAAM,GACNuQ,OAAQ,IAAI4N,GAAAA,EAAG5N,OAAO6N,QACtBjwB,MAAOvD,EAAKyzB,yBAGpBzzB,EAAK8B,MAAMC,aAAa0B,IAAIiwB,SAAS1zB,EAAKmzB,UAC9C,GAAC3yB,GAAAR,EAAA,SACQ,WACLA,EAAK2zB,cACL3zB,EAAKmC,SAAS,CAAC2Q,KAAM,OACrB9S,EAAK8yB,gBAAgBc,QACrB5zB,EAAK8yB,gBAAkB,KACvB9yB,EAAKgzB,YAAY9lB,UACjBlN,EAAKgzB,YAAc,KACnBhzB,EAAK8B,MAAMC,aAAa0B,IAAIowB,YAAY7zB,EAAKmzB,UAAW,CAACjmB,SAAS,GACtE,GAAC1M,GAAAR,EAAA,qBACoB,WACjB,IAAMmU,EAAU,CACZ,CAAC1R,IAAK,QAASsB,MAAOqG,EAAAA,EAAYC,GAAG,gCACrC,CAAC5H,IAAK,aAAcsB,MAAOqG,EAAAA,EAAYC,GAAG,iCAC1C,CAAC5H,IAAK,UAAWsB,MAAOqG,EAAAA,EAAYC,GAAG,gCAE3C,OACIlH,EAAAA,cAAC+Q,GAAAA,EAAS,CAAChO,OAAQlG,EAAKwD,MAAMsP,KAAMqB,QAASA,EAASzJ,QAAS,SAAAoI,GAAI,OAAI9S,EAAKmC,SAAS,CAAC2Q,KAAAA,EAAM1J,OAAQ,MAAM,GAElH,GAAC5I,GAAAR,EAAA,eACc,WACX,IAAKA,EAAKwD,MAAM4F,OACZ,OAAO,KAEX,IAAIunB,EAAO,GACPmD,EAAe,KAEnB,GAAwB,UAApB9zB,EAAKwD,MAAMsP,KAAkB,CAC7B6d,EAAO9sB,EAAAA,EAAiBkwB,uBAAuB/zB,EAAKwD,MAAM4F,OAAOlB,IAAI4I,MAAM,EAAG,GAAI9Q,EAAK8B,MAAMC,aAAa6B,QAC1G,IAAM0rB,EAAO0E,EAAAA,EAAYC,cAAc,wBACvCtD,GAAQ,MAAQ3wB,EAAKwD,MAAM4F,OAAO8qB,OAAS,GAA6B,WAAxBl0B,EAAKwD,MAAMqvB,SAAwB7yB,EAAKwD,MAAM4F,OAAO8qB,OAASl0B,EAAKwD,MAAM4F,OAAOlB,IAAI,IAAIxE,QAAQ4rB,GAE5IwE,EADA9zB,EAAKwD,MAAM4F,OAAO8qB,OAAS,EAEvB/wB,EAAAA,cAAA,UAAQ0I,SAAU,SAAAhL,GAAE,OAAIb,EAAKmC,SAAS,CAAC0wB,SAAUhyB,EAAGsG,OAAOzE,OAAO,EAAEA,MAAO1C,EAAKwD,MAAMqvB,UAClF1vB,EAAAA,cAAA,UAAQT,MAAM,UAAU0H,EAAAA,EAAYC,GAAG,4BACvClH,EAAAA,cAAA,UAAQT,MAAM,YAAY0H,EAAAA,EAAYC,GAAG,+BAK7ClH,EAAAA,cAAA,QAAMC,UAAU,sBAAsBgH,EAAAA,EAAYC,GAAG,6BAGjE,KAA+B,eAApBrK,EAAKwD,MAAMsP,MAClB6d,EAAOP,GAAAA,EAAaC,kBAAkBrwB,EAAKwD,MAAM4F,OAAOhJ,QAAQ,EAAOJ,EAAKwD,MAAMmvB,SAClFmB,EACI3wB,EAAAA,cAAA,UAAQ0I,SAAU,SAAAhL,GAAE,OAAIb,EAAKmC,SAAS,CAACwwB,QAAS9xB,EAAGsG,OAAOzE,OAAO,EAAEA,MAAO1C,EAAKwD,MAAMmvB,SACjFxvB,EAAAA,cAAA,UAAQT,MAAM,UAAU0H,EAAAA,EAAYC,GAAG,4BACvClH,EAAAA,cAAA,UAAQT,MAAM,YAAY0H,EAAAA,EAAYC,GAAG,8BACzClH,EAAAA,cAAA,UAAQT,MAAM,KAAI,KAClBS,EAAAA,cAAA,UAAQT,MAAM,MAAK,MACnBS,EAAAA,cAAA,UAAQT,MAAM,MAAK,MACnBS,EAAAA,cAAA,UAAQT,MAAM,MAAK,QAGA,YAApB1C,EAAKwD,MAAMsP,OAClB6d,EAAOP,GAAAA,EAAaC,kBAAkBrwB,EAAKwD,MAAM4F,QAAQ,EAAMpJ,EAAKwD,MAAMovB,UAC1EkB,EACI3wB,EAAAA,cAAA,UAAQ0I,SAAU,SAAAhL,GAAE,OAAIb,EAAKmC,SAAS,CAACywB,SAAU/xB,EAAGsG,OAAOzE,OAAO,EAAEA,MAAO1C,EAAKwD,MAAMovB,UAClFzvB,EAAAA,cAAA,UAAQT,MAAM,UAAU0H,EAAAA,EAAYC,GAAG,4BACvClH,EAAAA,cAAA,UAAQT,MAAM,YAAY0H,EAAAA,EAAYC,GAAG,8BACzClH,EAAAA,cAAA,UAAQT,MAAM,OAAM,MACpBS,EAAAA,cAAA,UAAQT,MAAM,MAAK,MACnBS,EAAAA,cAAA,UAAQT,MAAM,QAAO,OACrBS,EAAAA,cAAA,UAAQT,MAAM,QAAO,OACrBS,EAAAA,cAAA,UAAQT,MAAM,QAAO,QACrBS,EAAAA,cAAA,UAAQT,MAAM,QAAO,SAIjC,OACIS,EAAAA,cAAA,OAAKC,UAAU,gBACXD,EAAAA,cAAA,SAAOC,UAAU,iBAAiBojB,UAAQ,EAAC5P,KAAK,OAAOlU,MAAOiuB,IAC7DmD,EACD3wB,EAAAA,cAACgxB,GAAAA,EAAU,CAACxD,KAAMA,IAG9B,GAACnwB,GAAAR,EAAA,uBAoBsB,WACnB,MAAO,CACH,IAAIuzB,GAAAA,EAAGhwB,MAAM6wB,MAAM,CACf1F,KAAM,IAAI6E,GAAAA,EAAGhwB,MAAM8wB,KAAK,CACpB9kB,MAAO,CAAC,GAAI,IAAK,IAAK,QAG9B,IAAIgkB,GAAAA,EAAGhwB,MAAM6wB,MAAM,CACfE,OAAQ,IAAIf,GAAAA,EAAGhwB,MAAMgxB,OAAO,CACxBhlB,MAAO,CAAC,IAAK,IAAK,KAClBnO,MAAO,MAGf,IAAImyB,GAAAA,EAAGhwB,MAAM6wB,MAAM,CACfE,OAAQ,IAAIf,GAAAA,EAAGhwB,MAAMgxB,OAAO,CACxBhlB,MAAO,CAAC,GAAI,IAAK,KACjBnO,MAAO,QAIvB,GAACZ,GAAAR,EAAA,cACa,WACVA,EAAKmzB,UAAUE,OAAOmB,QACtBx0B,EAAKy0B,mBAAmBpvB,QAAQ,SAAAiH,GAC5BtM,EAAK8B,MAAMC,aAAac,MAAMiR,OAAOxH,EACzC,GACAtM,EAAKy0B,mBAAqB,GAC1Bz0B,EAAKmC,SAAS,CAACiH,OAAQ,MAC3B,GAAC5I,GAAAR,EAAA,UACS,WACFA,EAAK8yB,iBACL9yB,EAAK8yB,gBAAgBc,QAEzB5zB,EAAK8yB,gBAAkB,IAAIC,gBAC3B,IAAMxzB,EAAU,CACZm1B,OAAQ10B,EAAK8yB,gBAAgB4B,OAC7BC,aAAcC,GAAAA,GAAWC,aAEL,UAApB70B,EAAKwD,MAAMsP,KACX9S,EAAKgzB,YAAY8B,YAAYv1B,GAASmf,KAAK1e,EAAK+0B,cACrB,eAApB/0B,EAAKwD,MAAMsP,KAClB9S,EAAKgzB,YAAYgC,iBAAiBz1B,GAASmf,KAAK1e,EAAKi1B,aAC1B,YAApBj1B,EAAKwD,MAAMsP,KAClB9S,EAAKgzB,YAAYkC,cAAc31B,GAASmf,KAAK1e,EAAKm1B,aACvB,WAApBn1B,EAAKwD,MAAMsP,MAClB9S,EAAKgzB,YAAYoC,sBAAsB71B,GAASmf,KAAK1e,EAAKq1B,cAElE,GAAC70B,GAAAR,EAAA,eACc,SAACkC,GACZ,GAAc,OAAVA,EAAJ,CAIAlC,EAAK2zB,cACL,IAAMzrB,EAAMhG,EAAMiM,OAAO,GAGnBxE,EAAY3J,EAAKqJ,aAAa,CAACnB,EAAIjH,EAAGiH,EAAI7G,IAC1C6yB,EAAShsB,EAAI9F,EAAIuH,EAAY,GAAMzB,EAAI9F,EAAIuH,EAAY,EAEvD2rB,EAA0B,SAAC/1B,GAC7B,OAAsB,IAAlBA,EAAQg2B,MACDnF,GAAAA,EAAaC,kBAAkB1mB,GAAW,EAAOS,EAAAA,EAAYC,GAAG,8BAChE6pB,EAAS,GAA6B,WAAxBl0B,EAAKwD,MAAMqvB,SACzBzC,GAAAA,EAAaC,kBAAkBnoB,EAAI9F,EAAIuH,GAAW,EAAOS,EAAAA,EAAYC,GAAG,4BAExE+lB,GAAAA,EAAaC,kBAAkBnoB,EAAI9F,GAAG,EAAOgI,EAAAA,EAAYC,GAAG,6BAE3E,EACIoE,EAAQ,KACRylB,EAAS,GAETzlB,EAAQ,IAAIC,GAAAA,GAAM,CACdkjB,kBAAkB,EAClBC,UAAU,EACV7hB,cAAc,EACd8hB,qBAAsBwD,KAEpBxnB,UAAU,CAAC,IAAItJ,EAAAA,IAAQ0D,EAAIjH,EAAGiH,EAAI7G,EAAGsI,GAAYzB,KAGvDuG,EAAQ,IAAIC,GAAAA,GAAM,CACdkjB,kBAAkB,EAClBC,UAAU,EACV7hB,cAAc,EACd8hB,qBAAsBwD,KAEpBxnB,UAAU,CAAC,IAAItJ,EAAAA,IAAQ0D,EAAIjH,EAAGiH,EAAI7G,EAAG6G,EAAI9F,KAEnDpC,EAAK8B,MAAMC,aAAac,MAAMgG,IAAI4F,GAClCzO,EAAKy0B,mBAAmBr1B,KAAKqP,GAC7BzO,EAAK8B,MAAMC,aAAac,MAAMiR,OAAO5R,GAErClC,EAAKmC,SAAS,CAACiH,OAAQ,CAAClB,IAAK,CAACA,EAAIjH,EAAGiH,EAAI7G,EAAG6G,EAAI9F,GAAI8xB,OAAQA,KAG5Dl0B,EAAKw1B,SA5CL,MAFIx1B,EAAKw1B,SA+Cb,GAACh1B,GAAAR,EAAA,cACa,SAACy1B,GACX,GAAmB,OAAfA,EAAJ,CAIAz1B,EAAK2zB,cACL,IAAM+B,GAAY,IAAInC,GAAAA,EAAG5N,OAAO6N,SAAWmC,aAAaF,EAAWG,YAAa,CAC5EC,eAAgB,YAChBC,kBAAmB91B,EAAK8B,MAAMC,aAAa6B,SAE/C5D,EAAKmzB,UAAUE,OAAO0C,YAAYL,GAClC11B,EAAK8B,MAAMC,aAAac,MAAMiR,OAAO2hB,GAKrC,IAFA,IAAMO,EAAO,IAAIC,EAAAA,IACbC,EAAQ,EACH3V,EAAI,EAAGA,EAAIkV,EAAWtnB,OAAO/N,OAAS,EAAGmgB,IAAK,CACnD,IAAM4V,EAAKV,EAAWtnB,OAAOoS,GACvB6V,EAAKX,EAAWtnB,OAAOoS,EAAI,GAE3B8V,EAAO,IAAIC,EAAAA,IACb,IAAIlvB,EAAAA,IAAQ+uB,EAAGl1B,EAAGk1B,EAAG90B,GACrB,IAAI+F,EAAAA,IAAQgvB,EAAGn1B,EAAGm1B,EAAG/0B,IAEzB20B,EAAKntB,IAAIwtB,GACTH,GAASjzB,KAAKgM,MAAMmnB,EAAGn1B,EAAIk1B,EAAGl1B,IAAMm1B,EAAGn1B,EAAIk1B,EAAGl1B,IAAMm1B,EAAG/0B,EAAI80B,EAAG90B,IAAM+0B,EAAG/0B,EAAI80B,EAAG90B,GAClF,CACA,IAAMk1B,EAAWtzB,KAAKsN,IAAIvQ,EAAK8B,MAAM00B,eAAgBvzB,KAAKC,MAAMgzB,EAAQl2B,EAAK8B,MAAM20B,mBAE7EtoB,EAAS6nB,EAAKU,gBAAgBH,EAAW,GACzCI,EAAS,IAAIr2B,MAAMi2B,GACzBI,EAAO,GAAK,CAACxoB,EAAO,GAAGlN,EAAGkN,EAAO,GAAG9M,EAAGrB,EAAKqJ,aAAa,CAAC8E,EAAO,GAAGlN,EAAGkN,EAAO,GAAG9M,IAAK,GAEtF,IADA,IAAIu1B,EAAQ,EACHrW,EAAI,EAAGA,EAAIgW,IAAYhW,EAAG,CAC/BoW,EAAOpW,GAAK,CAACpS,EAAOoS,GAAGtf,EAAGkN,EAAOoS,GAAGlf,EAAGrB,EAAKqJ,aAAa,CAAC8E,EAAOoS,GAAGtf,EAAGkN,EAAOoS,GAAGlf,IAAK,GACtF,IAAMua,EAAK+a,EAAOpW,GAAG,GAAKoW,EAAOpW,EAAI,GAAG,GAClC1E,EAAK8a,EAAOpW,GAAG,GAAKoW,EAAOpW,EAAI,GAAG,GAClCsW,EAAKF,EAAOpW,GAAG,GAAKoW,EAAOpW,EAAI,GAAG,GACxCqW,GAAS3zB,KAAKgM,KAAK2M,EAAKA,EAAKC,EAAKA,EAAKgb,EAAKA,GAC5CF,EAAOpW,GAAG,GAAKqW,CACnB,CACA52B,EAAKmC,SAAS,CAACiH,OAAQ,CAAChJ,OAAQw2B,EAAOE,QAASH,KAGhD32B,EAAKw1B,SAxCL,MAFIx1B,EAAKw1B,SA2Cb,GAACh1B,GAAAR,EAAA,cACa,SAAC+2B,GACX,GAAgB,OAAZA,EAAJ,CAIA/2B,EAAK2zB,cAEL,IAAM+B,GAAY,IAAInC,GAAAA,EAAG5N,OAAO6N,SAAWmC,aAAaoB,EAAQnB,YAAa,CACzEC,eAAgB,YAChBC,kBAAmB91B,EAAK8B,MAAMC,aAAa6B,SAE/C5D,EAAKmzB,UAAUE,OAAO0C,YAAYL,GAClC11B,EAAK8B,MAAMC,aAAac,MAAMiR,OAAOijB,GAsBrC,IAlBA,IAAMC,EAAO,CACTD,EAAQ5oB,OAAO,GAAGlN,EAAG81B,EAAQ5oB,OAAO,GAAG9M,EACvC01B,EAAQ5oB,OAAO,GAAGlN,EAAG81B,EAAQ5oB,OAAO,GAAG9M,GAErC6H,EAAc6tB,EAAQ5oB,OAAO1K,IAAI,SAAAsd,GAKnC,OAJAiW,EAAK,GAAK/zB,KAAKsN,IAAIymB,EAAK,GAAIjW,EAAE9f,GAC9B+1B,EAAK,GAAK/zB,KAAKsN,IAAIymB,EAAK,GAAIjW,EAAE1f,GAC9B21B,EAAK,GAAK/zB,KAAKgG,IAAI+tB,EAAK,GAAIjW,EAAE9f,GAC9B+1B,EAAK,GAAK/zB,KAAKgG,IAAI+tB,EAAK,GAAIjW,EAAE1f,GACvB,CAAC0f,EAAE9f,EAAG8f,EAAE1f,EACnB,GACM41B,EAAWj3B,EAAK8B,MAAM20B,iBACtBS,EAAOj0B,KAAKsN,IAAIvQ,EAAK8B,MAAM00B,eAAgBvzB,KAAKC,OAAO8zB,EAAK,GAAKA,EAAK,IAAMC,IAC5EE,EAAOl0B,KAAKsN,IAAIvQ,EAAK8B,MAAM00B,eAAgBvzB,KAAKC,OAAO8zB,EAAK,GAAKA,EAAK,IAAMC,IAC5EG,GAAUJ,EAAK,GAAKA,EAAK,IAAME,EAC/BG,GAAUL,EAAK,GAAKA,EAAK,IAAMG,EACjCG,EAAO,EACLC,EAAiB,IAAIj3B,MAAM42B,EAAOC,GAC/BK,EAAK,EAAGA,EAAKN,EAAO,IAAKM,EAC9B,IAAK,IAAIC,EAAK,EAAGA,EAAKN,EAAO,IAAKM,EAAI,KAAAC,EAAAC,EAAAC,EAAAC,EAE5B51B,EAAI,CAAC+0B,EAAK,GAAKQ,EAAKJ,EAAQJ,EAAK,GAAKS,EAAKJ,GAC3C1nB,EAAI,CAAC1N,EAAE,GAAK,GAAMm1B,EAAQn1B,EAAE,GAAK,GAAMo1B,GAC7C,GAAKS,KAAenoB,EAAGzG,GAAvB,CAIA,IAAM6uB,EAAmC,QAAjCL,EAAGH,EAAeE,EAAKP,EAAOM,UAAG,IAAAE,EAAAA,EAAKH,EAAeE,EAAKP,EAAOM,GAAMx3B,EAAKqJ,aAAapH,GAC3F+1B,EAAuC,QAArCL,EAAGJ,EAAeE,EAAKP,EAAOM,EAAK,UAAE,IAAAG,EAAAA,EAAKJ,EAAeE,EAAKP,EAAOM,EAAK,GAAKx3B,EAAKqJ,aAAa,CAACpH,EAAE,GAAKm1B,EAAQn1B,EAAE,KACrHg2B,EAA6C,QAA3CL,EAAGL,GAAgBE,EAAK,GAAKP,EAAOM,EAAK,UAAE,IAAAI,EAAAA,EAAKL,GAAgBE,EAAK,GAAKP,EAAOM,EAAK,GAAKx3B,EAAKqJ,aAAa,CAACpH,EAAE,GAAKm1B,EAAQn1B,EAAE,GAAKo1B,IACtIa,EAAyC,QAAvCL,EAAGN,GAAgBE,EAAK,GAAKP,EAAOM,UAAG,IAAAK,EAAAA,EAAKN,GAAgBE,EAAK,GAAKP,EAAOM,GAAMx3B,EAAKqJ,aAAa,CAACpH,EAAE,GAAIA,EAAE,GAAKo1B,IAE/Gp0B,KAAKk1B,IAAIF,EAAKF,GACd90B,KAAKk1B,IAAID,EAAKF,GAItBV,GAFct3B,EAAKo4B,aAAa,EAAEhB,EAAQ,EAAGW,EAAKC,GAAK,CAAC,EAAGX,EAAQY,EAAKD,IAC1Dh4B,EAAKo4B,aAAa,CAAC,GAAIf,EAAQU,EAAKG,GAAK,CAACd,EAAQ,EAAGa,EAAKC,IAKxEZ,GAFct3B,EAAKo4B,aAAa,CAAChB,EAAQ,EAAGY,EAAKD,GAAK,CAAC,EAAGV,EAAQa,EAAKH,IACzD/3B,EAAKo4B,aAAa,EAAEhB,EAAQ,EAAGc,EAAKD,GAAK,CAAC,GAAIZ,EAAQU,EAAKE,GAf7E,CAkBJ,CAEJj4B,EAAKmC,SAAS,CAACiH,OAAQkuB,IAGvBt3B,EAAKw1B,SA5DL,MAFIx1B,EAAKw1B,SA+Db,GAACh1B,GAAAR,EAAA,gBACe,SAACy1B,GACM,OAAfA,GAIJz1B,EAAK2zB,cACL3zB,EAAKy0B,mBAAmBr1B,KAAKq2B,GAG7Bz1B,EAAKw1B,WAPDx1B,EAAKw1B,SAQb,GAACh1B,GAAAR,EAAA,eACc,SAACkC,GACZ,IAAMgH,EAAc,IAAIC,EAAAA,GAAYnJ,EAAK8B,MAAMC,aAAa6B,OAAQ1B,EAAM,GAAIA,EAAM,GAAI,GAClFkH,EAASpJ,EAAK8B,MAAMC,aAAa0B,IAAI4F,aAAa,CAACH,YAAAA,IACzD,OAAIE,EAAOE,QAAQlJ,OAAS,GACxBgJ,EAAOE,QAAQC,KAAK,SAACC,EAAGC,GAAC,OAAKD,EAAEE,WAAaD,EAAEC,UAAU,GAClDN,EAAOE,QAAQ,GAAGK,WAEtB,IACX,GAACnJ,GAAAR,EAAA,eACc,SAAC0gB,EAAGK,GACf,IAAMsX,EAAQ,CAAC3X,EAAE,GAAKK,EAAE,GAAKL,EAAE,GAAKK,EAAE,GAAIL,EAAE,GAAKK,EAAE,GAAKL,EAAE,GAAKK,EAAE,GAAIL,EAAE,GAAKK,EAAE,GAAKL,EAAE,GAAKK,EAAE,IAC5F,MAAO,GAAM9d,KAAKgM,KAAKopB,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GAAKA,EAAM,GACxF,GAtWIr4B,EAAKgzB,YAAc,KACnBhzB,EAAKy0B,mBAAqB,GAAGz0B,CACjC,CAAC,O,sRAAAwC,CAAAkwB,EAAA3yB,G,EAAA2yB,G,EAAA,EAAAjwB,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GACtBxK,KAAKY,MAAMsP,OAAS1F,EAAU0F,OAC9BlQ,KAAK+wB,cACL/wB,KAAK4yB,WAEL5yB,KAAKY,MAAMqvB,WAAazlB,EAAUylB,WAElCjwB,KAAK6xB,mBAAmB,GAAG6D,gBAC3B11B,KAAKd,MAAMC,aAAac,MAAMkD,eAEtC,GAAC,CAAAtD,IAAA,SAAAC,MA6FD,WAAS,IAAA61B,EAAA51B,EAAA,KACL,MAAO,CAECQ,EAAAA,cAAC2S,GAAAA,EAAO,CAACrT,IAAI,UAAUsT,OAAQnT,KAAKmT,OAAQC,OAAQpT,KAAKoT,OAAQrI,KAAK,aACjE,iBAAO,CACJF,KACItK,EAAAA,cAAA,WACKR,EAAK61B,qBACL71B,EAAK81B,gBAGjB,GAGQ,QAAjBF,EAAA31B,KAAKY,MAAM4F,cAAM,IAAAmvB,GAAjBA,EAAmBzB,QACf3zB,EAAAA,cAACu1B,GAAe,CAACtjB,KAAMxS,KAAKY,MAAM4F,OAAO0tB,QAASr0B,IAAI,gBAAgBV,aAAca,KAAKd,MAAMC,eAC/F,KAEZ,M,8EAAC,CA/IyB,CAASoB,EAAAA,WAAe3C,GAAjCkyB,GAAS,YACP,CACf8D,eAAgBxyB,IAAAA,OAChByyB,iBAAkBzyB,IAAAA,OAClBjC,aAAciC,IAAAA,SACjBxD,GALgBkyB,GAAS,eAMJ,CAClB8D,eAAgB,IAChBC,iBAAkB,I,2BC7BtB,GAAU,CAAC,E,+kDAEf,GAAQj3B,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCN1D,IAGqB84B,GAAa,SAAA54B,GAQ9B,SAAA44B,EAAY72B,GAAO,IAAA9B,EA0BZ,O,4FA1BYC,CAAA,KAAA04B,GACFn4B,GAAbR,EAAAS,GAAA,KAAAk4B,EAAA,CAAM72B,IAAO,QAJT,CACJ82B,WAAW,IACdp4B,GAAAR,EAAA,kBAgDiB,SAACqC,GACXA,IACArC,EAAKyD,IAAM,IAAI8vB,GAAAA,EAAGsF,IAAI,CAClBC,OAAQ,CAAC94B,EAAK+4B,eACdxyB,SAAU,GACVY,OAAQ9E,IAEZrC,EAAKg5B,YAEb,GAACx4B,GAAAR,EAAA,YACW,WACR,IAAMi5B,EAAe,IAAI1F,GAAAA,EAAG2F,KAAK,CAC7BC,gBAAgB,EAChBC,WAAYp5B,EAAK8B,MAAMC,aAAa6B,SAExC5D,EAAKyD,IAAI41B,QAAQJ,GACjBj5B,EAAKs5B,gBACT,GAAC94B,GAAAR,EAAA,iBAmBgB,WAAM,IAAAu5B,EAAAC,EAAAC,EACnB,GAAKz5B,EAAKyD,IAAV,CAGA,IAAMZ,EAAQ7C,EAAK8B,MAAMC,aAAac,MAChC5B,EAAI4B,EAAMyD,KAAKe,OAAOM,SAAS1G,EAC/BI,EAAIwB,EAAMyD,KAAKe,OAAOM,SAAStG,EAC/BsY,EAAoD,QAA7C4f,EAAsB,QAAtBC,EAAG32B,EAAMyD,KAAKC,gBAAQ,IAAAizB,GAAmB,QAAnBC,EAAnBD,EAAqBxtB,yBAAiB,IAAAytB,OAAA,EAAtCA,EAAA1yB,KAAAyyB,UAA0C,IAAAD,EAAAA,EAAI,EAExD7vB,EADe7G,EAAMyD,KAAKe,OAAOM,SAASvF,EACd,IAElCpC,EAAKyD,IAAIi2B,UAAUC,UAAU,CAAC14B,EAAGI,IACjCrB,EAAKyD,IAAIi2B,UAAUE,cAAclwB,GACjC1J,EAAK65B,gBAAgBC,cAAcC,eAAe,CAAC94B,EAAGI,IACtDrB,EAAK65B,gBAAgBhwB,IAAI,YAAa8P,GAAS,GAC/C3Z,EAAK+4B,cAAciB,YAAYC,SAZ/B,CAaJ,GAjGIj6B,EAAKyD,IAAM,KACXzD,EAAK65B,gBAAkB,IAAItG,GAAAA,EAAG2G,QAAQ,IAAI3G,GAAAA,EAAG4G,KAAKC,MAAM,CAAC,EAAG,KAC5Dp6B,EAAK+4B,cAAgB,IAAIxF,GAAAA,EAAG8G,MAAMC,OAAO,CACrCjH,OAAQ,IAAIE,GAAAA,EAAGF,OAAOiH,OAAO,CACzB5E,SAAU,CAAC11B,EAAK65B,mBAEpBt2B,MAAO,SAACg3B,GAAO,OAAK,IAAIhH,GAAAA,EAAGhwB,MAAM6wB,MAAM,CACnC1F,KAAM,IAAI6E,GAAAA,EAAGhwB,MAAM8wB,KAAK,CACpB9kB,MAAO,UAEX+kB,OAAQ,IAAIf,GAAAA,EAAGhwB,MAAMgxB,OAAO,CACxBhlB,MAAO,MACPnO,MAAO,IAEXo5B,MAAO,IAAIjH,GAAAA,EAAGhwB,MAAMqH,KAAK,CACrB6vB,OAAQ,CAAC,GAAK,GACdC,aAAc,WACdC,aAAc,WACd5S,I,isKACAne,SAAU2wB,EAAQK,IAAI,YACtB5xB,MAAO,KAEb,EACF6xB,OAAQ,MACT76B,CACP,CAAC,O,sRAAAwC,CAAAm2B,EAAA54B,G,EAAA44B,G,EAAA,EAAAl2B,IAAA,oBAAAC,MACD,WACIE,KAAKd,MAAMC,aAAac,MAAMyD,KAAKC,SAASxD,iBAAiB,SAAUH,KAAK02B,eAChF,GAAC,CAAA72B,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GACtBxK,KAAKd,MAAMC,aAAa6B,SAAWuJ,EAAUpL,aAAa6B,QAC1DhB,KAAKo2B,YAELp2B,KAAKa,MACDb,KAAKY,MAAM4Z,SAAWhQ,EAAUgQ,QAAUxa,KAAKY,MAAMmW,UAAYvM,EAAUuM,UAC3E/W,KAAKa,IAAIi2B,UAAUC,UAAU/2B,KAAKY,MAAM4Z,QACxCxa,KAAKi3B,gBAAgBC,cAAcC,eAAen3B,KAAKY,MAAM4Z,QAC7Dxa,KAAKi3B,gBAAgBhwB,IAAI,YAAajH,KAAKY,MAAMmW,SAAS,GAC1D/W,KAAKm2B,cAAciB,YAAYC,WAE/Br3B,KAAKY,MAAMkG,aAAe0D,EAAU1D,YACpC9G,KAAKa,IAAIi2B,UAAUE,cAAch3B,KAAKY,MAAMkG,YAGxD,GAAC,CAAAjH,IAAA,SAAAC,MAmBD,WAAS,IAAAC,EAAA,KACCY,EAAQ,CACVusB,QAASltB,KAAKY,MAAMo1B,UAAY,OAAS,WAE7C,MAAO,CAECz1B,EAAAA,cAAA,OAAKC,UAAU,kBAAkBX,IAAI,sBACjCU,EAAAA,cAAA,OAAKC,UAAU,wBAAwBC,IAAKT,KAAKk4B,gBAAiBv3B,MAAOA,IACzEJ,EAAAA,cAAA,UAAQuH,QAAS,WAAF,OAAQ/H,EAAKR,SAAS,SAAAqB,GAAK,MAAK,CAACo1B,WAAYp1B,EAAMo1B,UAAU,EAAE,EAAEhiB,KAAK,UAChFhU,KAAKY,MAAMo1B,UAAY,IAAM,MAI1Ch2B,KAAKa,KAAOb,KAAKd,MAAMi5B,UACnB53B,EAAAA,cAAC63B,GAAAA,GAAO,CAACv4B,IAAKG,KAAKd,MAAMi5B,UAAUhmB,KAAMtR,IAAKb,KAAKa,IAAKlE,QAASqD,KAAKd,MAAMi5B,UAAW3B,WAAYx2B,KAAKd,MAAMC,aAAa6B,SAC3H,KAEZ,M,8EAAC,CA1F6B,CAAST,EAAAA,WAAe3C,GAArCm4B,GAAa,YACX,CACfoC,UAAW/2B,IAAAA,OACXjC,aAAciC,IAAAA,S,2ECblB,GAAU,CAAC,E,+kDAEf,GAAQxE,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCAvB,IAGdo7B,GAAa,SAAAl7B,GAAA,SAAAk7B,IAAA,IAAAj7B,G,4FAAAC,CAAA,KAAAg7B,GAAA,QAAA/6B,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAiH7B,OAjH6BC,GAAAR,EAAAS,GAAA,KAAAw6B,EAAA,GAAAv6B,OAAAL,IAAA,uBAkBP,SAAC+I,GAAW,IAAA8xB,EAAAC,EACzBp5B,EAAe/B,EAAK8B,MAAMC,aAGhC,GAFAA,EAAa8xB,YAAY,qBACzB9xB,EAAaiF,kBAAkB,kBAC1BoC,EAAL,CAGA,IAAMxF,EAAS7B,EAAa6B,OACtBw3B,EAAWv3B,EAAAA,EAAiB0V,UAAU,CAACnQ,EAAOnI,EAAGmI,EAAO/H,GAAc,QAAZ65B,EAAE9xB,EAAOiyB,WAAG,IAAAH,EAAAA,EAAIt3B,EAAQA,GAGxF,GAAIwF,EAAOmxB,SAA8C,WAArB,QAAdY,EAAA/xB,EAAOmxB,eAAO,IAAAY,GAAU,QAAVA,EAAdA,EAAgB/sB,gBAAQ,IAAA+sB,OAAA,EAAxBA,EAA0BvkB,MAAkB,KAAA0kB,EACxD3V,EAAS,IAAI4N,GAAAA,EAAG5N,OAAO6N,QACvB+H,EAAa5V,EAAOgQ,aAAavsB,EAAOmxB,QAAS,CACnD1E,eAA0B,QAAZyF,EAAElyB,EAAOiyB,WAAG,IAAAC,EAAAA,EAAI13B,EAAQkyB,kBAAmBlyB,IAEvD43B,EAAiB,IAAIpI,GAAAA,EAAW,CAClCC,OAAQ,IAAIC,GAAAA,EAAa,CACrBle,KAAMmmB,EACN5V,OAAQA,EACRpiB,MAAO,SAACk4B,GAAI,OAAKC,GAAAA,GAAAA,QAAsBD,EAAM,CAAC,EAAE,MAGxD15B,EAAa2xB,SAAS,oBAAqB8H,EAC/C,CAGA,IAAIlgB,EAASlS,EAAOmxB,QAAUoB,GAAAA,EAAiBC,mBAAmBxyB,EAAOmxB,SAAW,CAChFa,EAAS,GAAIA,EAAS,GACtBA,EAAS,GAAIA,EAAS,IAGpBS,EAAUvgB,EAAO,GAAKA,EAAO,GAC7BwgB,EAAWxgB,EAAO,GAAKA,EAAO,GAC9BygB,EAAY/7B,EAAK8B,MAAMC,aAAac,MAAMC,SAAS9B,wBAEnDg7B,EAAO,MAAS,GAChBC,EAAWF,EAAU36B,MAAQ46B,EAAOh8B,EAAK8B,MAAMvC,QAAQ28B,oBACvDC,EAAYJ,EAAUv6B,OAASw6B,EAAOh8B,EAAK8B,MAAMvC,QAAQ28B,oBAE/D,GADoBj5B,KAAKgG,IAAI4yB,EAAUI,EAAUH,EAAWK,GAC1C,EAAG,CACjB,IAAMC,EAAY,IAAO9gB,EAAO,GAAKA,EAAO,IACtC+gB,EAAY,IAAO/gB,EAAO,GAAKA,EAAO,IAC5CA,EAAS,CACL8gB,EAAYH,EAAW,EAAGI,EAAYF,EAAY,EAClDC,EAAYH,EAAW,EAAGI,EAAYF,EAAY,EAE1D,CAEAp6B,EAAa4Z,gBAAgBL,EAAQ,GAErCvZ,EAAa0c,iBAAiB2c,GAAU1c,KAAK,SAACP,IAE3B,IAAIjS,EAAAA,GACZC,K,6+iCAAe,SAACC,GAAS,IAAAkwB,EACtBC,EAAe,IAAIzvB,EAAAA,IAGnB0vB,EAAMpwB,EAAKvJ,MACjB25B,EAAI70B,SAAS1G,EAAIm6B,EAAS,GAC1BoB,EAAI70B,SAAStG,EAAI+5B,EAAS,GAC1BoB,EAAI70B,SAASvF,EAAI+b,EACjBqe,EAAI5yB,SAAS3I,EAAIgC,KAAKyB,GAAK,EAC3B83B,EAAI1yB,oBACJyyB,EAAa1zB,IAAI2zB,GAGjB,IAAMC,EAAU9qB,SAASC,cAAc,QACvC6qB,EAAQC,UAAwB,QAAfJ,EAAGlzB,EAAOrF,aAAK,IAAAu4B,EAAAA,EAAIlzB,EAAOunB,KAC3C8L,EAAQr5B,UAAY,yBACpB,IAAMW,EAAQ,IAAI44B,GAAAA,EAAYF,GAC9B14B,EAAM4D,SAASkC,IAAIuxB,EAAS,GAAIA,EAAS,GAAIjd,EAAgB,GAC7Dpa,EAAM+F,oBACNyyB,EAAa1zB,IAAI9E,GAEjBhC,EAAaqE,eAAe,iBAAkBm2B,GAG9C,IAAMK,EAAoB,WACtB,IAAM9zB,EAAW/G,EAAac,MAAMyD,KAAKe,OAAOM,SAASoB,WAAWyzB,EAAI70B,UAAY,GAC9EqB,EAAQ/F,KAAKgG,IAAI,EAAGH,GAC1B/E,EAAM4D,SAASvF,EAAI+b,EAAgB,EAAInV,EACvCjF,EAAM+F,oBACN0yB,EAAIxzB,MAAMa,IAAIb,EAAOA,EAAOA,GAC5BwzB,EAAI1yB,mBACR,EAEA/H,EAAac,MAAMyD,KAAKC,SAASxD,iBAAiB,SAAU65B,GAC5DL,EAAax5B,iBAAiB,UAAW,WACrChB,EAAac,MAAMyD,KAAKC,SAASO,oBAAoB,SAAU81B,GAE/DH,EAAQI,WAAW9qB,YAAY0qB,EACnC,EACJ,EACJ,EAxFA,CAyFJ,GAACz8B,CAAA,Q,sRAAAwC,CAAAy4B,EAAAl7B,G,EAAAk7B,G,EAAA,EAAAx4B,IAAA,SAAAC,MA1GD,WACI,OACIS,EAAAA,cAAC25B,GAAAA,EAAY,CACTC,iBAAe,EACfC,eAAgBp6B,KAAKq6B,qBACrBC,aAAc,CAACC,OAAQv6B,KAAKd,MAAMC,aAAa6B,OAAQw5B,WAAYx6B,KAAKd,MAAMC,aAAa6B,QAC3Fy5B,gBAAiBl4B,OAAOm4B,OAAO16B,KAAKd,MAAMu7B,iBAC1C36B,MAAO,IAGnB,M,8EAAC,CAjB6B,CAASS,EAAAA,WAAe3C,GAArCy6B,GAAa,YACX,CACf17B,QAASyE,IAAAA,OACTjC,aAAciC,IAAAA,OACdq5B,gBAAiBr5B,IAAAA,S,gBCpBrB,GAAU,CAAC,E,+kDAEf,GAAQxE,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCN5B,IAGxB09B,GAAQ,SAAAx9B,GAAA,SAAAw9B,IAAA,IAAAv9B,G,4FAAAC,CAAA,KAAAs9B,GAAA,QAAAr9B,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAqCT,OArCSC,GAAAR,EAAAS,GAAA,KAAA88B,EAAA,GAAA78B,OAAAL,IAAA,QAOF,CACR,GAACG,GAAAR,EAAA,qBAkBoB,WACjB,OACImD,EAAAA,cAAA,QAAMC,UAAU,4BACZD,EAAAA,cAACyH,EAAAA,EAAI,CAACC,KAAK,mBAGvB,GAACrK,GAAAR,EAAA,cACa,SAACqC,GACPA,GACArC,EAAK8B,MAAM07B,gBAAgBn7B,EAAGE,aAEtC,GAACvC,CAAA,Q,sRAAAwC,CAAA+6B,EAAAx9B,G,EAAAw9B,G,EAAA,EAAA96B,IAAA,SAAAC,MA5BD,WASI,OACIS,EAAAA,cAAA,OAAKC,UAAU,eAAeC,IAAKT,KAAKU,aACpCH,EAAAA,cAAC83B,GAAa,CAAC17B,QAASqD,KAAKd,MAAMvC,QAASwC,aAAca,KAAKd,MAAMC,aAAcs7B,gBAAiBz6B,KAAKd,MAAMu7B,kBAC/Gl6B,EAAAA,cAAA,QAAMC,UAAU,wBAChBD,EAAAA,cAACs6B,GAAAA,EAAO,CAACC,mBAAiB,EAACC,eAAgB/6B,KAAKg7B,qBAAsBC,UAZ5D,CACd,CAACp7B,IAAK,cAAeoI,KAAM,UAC3B,CAACpI,IAAK,SAAUoI,KAAM,QACtB,CAACpI,IAAK,YAAaoI,KAAM,WACzB,CAACpI,IAAK,YAAaoI,KAAM,WACzB,CAACpI,IAAK,aAAcoI,KAAM,SAC1B,CAACpI,IAAK,cAAeoI,KAAM,mBASnC,M,8EAAC,CAzBS,CAAS1H,EAAAA,WAAe3C,GAAhC+8B,GAAQ,YACS,CACfh+B,QAASyE,IAAAA,OACTjC,aAAciC,IAAAA,OACdq5B,gBAAiBr5B,IAAAA,OACjBw5B,gBAAiBx5B,IAAAA,OAmCzB,UAAeC,EAAAA,EAAAA,IAAQ,iBAAO,CAAC,CAAC,EAAG,CAC/Bu5B,gBAAiBA,EAAAA,iBADrB,CAEGD,I,gBC/CH,UACIO,SAAU,SAACv+B,EAAS65B,GAChB,OAAO,IAAIhG,GAAAA,EAAW,CAClBre,KAAMxV,EAAQwV,KACdse,OAAQ,IAAIC,GAAAA,EAAa,CACrBle,MAAM2oB,EAAAA,GAAAA,IAAex+B,EAAS65B,GAC9BzT,OAAQ,IAAI4N,GAAAA,EAAG5N,OAAO6N,QACtBjwB,MAAOhE,EAAQy+B,eAAkB,SAAAzD,GAC7B,IAAM0D,EAAY1+B,EAAQ0+B,WAAa,UACjCC,EAAe3+B,EAAQ2+B,cAAgB,CAAC,EAC9C,OAAOxC,GAAAA,GAAcuC,GAAW1D,EAAS2D,EAC7C,KAGZ,EACAC,SAAU,SAAC9D,EAAO+D,EAAYC,EAAYjF,GAClCgF,EAAWH,YAAcI,EAAWJ,WAAaG,EAAWF,eAAiBG,EAAWH,aACxF7D,EAAMhH,OAAOiL,UAAS7K,EAAAA,GAAAA,IAAqB2K,IACpCA,EAAWJ,gBAAkBK,EAAWL,eAC/C3D,EAAMhH,OAAOiL,SAASF,EAAWJ,eAEjCI,EAAW1I,WAAa2I,EAAW3I,UACnC6I,EAAAA,GAAAA,IAAelE,EAAMhH,OAAQ+K,EAAYC,EAAYjF,IAC7CiF,EAAWG,KAAO,MAAQJ,EAAWI,KAAO,IACpDnE,EAAMhH,OAAOniB,QAErB,G,otCC3BJ,UACI4sB,SAAU,SAACv+B,EAAS65B,GAChB,IAAMqF,EAAez0B,GAAAA,GAAA,IAAO00B,EAAAA,GAAAA,IAAuBn/B,IAAQ,IAAEo/B,KAAM,IAAIvnB,OACvE,OAAO,IAAIgc,GAAAA,EAAW,CAClBre,KAAMxV,EAAQwV,KACdse,OAAQ,IAAIuL,GAAAA,EAAiB,CACzBvL,OAAQ,IAAIE,GAAAA,EAAGF,OAAOwL,QAAQ,CAC1BC,IAAKv/B,EAAQu/B,IAAInmB,MAAM,KAAK,GAC5BomB,OAAQN,EACRhY,QAASlnB,EAAQknB,QACjB2S,WAAYA,EACZ4F,iBAAkB,SAACC,EAAWlX,GAAG,OAAKmX,EAAAA,GAAAA,IAAqBD,EAAUE,WAAYpX,EAAI,OAIrG,EACAoW,SAAU,SAAC9D,EAAO+D,EAAYC,EAAYjF,GAAe,IAAAgG,EACrD,GAAIf,SAAchE,GAAa,QAAR+E,EAAL/E,EAAOhH,cAAM,IAAA+L,GAAQ,QAARA,EAAbA,EAAe/L,cAAM,IAAA+L,GAArBA,EAAuBC,aAAc,CACnD,IAAIpF,GAAWoE,EAAWG,KAAO,MAAQJ,EAAWI,KAAO,GACrDc,GAAYZ,EAAAA,GAAAA,IAAuBL,GACnCkB,GAAYb,EAAAA,GAAAA,IAAuBN,GAYzC,GAXAj5B,OAAOc,KAAKq5B,GAAWj6B,QAAQ,SAAA5C,GACrBA,KAAO88B,IACTA,EAAU98B,QAAO8R,EAEzB,GACK0lB,IACDA,OAEO1lB,IAFGpP,OAAOc,KAAKs5B,GAAWjrB,KAAK,SAAA7R,GAClC,OAAO88B,EAAU98B,KAAS68B,EAAU78B,EACxC,IAEJw3B,GAAWmE,EAAWtnB,aAAeunB,EAAWvnB,WACnC,CACT,IAAM2nB,EAAez0B,GAAAA,GAAA,GAAOu1B,GAAS,IAAGZ,KAAM,IAAIvnB,OAC9CijB,EAAMmF,iBACN/9B,aAAa44B,EAAMmF,iBAElBpB,EAAWtnB,YAAe2nB,EAAgBgB,SAC3CpF,EAAM9jB,SAAU,GAEpB8jB,EAAMmF,gBAAkB79B,WAAW,WAC/B04B,EAAM9jB,QAAUkoB,EAAgBgB,QAAUrB,EAAWtnB,WACrDujB,EAAMhH,OAAOA,OAAOgM,aAAaZ,GACjCpE,EAAMhH,OAAOniB,SACbmpB,EAAMmF,gBAAkB,IAC5B,EAAG,IACP,CACJ,CACJ,G,wsCChDJ,UACI1B,SAAU,SAACv+B,EAAS65B,GAChB,OAAO,IAAIhG,GAAAA,EAAW,CAClBre,KAAMxV,EAAQwV,KACdse,OAAQ,IAAIuL,GAAAA,EAAiB,CACzBvL,QAAQqM,EAAAA,GAAAA,GAAgB11B,GAAAA,GAAC,CAAC,EAAGzK,GAAO,IAAE65B,WAAAA,QAGlD,EACA+E,SAAU,SAAC9D,EAAO+D,EAAYC,EAAYjF,GACtC,GCZR,IACIuG,OAAQC,GACRC,IAAKC,GACLC,KAAMC,I,gBCLN,GAAU,CAAC,E,41GAEf,GAAQxgC,kBAAoB,IAC5B,GAAQC,cAAgB,IACxB,GAAQC,OAAS,SAAc,KAAM,QACrC,GAAQC,OAAS,IACjB,GAAQC,mBAAqB,IAEhB,IAAI,KAAS,IAKJ,MAAW,KAAQC,QAAS,KAAQA,OCiB/B,IAErBogC,GAAa,SAAAlgC,GAAA,SAAAkgC,IAAA,IAAAjgC,EAAAC,GAAA,KAAAggC,GAAA,QAAA//B,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAAF,EAAAE,GAAAJ,UAAAI,GAUd,OAVcC,GAAAR,EAAAS,GAAA,KAAAw/B,EAAA,GAAAv/B,OAAAL,IAAA,WAMJ,SAACgC,GACHA,GACDrC,EAAK8B,MAAMo+B,SAASlgC,EAAK8B,MAAMq+B,QAEvC,GAACngC,CAAA,QAAAwC,GAAAy9B,EAAAlgC,GAAAytB,GAAAyS,EAAA,EAAAx9B,IAAA,SAAAC,MACD,WACI,OACIS,EAAAA,cAAA,WACKP,KAAKd,MAAM+S,SACZ1R,EAAAA,cAAA,QAAME,IAAKT,KAAKs9B,WAG5B,IAAC,CAlBc,CAAS/8B,EAAAA,WAAe3C,GAArCy/B,GAAa,YACI,CACfprB,SAAU7Q,IAAAA,UAAoB,CAACA,IAAAA,KAAgBA,IAAAA,OAC/Ck8B,SAAUl8B,IAAAA,KACVm8B,QAASn8B,IAAAA,SACZ,IAgBCo8B,GAAK,SAAAC,GAuDP,SAAAD,EAAYt+B,GAAO,IAAAa,EAiB0D,OAjB1D1C,GAAA,KAAAmgC,GACF5/B,GAAbmC,EAAAlC,GAAA,KAAA2/B,EAAA,CAAMt+B,IAAO,QArBT,CACJC,aAAYiI,GAAAA,GAAA,GACLo2B,EAAME,mBAAiB,IAE1B5M,SAAU,SAAC2G,GAAW,EACtBkG,SAAU,SAACC,GAAa,EACxB3M,YAAa,SAAC2M,GAAa,EAC3BzpB,iBAAkB,SAACypB,EAASjhC,GAAa,EAEzC6G,eAAgB,SAACX,EAAU6G,GAA0B,EACrDxG,eAAgB,SAACL,GAAc,EAC/BuB,kBAAmB,SAACvB,GAAc,EAClC+Q,kBAAmB,SAAC/Q,EAAUlG,GAAa,EAE3Coc,gBAAiB,SAACL,EAAQ6B,GAAW,EACrCsB,iBAAkB,SAAC2c,GAAc,EACjCp5B,qBAAsB,SAACf,EAAGI,GAAO,IAErC8+B,QAAS,OACZ3/B,GAAAmC,EAAA,iBA+CgB,WACb,IAAMo4B,EAAYp4B,EAAKa,MAAMzB,aAAa0+B,WAAWnsB,KAAK,SAAAyL,GAAC,OAAqB,IAAjBA,EAAEjJ,UAAmB,GAEpF,GADAnU,EAAKkxB,YAAY,eACZkH,EAAL,CAGA,IAAM2F,EAAeC,GAAc5F,EAAUnkB,MAC7C,GAAI8pB,SAAAA,EAAc5C,SAAU,CACxB,IAAM8C,EAAUF,EAAa5C,SAAS/C,EAAWp4B,EAAKb,MAAMs3B,YAC5Dz2B,EAAK+wB,SAAS,cAAekN,GAC7Bj+B,EAAKc,IAAIo9B,iBAAiBD,EAAS,KACvC,CANA,CAOJ,GAACpgC,GAAAmC,EAAA,eACc,SAAC03B,EAAOvjB,GACnBnU,EAAKR,SAAS,SAAAqB,GAAK,MAAK,CACpBzB,aAAYiI,GAAAA,GAAA,GACLxG,EAAMzB,cAAY,IACrB0+B,WAAYj9B,EAAMzB,aAAa0+B,WAAWh9B,IAAI,SAAA2S,GAAK,OAAApM,GAAAA,GAAA,GAC3CoM,GAAK,IAAEU,WAAYV,EAAMrB,OAASslB,EAAMtlB,MAAO+B,GAAkB,KAGhF,EACL,GAACtW,GAAAmC,EAAA,qBACoB,SAACm+B,GAClB,IAAMC,EAAgBD,EAAgB31B,OAAO,SAACC,EAAKivB,GAAK,OAAArwB,GAAAA,GAAA,GAChDoB,GAAG,GAAA5K,GAAA,GAAG65B,EAAM/6B,GAAK+6B,GAAK,EAC3B,CAAC,GAEJ,OAAO13B,EAAKb,MAAMg3B,OAAOr1B,IAAI,SAAA42B,GAAS,IAAA2G,EAAAC,EAClC,GAAI5G,EAAM5vB,OAASy2B,EAAAA,UAAUC,OAAS9G,EAAM5vB,OAASy2B,EAAAA,UAAUE,UAC3D,OAAO,KAEX,IAAMV,EAAeC,GAActG,EAAMzjB,MACzC,IAAK8pB,IAAiBA,EAAa5C,SAC/B,OAAO,KAEX,IAAMuD,EAAYN,EAAc1G,EAAM/6B,IACtC,OAAA0K,GAAAA,GAAA,GACOqwB,GAAK,IACRvjB,WAAiC,QAAvBkqB,EAAEK,aAAS,EAATA,EAAWvqB,kBAAU,IAAAkqB,GAAAA,EACjCvqB,QAA2B,QAApBwqB,EAAEI,aAAS,EAATA,EAAW5qB,eAAO,IAAAwqB,EAAAA,EAAI,KAEvC,GAAGz2B,OAAOiZ,QACd,GAACjjB,GAAAmC,EAAA,yBACwB,SAACm2B,EAAQwI,GAC9B,IAAMC,EAAYzI,EAAO3tB,OAAO,SAACC,EAAKivB,GAAK,OAAArwB,GAAAA,GAAA,GAAUoB,GAAG,GAAA5K,GAAA,GAAG65B,EAAM/6B,GAAK+6B,GAAK,EAAI,CAAC,GAC1E0G,EAAgBO,EAAWn2B,OAAO,SAACC,EAAKivB,GAAK,OAAArwB,GAAAA,GAAA,GAAUoB,GAAG,GAAA5K,GAAA,GAAG65B,EAAM/6B,GAAK+6B,GAAK,EAAI,CAAC,GAGpFgH,EAAY1+B,EAAK49B,SAAS,eAC9B7wB,GAAIopB,GAAQ0I,UAAUn8B,QAAQ,SAAAg1B,GAC1B,IAAMqG,EAAeC,GAActG,EAAMzjB,MACrC6qB,EAAW9+B,EAAK49B,SAASlG,EAAM/6B,IAC/BmiC,EACAf,EAAavC,SAASsD,EAASpO,OAAQgH,EAAO0G,EAAc1G,EAAM/6B,IAAKqD,EAAKb,MAAMs3B,aAElFqI,EAAWf,EAAa5C,SAASzD,EAAO13B,EAAKb,MAAMs3B,YACnDz2B,EAAK+wB,SAAS2G,EAAM/6B,GAAImiC,IAE5B9+B,EAAKc,IAAIo9B,iBAAiBY,EAAUJ,GACpCI,EAASlrB,QAAU8jB,EAAMvjB,WACzB2qB,EAAShrB,QAAU4jB,EAAM5jB,QAAU,IACnC4qB,EAAYI,CAChB,GAEAt8B,OAAOc,KAAKq7B,GAAYj8B,QAAQ,SAAAg1B,GACtBA,EAAM/6B,MAAMiiC,GACd5+B,EAAKkxB,YAAYwG,EAAM/6B,GAE/B,GACAqD,EAAKuwB,SAASntB,aAAapD,EAAKc,IACpC,GAACjD,GAAAmC,EAAA,0BACyB,SAAC2H,GACvBnF,OAAOC,QAAQkF,GAAcjF,QAAQ,SAAAC,GAAyB,I,IAAAC,G,EAAA,E,4CAAAD,I,0kBAAvBG,EAAQF,EAAA,GAAEhG,EAAOgG,EAAA,GAC9C+G,EAAS3J,EAAK++B,UAAUj8B,GAC9B6G,EAAOiK,QAAUhX,EAAQgX,QACzBjK,EAAOmK,QAAUlX,EAAQkX,QACzB9T,EAAKuwB,SAASntB,aAAauG,EAC/B,EACJ,GAAC9L,GAAAmC,EAAA,WACU,SAAC69B,EAASnG,GACjBA,EAAMsH,SAASnB,QAAUA,EACzB79B,EAAKc,IAAIiwB,SAAS2G,EACtB,GAAC75B,GAAAmC,EAAA,WACU,SAAC69B,GAAY,IAAAoB,EACpB,OAAiE,QAAjEA,EAAOj/B,EAAKc,IAAIo+B,UAAU,SAAA5gB,GAAC,OAAIA,EAAE0gB,SAASnB,UAAYA,CAAO,GAAE,UAAE,IAAAoB,EAAAA,EAAI,IACzE,GAACphC,GAAAmC,EAAA,cACa,SAAC69B,GACX79B,EAAKc,IAAIo+B,UAAU,SAAA5gB,GAAC,OAAIA,EAAE0gB,SAASnB,UAAYA,CAAO,GAAEn7B,QAAQ,SAAAg1B,GAC5D13B,EAAKc,IAAIowB,YAAYwG,EAAO,CAACntB,SAAS,GAC1C,EACJ,GAAC1M,GAAAmC,EAAA,mBACkB,SAAC69B,EAASsB,GACzBn/B,EAAKR,SAAS,SAAAqB,GAAK,MAAK,CACpBzB,aAAYiI,GAAAA,GAAA,GACLxG,EAAMzB,cAAY,IACrB8U,YAAarT,EAAMzB,aAAa8U,YAAYpT,IAAI,SAAA2S,GAC5C,OAAOA,EAAM9W,KAAOkhC,EAAOx2B,GAAAA,GAAA,GAAOoM,GAAU0rB,GAAQ1rB,CACxD,KAEP,EACL,GAAC5V,GAAAmC,EAAA,iBACgB,SAAC8C,EAAU6G,GAAyB,IAAjB/M,EAAOY,UAAAC,OAAA,QAAAmU,IAAApU,UAAA,GAAAA,UAAA,GAAG,CAAC,EAC3CwC,EAAKo/B,iBAAiBl5B,IAAIyD,GAC1B3J,EAAK++B,UAAUj8B,GAAY6G,EAC3B3J,EAAKR,SAAS,SAACqB,GACX,IAAMw+B,EAAWh4B,GAAA,CACbuM,SAAS,EACTE,QAAS,IACTvM,WAAW,GACR3K,GAEP,MAAO,CACHwC,aAAYiI,GAAAA,GAAA,GACLxG,EAAMzB,cAAY,IACrBuI,aAAYN,GAAAA,GAAA,GAAMxG,EAAMzB,aAAauI,cAAY,GAAA9J,GAAA,GAAGiF,EAAWu8B,MAG3E,EACJ,GAACxhC,GAAAmC,EAAA,iBACgB,SAAC8C,GACd,OAAO9C,EAAK++B,UAAUj8B,EAC1B,GAACjF,GAAAmC,EAAA,oBACmB,SAAC8C,GACZ9C,EAAK++B,UAAUj8B,IAGpB9C,EAAKR,SAAS,SAACqB,GACXb,EAAKuwB,SAASpf,OAAOnR,EAAK++B,UAAUj8B,WAC7B9C,EAAK++B,UAAUj8B,GACtB,IAAMw8B,EAAej4B,GAAA,GAAOxG,EAAMzB,aAAauI,cAE/C,cADO23B,EAAgBx8B,GAChB,CACH1D,aAAYiI,GAAAA,GAAA,GACLxG,EAAMzB,cAAY,IACrBuI,aAAc23B,IAG1B,EACJ,GAACzhC,GAAAmC,EAAA,oBACmB,SAAC8C,EAAUlG,GAC3BoD,EAAKR,SAAS,SAACqB,GACX,MAAO,CACHzB,aAAYiI,GAAAA,GAAA,GACLxG,EAAMzB,cAAY,IACrBuI,aAAYN,GAAAA,GAAA,GACLxG,EAAMzB,aAAauI,cAAY,GAAA9J,GAAA,GACjCiF,EAAQuE,GAAAA,GAAA,GACFxG,EAAMzB,aAAauI,aAAa7E,IAChClG,OAKvB,EACJ,GAACiB,GAAAmC,EAAA,iBA8BgB,SAACN,GACVA,IACAM,EAAKiqB,UAAYvqB,EACjBM,EAAKu/B,gBAEb,GAAC1hC,GAAAmC,EAAA,gBACe,WAAM,IAAAw/B,EAAAC,EAAAC,EAAAC,EAAAC,EACd5/B,EAAKuwB,UACLvwB,EAAK6/B,kBAET,IAAMpJ,EAAaz2B,EAAKb,MAAMs3B,WAC9Bz2B,EAAKb,MAAM2gC,UAAUrJ,GAGrBz2B,EAAKuwB,SAAW,IAAIwP,EAAAA,EAAS,CACzBv7B,OAAQxE,EAAKiqB,UACbyO,IAAKjC,EACL3yB,SAAU,CACNk8B,WAAY,EACZC,uBAAuB,KAG/BjgC,EAAKo/B,iBAAmB,IAAIj1B,EAAAA,IAC5BnK,EAAKuwB,SAASrqB,IAAIlG,EAAKo/B,kBAGvB,IAAMzmB,EAASzX,EAAAA,EAAiBg/B,cAAclgC,EAAKb,MAAMuiB,MAAM2S,KAAK1b,OAAQ3Y,EAAKb,MAAMuiB,MAAM2S,KAAKqE,IAAKjC,GACjG/d,EAAS,IAAIynB,EAAAA,EAAO1J,EAAY9d,EAAO,GAAIA,EAAO,GAAIA,EAAO,GAAIA,EAAO,IAC9E3Y,EAAKc,IAAM,IAAIo1B,EAAAA,GAAI,CACfxd,OAAQA,EACRsT,gBAAiB,QACjB5U,aAAa,IAEjBpX,EAAKuwB,SAASrqB,IAAIlG,EAAKc,KAGvB,IAAM2Z,EAAS/B,EAAO+B,SACtBza,EAAKuwB,SAAS5sB,KAAKe,OAAOM,SAASkC,IAAIuT,EAAOnc,EAAGmc,EAAO/b,EAAG,IAAOga,EAAOI,KAAOJ,EAAOE,OAGvF,IAAMwnB,EAAoB,IAAIC,EAAAA,IAC9BD,EAAkBE,QAAQjP,EAAAA,EAAYkP,gBAAkB,eACxD,IAAMC,EAAcJ,EAAkB52B,KAAK,CACvC,SACA,SACA,SACA,SACA,SACA,WAEJxJ,EAAKuwB,SAASrwB,MAAMugC,WAAaD,EAGjC,IAAIE,EAAyC,QAAnClB,EAAyB,QAAzBC,EAAGz/B,EAAKb,MAAMuiB,MAAMif,aAAK,IAAAlB,GAAK,QAALA,EAAtBA,EAAwBmB,WAAG,IAAAnB,OAAA,EAA3BA,EAA6BtD,WAAG,IAAAqD,EAAAA,EAAI,GAC7CkB,EAAOrd,WAAW,OAClBqd,EAASG,SAASC,KAAK9qB,MAAM,KAAK,GAAKqb,EAAAA,EAAYkP,gBAAkBG,EAAOK,OAAO,IAEvF,IAAMC,GAA+B,QAAtBtB,EAAA1/B,EAAKb,MAAMuiB,MAAMif,aAAK,IAAAjB,GAAK,QAALA,EAAtBA,EAAwBkB,WAAG,IAAAlB,OAAA,EAA3BA,EAA6BhH,MAAO,YACnD,GAAIgI,EAAQ,KAAAO,EAAAC,EACFC,EAAY,IAAIC,EAAAA,EAAc,CAChCjF,IAAKuE,EACLhI,IAAKsI,IAEHK,EAAuC,QAAjCJ,EAAGjhC,EAAKb,MAAMuiB,MAAMif,MAAMC,IAAIhzB,WAAG,IAAAqzB,EAAAA,OAAIrvB,EAC3C0vB,EAAuC,QAAjCJ,EAAGlhC,EAAKb,MAAMuiB,MAAMif,MAAMC,IAAIt6B,WAAG,IAAA46B,EAAAA,OAAItvB,EAC3C2vB,EAAiB,IAAIC,EAAAA,EAAe,CACtCpvB,KAAM,MACNsG,OAAQA,EACRgY,OAAQyQ,EACRM,YAAmB7vB,IAAXyvB,QAAmCzvB,IAAX0vB,EAAuB,CAAED,OAAAA,EAAQC,OAAAA,QAAW1vB,IAEhF5R,EAAK+wB,SAAS,QAASwQ,EAC3B,CAGA,IAAIG,EAAmB,KACjB5D,IAAoC,QAAtB6B,EAAA3/B,EAAKb,MAAMuiB,MAAMif,aAAK,IAAAhB,OAAA,EAAtBA,EAAwBgC,WAAY,IAAI7gC,IAAI,SAAAsc,GAC5D,IAAMgb,EAAS/wB,GAAAA,GAAA,GACRrH,EAAKb,MAAMg3B,OAAOxkB,KAAK,SAAAiwB,GAAE,OAAIA,EAAGxvB,OAASgL,EAAEhL,IAAI,IAAC,IACnD+B,YAA6B,IAAjBiJ,EAAEjJ,aAKlB,OAHIikB,EAAUjkB,aACVutB,EAAmBtJ,GAEhBA,CACX,GACIsJ,GACA1hC,EAAK6hC,aAAaH,GAAkB,GAIxC,IAAMxtB,EAAclU,EAAK8hC,mBAAmB,IAG5C9hC,EAAK++B,UAAY,CAAC,EAClB,IAAMp3B,EAAe,CAAC,IACC,QAAtBi4B,EAAA5/B,EAAKb,MAAMuiB,MAAMif,aAAK,IAAAf,OAAA,EAAtBA,EAAwBmC,UAAW,IAAIr/B,QAAQ,SAAA+Q,GAAS,IAAAF,EACjDyuB,EAAWvuB,EAAM0oB,IACjB6F,EAAS3e,WAAW,OACpB2e,EAAWnB,SAASC,KAAK9qB,MAAM,KAAK,GAAKqb,EAAAA,EAAYkP,gBAAkByB,EAASjB,OAAO,IAE3F,IAAMkB,EAAQ,IAAIC,EAAAA,EACd,IAAIC,EAAAA,EAAcH,IAEtBC,EAAMjD,SAASz3B,WAAY,EAC3BvH,EAAKuwB,SAASrqB,IAAI+7B,GAClBjiC,EAAK++B,UAAUtrB,EAAMrB,MAAQ6vB,EAC7Bt6B,EAAa8L,EAAMrB,MAAQ,CAACwB,SAAS,EAAME,QAAS,IAAKvM,WAAW,EAAMC,MAAkB,QAAb+L,EAAEE,EAAMjM,aAAK,IAAA+L,EAAAA,EAAIE,EAAMrB,KAC1G,GAEApS,EAAKR,SAAS,SAAAqB,GAAK,MAAK,CACpBzB,aAAYiI,GAAAA,GAAA,GACLxG,EAAMzB,cAAY,IACrBc,MAAOF,EAAKuwB,SACZzvB,IAAKd,EAAKc,IACVG,OAAQw1B,EACR2L,OAAQ1B,EACR2B,OAAQrB,EACRlD,WAAYA,EACZ5pB,YAAaA,EACbvM,aAAcA,IAElB61B,SAAS8E,EAAAA,EAAAA,KACZ,EAGL,GAACzkC,GAAAmC,EAAA,kBACiB,WACVA,EAAKuiC,WACLviC,EAAKuiC,UAAUtxB,SAEnBjR,EAAKc,IAAIyJ,QAAQ,CAACi4B,eAAe,IACjCxiC,EAAKuwB,SAAShmB,UACd/H,OAAOm4B,OAAO36B,EAAK++B,WAAWr8B,QAAQ,SAAAiH,GAClC3J,EAAKuwB,SAASpf,OAAOxH,GACrBA,EAAOD,SAAS,SAAAW,GAAG,IAAAC,EAAA,OAAe,QAAfA,EAAID,EAAIE,eAAO,IAAAD,OAAA,EAAXA,EAAAlG,KAAAiG,EAAe,EAC1C,GACArK,EAAKuiC,UAAY,KACjBviC,EAAKc,IAAM,KACXd,EAAK++B,UAAY,CAAC,EAClB/+B,EAAKo/B,iBAAmB,KACxBp/B,EAAKuwB,SAAW,KAChBvwB,EAAKR,SAAS,SAACqB,GAAK,MAAM,CACtBzB,aAAYiI,GAAAA,GAAA,GAAMxG,EAAMzB,cAAiBq+B,EAAME,mBAClD,GACD39B,EAAKb,MAAM8pB,eAAe,KAC9B,GAACprB,GAAAmC,EAAA,WACU,SAACF,GAEJE,EAAKa,MAAM28B,UAAY19B,GACvBE,EAAK6/B,iBAEb,GAAChiC,GAAAmC,EAAA,gBACe,SAACuwB,GAAa,IAAAkS,EAC1BziC,EAAKR,SAAS,SAAAqB,GAAK,MAAK,CAACzB,aAAYiI,GAAAA,GAAA,GAC9BxG,EAAMzB,cAAY,IACrB4Z,gBAAiBuX,aAAQ,EAARA,EAAUvX,kBAE7B,GACFuX,SAAyB,QAAjBkS,EAARlS,EAAUvX,uBAAe,IAAAypB,GAAzBA,EAAAr+B,KAAAmsB,EAA4BvwB,EAAKb,MAAMujC,QAAQ/pB,OAAQ3Y,EAAKb,MAAMujC,QAAQz7B,SAC9E,GAACpJ,GAAAmC,EAAA,mBACkB,SAACy4B,GAChB,IAAMkK,EAASzhC,EAAAA,EAAiB0V,UAAU6hB,EAAUz4B,EAAKa,MAAMzB,aAAa6B,OAAQjB,EAAKa,MAAMzB,aAAaijC,QAC5G,OAAO,IAAI7iB,QAAQ,SAACC,IAChBmjB,EAAAA,EAAAA,IAAQ5iC,EAAKa,MAAMzB,aAAagjC,QAAQrmB,KAAK,SAAA8mB,GAEzCA,EAAKrG,WAAWzgB,KAAK,SAAA8b,GACjB,IAAAiL,EAA2CjL,EAAMkL,cAAzCC,EAAaF,EAAbE,cAAeC,EAAeH,EAAfG,gBAGvBnxB,EAAyB,CAACmxB,EAAgB,GAAIA,EAAgB,IAAvDC,EAAMpxB,EAAA,GAAEqxB,EAAMrxB,EAAA,GACrBC,EAA+B,CAACixB,EAAc,GAAIA,EAAc,IAAzDI,EAASrxB,EAAA,GAAEsxB,EAAStxB,EAAA,GAGrBuxB,EAAShjC,KAAKC,OAAOoiC,EAAO,GAAKS,GAAaF,GAC9CK,EAASjjC,KAAKC,OAAO8iC,EAAYV,EAAO,IAAMQ,GAEpDtL,EAAM2L,YAAY,CAAExY,OAAQ,CAACsY,EAAQC,EAAQD,EAAS,EAAGC,EAAS,KAAMxnB,KAAK,SAAA0nB,GACzEhkB,EAAQgkB,EAAO,GAAG,GACtB,EACJ,EACJ,EACJ,EACJ,GAAC5lC,GAAAmC,EAAA,uBACsB,SAAC1B,EAAGI,GAAsB,IAAnB0I,IAAO5J,UAAAC,OAAA,QAAAmU,IAAApU,UAAA,KAAAA,UAAA,GAC3BmH,EAAY,IAAIC,EAAAA,IAChBF,EAAS1E,EAAKuwB,SAAS5sB,KAAKe,OAClCC,EAAUE,cAAc,IAAIJ,EAAAA,IAAQnG,EAAGI,GAAIgG,GAE3C,IAAMg/B,EAAWt8B,EAAUzC,EAAU2W,iBAAiB,CAClDtb,EAAKo/B,kBAAgBrhC,OAAAgP,GAClB/M,EAAKuwB,SAASoT,cAAc97B,OAAO,SAAAuV,GAAC,OAAIA,IAAMpd,EAAKc,GAAG,GAAEA,IAAI,SAAA8iC,GAAM,OAAIA,EAAOroB,QAAQ,MACzF,GAAM,QAAK3J,EAERyJ,EAAY1W,EAAU2W,iBAAiB,CAACtb,EAAKc,IAAIya,WAAW1T,OAAO,SAAApB,GAAM,OAAsC,IAAlCA,EAAOkD,OAAOuI,SAASzU,MAAY,GAAE,GAExH,OAAIimC,GAAYroB,EACLqoB,EAASv9B,SAAWkV,EAAUlV,SAAWu9B,EAAWroB,EAExDqoB,QAAAA,EAAYroB,CACvB,GAACxd,GAAAmC,EAAA,cACa,SAAC9B,GACX,IAAMO,EAAQP,EAAGsG,OAAOq/B,WAClBhlC,EAASX,EAAGsG,OAAOs/B,YACzB9jC,EAAKuwB,SAASzsB,SAASigC,QAAQtlC,EAAOI,GACtCmB,EAAKuwB,SAAS5sB,KAAKe,OAAOs/B,OAASvlC,EAAQI,EAC3CmB,EAAKuwB,SAAS5sB,KAAKe,OAAOu/B,yBAC1BjkC,EAAKuwB,SAASzsB,SAASyT,OAAOvX,EAAKuwB,SAASrwB,MAAOF,EAAKuwB,SAAS5sB,KAAKe,OAC1E,GAAC7G,GAAAmC,EAAA,kBACiB,SAAC2Y,EAAQ1R,GACvBjH,EAAKa,MAAMzB,aAAa4Z,gBAAgBL,EAAQ1R,EACpD,GAxbIjH,EAAKiqB,UAAY,KACjBjqB,EAAKuiC,UAAY,KACjBviC,EAAKuwB,SAAW,KAChBvwB,EAAKc,IAAM,KACXd,EAAKo/B,iBAAmB,KACxBp/B,EAAK++B,UAAY,CAAC,EAClB/+B,EAAKa,MAAMzB,aAAa2xB,SAAW/wB,EAAK+wB,SACxC/wB,EAAKa,MAAMzB,aAAaw+B,SAAW59B,EAAK49B,SACxC59B,EAAKa,MAAMzB,aAAa8xB,YAAclxB,EAAKkxB,YAC3ClxB,EAAKa,MAAMzB,aAAagV,iBAAmBpU,EAAKoU,iBAChDpU,EAAKa,MAAMzB,aAAaqE,eAAiBzD,EAAKyD,eAC9CzD,EAAKa,MAAMzB,aAAa+D,eAAiBnD,EAAKmD,eAC9CnD,EAAKa,MAAMzB,aAAaiF,kBAAoBrE,EAAKqE,kBACjDrE,EAAKa,MAAMzB,aAAayU,kBAAoB7T,EAAK6T,kBACjD7T,EAAKa,MAAMzB,aAAa0c,iBAAmB9b,EAAK8b,iBAChD9b,EAAKa,MAAMzB,aAAaC,qBAAuBW,EAAKX,qBAAqBW,CAC7E,CAAC,OAAAH,GAAA49B,EAAAC,GAAA7S,GAAA4S,EAAA,EAAA39B,IAAA,oBAAAC,MACD,WACIE,KAAKd,MAAM+kC,SAASjkC,KACxB,GAAC,CAAAH,IAAA,qBAAAC,MACD,SAAmByK,EAAWC,GAAW,IAAAG,EAAA,KACjC3K,KAAKd,MAAMuiB,QAAUlX,EAAUkX,MAC/BzhB,KAAKs/B,gBACEt/B,KAAKd,MAAMg3B,SAAW3rB,EAAU2rB,QACvCl2B,KAAKT,SAAS,SAACqB,GAAK,MAChB,CACIzB,aAAYiI,GAAAA,GAAA,GAAMxG,EAAMzB,cAAY,IAAE8U,YAAatJ,EAAKk3B,mBAAmBjhC,EAAMzB,aAAa8U,eACjG,GAKLjU,KAAKY,MAAMzB,aAAa0+B,aAAerzB,EAAUrL,aAAa0+B,YAC9D79B,KAAKkkC,iBAGLlkC,KAAKY,MAAMzB,aAAa8U,cAAgBzJ,EAAUrL,aAAa8U,aAC/DjU,KAAKmkC,uBAAuBnkC,KAAKY,MAAMzB,aAAa8U,YAAazJ,EAAUrL,aAAa8U,aAGxFjU,KAAKY,MAAMzB,aAAauI,eAAiB8C,EAAUrL,aAAauI,cAChE1H,KAAKokC,wBAAwBpkC,KAAKY,MAAMzB,aAAauI,aAE7D,GAAC,CAAA7H,IAAA,SAAAC,MA6JD,WACI,IAAMq4B,EAAYn4B,KAAKY,MAAMzB,aAAa0+B,WAAWnsB,KAAK,SAAA2M,GAAC,OAAqB,IAAjBA,EAAEnK,UAAmB,GAC9EvT,EAAQ,CACV0jC,UAAWrkC,KAAKd,MAAMolC,WAAW3lC,IACjC4lC,YAAavkC,KAAKd,MAAMolC,WAAWthC,MACnCmnB,aAAcnqB,KAAKd,MAAMolC,WAAWE,OACpCC,WAAYzkC,KAAKd,MAAMolC,WAAW/lC,MAEtC,OACIgC,EAAAA,cAAA,OAAKC,UAAU,cACXD,EAAAA,cAAA,OAAKC,UAAU,YAAYuc,YAAa/c,KAAK0kC,eAAgBjkC,IAAKT,KAAK2kC,eAAgBhkC,MAAOA,IAC7FX,KAAKY,MAAMzB,aAAac,MACrBM,EAAAA,cAAC88B,GAAa,CAACx9B,IAAKG,KAAKY,MAAM28B,QAASD,SAAUt9B,KAAKs9B,SAAUC,QAASv9B,KAAKY,MAAM28B,SACjFh9B,EAAAA,cAAC2X,GAAa,CAACzX,IAAKT,KAAK4kC,cAAezlC,aAAca,KAAKY,MAAMzB,eACjEoB,EAAAA,cAACskC,EAAAA,EAAkB,CAACC,gBAAiB,GAAIC,sBAAuB/kC,KAAK4hC,aAAc1L,OAAQl2B,KAAKY,MAAMzB,aAAa0+B,aACnHt9B,EAAAA,cAACo6B,GAAQ,CAACh+B,QAASqD,KAAKd,MAAMvC,QAASwC,aAAca,KAAKY,MAAMzB,aAAcs7B,gBAAiBz6B,KAAKd,MAAMu7B,kBAC1Gl6B,EAAAA,cAAC8S,GAAW,CAAClU,aAAca,KAAKY,MAAMzB,eACtCoB,EAAAA,cAACrD,EAAW,CAACiC,aAAca,KAAKY,MAAMzB,eACtCoB,EAAAA,cAACw1B,GAAa,CAACoC,UAAWA,EAAWh5B,aAAca,KAAKY,MAAMzB,eAC9DoB,EAAAA,cAAC6T,GAAU,CAACjV,aAAca,KAAKY,MAAMzB,eACrCoB,EAAAA,cAACuvB,GAAS,CAAC3wB,aAAca,KAAKY,MAAMzB,eACpCoB,EAAAA,cAACe,GAAS,CAACnC,aAAca,KAAKY,MAAMzB,eACpCoB,EAAAA,cAACiR,GAAM,CAACrS,aAAca,KAAKY,MAAMzB,eACjCoB,EAAAA,cAAC2gB,GAAW,CAAC/hB,aAAca,KAAKY,MAAMzB,aAAcsiB,MAAOzhB,KAAKd,MAAMuiB,SAE1E,KAGhB,IAAC,CA7RM,CAASlhB,EAAAA,WAAe3C,GAA7B4/B,GAAK,YACY,CACfyG,SAAU7iC,IAAAA,KACV80B,OAAQ90B,IAAAA,MACRqhC,QAASrhC,IAAAA,OACTkjC,WAAYljC,IAAAA,OACZzE,QAASyE,IAAAA,OACTo1B,WAAYp1B,IAAAA,OACZq5B,gBAAiBr5B,IAAAA,OACjB4nB,eAAgB5nB,IAAAA,KAChBy+B,UAAWz+B,IAAAA,KACXqgB,MAAOrgB,IAAAA,SACVxD,GAZC4/B,GAAK,eAae,CAClBhyB,SAAU,CACN+D,aAAc,IACdggB,cAAe,IACf/f,SAAU,EACVw1B,SAAU,EACVxV,iBAAiB,GAErB7yB,QAAS,CACL28B,oBAAqB,OAE5B17B,GAxBC4/B,GAAK,oBAyBoB,CACvBv9B,MAAO,KACPY,IAAK,KACLG,OAAQ,KACRmhC,OAAQ,KACRC,OAAQ,KACRvE,WAAY,GACZ5pB,YAAa,GACbvM,aAAc,CAAC,IAmdvB,UAAerG,EAAAA,EAAAA,IAAQ,SAACT,GAAK,MAAM,CAC/B0jC,WAAY1jC,EAAMqkC,QAAQX,WAC7B,EAAG,CACAzE,UAAWA,EAAAA,GACX7W,eAAgBA,EAAAA,gBAJpB,CAKGwU,G,+ECtjBCjhC,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,0KAMrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,6DAA6D,MAAQ,GAAG,SAAW,wEAAwE,eAAiB,CAAC,uLAAuL,WAAa,MAEhZ,S,yFCVIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,0uCAuDrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,6DAA6D,MAAQ,GAAG,SAAW,2dAA2d,eAAiB,CAAC,y1CAAy1C,WAAa,MAEr8D,S,gFC3DIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,msCAiDrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,wDAAwD,MAAQ,GAAG,SAAW,4XAA4X,eAAiB,CAAC,syCAAsyC,WAAa,MAE9yD,S,0FCrDIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,i1BAuCrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,2DAA2D,MAAQ,GAAG,SAAW,wRAAwR,eAAiB,CAAC,g6BAAg6B,WAAa,MAEv0C,S,0FC3CIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,irBAyCrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,qDAAqD,MAAQ,GAAG,SAAW,oUAAoU,eAAiB,CAAC,owBAAowB,WAAa,MAEjtC,S,gFC7CIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,4MAUrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,0DAA0D,MAAQ,GAAG,SAAW,iEAAiE,eAAiB,CAAC,iOAAiO,WAAa,MAEhb,S,gFCdIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,ugBAwBrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,2DAA2D,MAAQ,GAAG,SAAW,0OAA0O,eAAiB,CAAC,wjBAAwjB,WAAa,MAEj7B,S,gFC5BIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,4HAOtC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,sDAAsD,MAAQ,GAAG,SAAW,4CAA4C,eAAiB,CAAC,2IAA2I,WAAa,MAEhU,S,gFCXIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,8pCAwDrC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,yDAAyD,MAAQ,GAAG,SAAW,4YAA4Y,eAAiB,CAAC,+wCAA+wC,WAAa,MAExyD,S,gFC5DIH,E,MAA0B,GAA4B,KAE1DA,EAAwBC,KAAK,CAACC,EAAOC,GAAI,87CAkErC,GAAG,CAAC,QAAU,EAAE,QAAU,CAAC,2DAA2D,MAAQ,GAAG,SAAW,4mBAA4mB,eAAiB,CAAC,mkDAAmkD,WAAa,MAE9zE,S","sources":["webpack://qwc2-demo-app/./qwc2/components/map3d/style/OverviewMap3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/BottomBar3D.css?290c","webpack://qwc2-demo-app/./qwc2/components/map3d/BottomBar3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Compare3D.css?912a","webpack://qwc2-demo-app/./qwc2/components/map3d/Compare3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/drawtool/CreateTool3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/drawtool/NumericInput3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/drawtool/EditTool3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Draw3D.css?31eb","webpack://qwc2-demo-app/./qwc2/components/map3d/Draw3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/LayerTree3D.css?ee11","webpack://qwc2-demo-app/./qwc2/components/map3d/LayerTree3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Map3DLight.css?f033","webpack://qwc2-demo-app/./qwc2/components/map3d/Map3DLight.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/MapControls3D.css?5db1","webpack://qwc2-demo-app/./qwc2/components/map3d/MapControls3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/MapExport3D.css?f910","webpack://qwc2-demo-app/./qwc2/components/map3d/MapExport3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/HeightProfile3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/Measure3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/OverviewMap3D.css?088c","webpack://qwc2-demo-app/./qwc2/components/map3d/OverviewMap3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/SearchField3D.css?ea4e","webpack://qwc2-demo-app/./qwc2/components/map3d/SearchField3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/TopBar3D.css?148f","webpack://qwc2-demo-app/./qwc2/components/map3d/TopBar3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/layers/VectorLayer3D.js","webpack://qwc2-demo-app/./qwc2/components/map3d/layers/WMSLayer3D.js","webpack://qwc2-demo-app/./qwc2/components/map3d/layers/WMTSLayer3D.js","webpack://qwc2-demo-app/./qwc2/components/map3d/layers/index.js","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Map3D.css?ab70","webpack://qwc2-demo-app/./qwc2/components/map3d/Map3D.jsx","webpack://qwc2-demo-app/./qwc2/components/map3d/style/SearchField3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/MapControls3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/TopBar3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/LayerTree3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Map3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Map3DLight.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/MapExport3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Draw3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/Compare3D.css","webpack://qwc2-demo-app/./qwc2/components/map3d/style/BottomBar3D.css"],"sourcesContent":["// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.overview-map-3d {\r\n    position: absolute;\r\n    bottom: 0;\r\n    right: 0;\r\n    z-index: 101;\r\n}\r\n\r\ndiv.overview-map-3d > button {\r\n    font-size: initial!important;\r\n    right: 0.25em;\r\n    bottom: 0.25em;\r\n    width: 1.375em;\r\n    height: 1.375em;\r\n    position: absolute;\r\n    color: var(--map-button-text-color)!important;\r\n    background-color: var(--map-button-bg-color)!important;\r\n    border: 0!important;\r\n    outline: 0;\r\n    z-index: 101;\r\n    border-radius: 2px;\r\n    font-weight: bold;\r\n}\r\n\r\ndiv.overview-map-3d > div.ol-overviewmap-map-3d {\r\n    position: absolute;\r\n    right: 1px;\r\n    bottom: 1px;\r\n    width: 200px;\r\n    height: 200px;\r\n    background-color: white;\r\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.5);\r\n    border: 1px solid var(--border-color);\r\n}\r\n\r\ndiv.overview-map-3d.ol-collapsed > div.ol-overviewmap-map-3d {\r\n    display: none;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/OverviewMap3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;IAClB,SAAS;IACT,QAAQ;IACR,YAAY;AAChB;;AAEA;IACI,4BAA4B;IAC5B,aAAa;IACb,cAAc;IACd,cAAc;IACd,eAAe;IACf,kBAAkB;IAClB,6CAA6C;IAC7C,sDAAsD;IACtD,mBAAmB;IACnB,UAAU;IACV,YAAY;IACZ,kBAAkB;IAClB,iBAAiB;AACrB;;AAEA;IACI,kBAAkB;IAClB,UAAU;IACV,WAAW;IACX,YAAY;IACZ,aAAa;IACb,uBAAuB;IACvB,0CAA0C;IAC1C,qCAAqC;AACzC;;AAEA;IACI,aAAa;AACjB\",\"sourcesContent\":[\"div.overview-map-3d {\\r\\n    position: absolute;\\r\\n    bottom: 0;\\r\\n    right: 0;\\r\\n    z-index: 101;\\r\\n}\\r\\n\\r\\ndiv.overview-map-3d > button {\\r\\n    font-size: initial!important;\\r\\n    right: 0.25em;\\r\\n    bottom: 0.25em;\\r\\n    width: 1.375em;\\r\\n    height: 1.375em;\\r\\n    position: absolute;\\r\\n    color: var(--map-button-text-color)!important;\\r\\n    background-color: var(--map-button-bg-color)!important;\\r\\n    border: 0!important;\\r\\n    outline: 0;\\r\\n    z-index: 101;\\r\\n    border-radius: 2px;\\r\\n    font-weight: bold;\\r\\n}\\r\\n\\r\\ndiv.overview-map-3d > div.ol-overviewmap-map-3d {\\r\\n    position: absolute;\\r\\n    right: 1px;\\r\\n    bottom: 1px;\\r\\n    width: 200px;\\r\\n    height: 200px;\\r\\n    background-color: white;\\r\\n    box-shadow: 0px 0px 8px rgba(0, 0, 0, 0.5);\\r\\n    border: 1px solid var(--border-color);\\r\\n}\\r\\n\\r\\ndiv.overview-map-3d.ol-collapsed > div.ol-overviewmap-map-3d {\\r\\n    display: none;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./BottomBar3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./BottomBar3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport PropTypes from 'prop-types';\r\n\r\nimport {setBottombarHeight} from '../../actions/map';\r\nimport CoordinatesUtils from '../../utils/CoordinatesUtils';\r\n\r\nimport './style/BottomBar3D.css';\r\n\r\n\r\nclass BottomBar3D extends React.Component {\r\n    static propTypes = {\r\n        sceneContext: PropTypes.object,\r\n        setBottombarHeight: PropTypes.func\r\n    };\r\n    state = {\r\n        cursorPosition: null,\r\n        progress: 0\r\n    };\r\n    componentDidMount() {\r\n        this.props.sceneContext.scene.viewport.addEventListener('mousemove', this.scheduleGetCursorPosition);\r\n        this.props.sceneContext.scene.addEventListener(\"update-end\", () => {\r\n            this.setState({progress: Math.round(this.props.sceneContext.scene.progress * 100) + \"%\"});\r\n        });\r\n    }\r\n    componentWillUnmount() {\r\n        clearTimeout(this.cursorPositionTimeout);\r\n    }\r\n    render() {\r\n        return (\r\n            <div className=\"map3d-bottombar\" ref={this.storeHeight}>\r\n                <div className=\"map3d-bottombar-progress\">\r\n                    <div className=\"map3d-bottombar-progressbar\" style={{width: this.state.progress}} />\r\n                    <div className=\"map3d-bottombar-progress-label\">{this.state.progress}</div>\r\n                </div>\r\n                <div className=\"map3d-bottombar-spacer\" />\r\n                <div className=\"map3d-bottombar-position\">\r\n                    {(this.state.cursorPosition || []).map(x => x.toFixed(0)).join(\" \")}\r\n                </div>\r\n                <div className=\"map3d-bottombar-projection\">\r\n                    {this.props.sceneContext.mapCrs ? CoordinatesUtils.getAvailableCRS()[this.props.sceneContext.mapCrs].label : \"\"}\r\n                </div>\r\n                <div className=\"map3d-bottombar-spacer\" />\r\n            </div>\r\n        );\r\n    }\r\n    scheduleGetCursorPosition = (ev) => {\r\n        const rect = ev.currentTarget.getBoundingClientRect();\r\n        const x = (ev.clientX - rect.left) / rect.width * 2 - 1;\r\n        const y = -(ev.clientY - rect.top) / rect.height * 2 + 1;\r\n        clearTimeout(this.cursorPositionTimeout);\r\n        this.cursorPositionTimeout = setTimeout(() => this.getCursorPosition(x, y), 150);\r\n    };\r\n    getCursorPosition = (x, y) => {\r\n        const intersection = this.props.sceneContext.getSceneIntersection(x, y);\r\n        if (intersection) {\r\n            const p = intersection.point;\r\n            this.setState({cursorPosition: [p.x, p.y, p.z]});\r\n        }\r\n    };\r\n    storeHeight = (el) => {\r\n        if (el) {\r\n            this.props.setBottombarHeight(el.clientHeight);\r\n        }\r\n    };\r\n}\r\n\r\nexport default connect(() => ({}), {\r\n    setBottombarHeight: setBottombarHeight\r\n})(BottomBar3D);\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Compare3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Compare3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport Coordinates from '@giro3d/giro3d/core/geographic/Coordinates';\r\nimport PropTypes from 'prop-types';\r\nimport {Group, Plane, Raycaster, Vector2, Vector3} from 'three';\r\nimport {GLTFLoader} from 'three/addons/loaders/GLTFLoader';\r\n\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport Icon from '../Icon';\r\nimport SideBar from '../SideBar';\r\nimport NumberInput from '../widgets/NumberInput';\r\nimport arrowModel from './models/arrow.glb';\r\n\r\nimport './style/Compare3D.css';\r\n\r\n\r\nclass Compare3D extends React.Component {\r\n    static propTypes = {\r\n        active: PropTypes.bool,\r\n        sceneContext: PropTypes.object\r\n    };\r\n    state = {\r\n        enabled: false,\r\n        clippedObjects: {},\r\n        planeX: 0,\r\n        planeY: 0,\r\n        planeA: 0\r\n    };\r\n    componentDidMount() {\r\n        const loader = new GLTFLoader();\r\n        loader.load(arrowModel, (gltf) => {\r\n            gltf.scene.traverse((object) => {\r\n                if (object.isMesh) {\r\n                    object.material.depthTest = false;  // Ignores depth buffer\r\n                    object.material.depthWrite = false; // Prevents modifying depth buffer\r\n                }\r\n            });\r\n            gltf.scene.renderOrder = 9999999; // Ensures it is rendered last\r\n\r\n            const leftArrow = gltf.scene.clone();\r\n            leftArrow.position.y = -4;\r\n            leftArrow.rotation.z = - 0.5 * Math.PI;\r\n            const rightArrow = gltf.scene.clone();\r\n            rightArrow.position.y = 4;\r\n            rightArrow.rotation.z = 0.5 * Math.PI;\r\n            this.arrows = new Group();\r\n            this.arrows.add(leftArrow);\r\n            this.arrows.add(rightArrow);\r\n        });\r\n    }\r\n    componentWillUnmount() {\r\n        this.clearClippingPlane();\r\n        this.arrows.traverse(obj => obj.dispose?.());\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.state.enabled && this.props.active && !prevProps.active) {\r\n            this.enableArrows();\r\n        } else if (this.state.enabled && !this.props.active && prevProps.active) {\r\n            this.disableArrows();\r\n        }\r\n        if (this.state.enabled && this.state !== prevState) {\r\n            if (this.props.active && !prevState.enabled) {\r\n                this.enableArrows();\r\n            }\r\n            // Recompute clipping plane\r\n            this.updateClippingPlane();\r\n        } else if (!this.state.enabled && prevState.enabled) {\r\n            this.clearClippingPlane();\r\n        }\r\n    }\r\n    updateClippingPlane = () => {\r\n        const point = new Vector3(this.state.planeX, this.state.planeY, 0);\r\n        const alpha = this.state.planeA / 180 * Math.PI;\r\n        const normal = new Vector3(Math.sin(alpha), Math.cos(alpha), 0);\r\n        const leftPlane = new Plane();\r\n        const rightPlane = new Plane();\r\n        leftPlane.setFromNormalAndCoplanarPoint(normal, point);\r\n        rightPlane.setFromNormalAndCoplanarPoint(normal.multiplyScalar(-1), point);\r\n        Object.entries(this.state.clippedObjects).forEach(([objectId, config]) => {\r\n            const planes = [];\r\n            if (config.left) {\r\n                planes.push(leftPlane);\r\n            }\r\n            if (config.right) {\r\n                planes.push(rightPlane);\r\n            }\r\n            if (objectId === \"__terrain\") {\r\n                this.props.sceneContext.map.clippingPlanes = planes;\r\n            } else {\r\n                this.props.sceneContext.getSceneObject(objectId).clippingPlanes = planes;\r\n            }\r\n        });\r\n        this.props.sceneContext.scene.notifyChange();\r\n        this.positionArrows(this.state.planeX, this.state.planeY, this.state.planeA);\r\n    };\r\n    clearClippingPlane = () => {\r\n        Object.keys(this.state.clippedObjects).forEach(objectId => {\r\n            if (objectId === \"__terrain\") {\r\n                this.props.sceneContext.map.clippingPlanes = [];\r\n            } else {\r\n                this.props.sceneContext.getSceneObject(objectId).clippingPlanes = [];\r\n            }\r\n        });\r\n        if (this.props.active) {\r\n            this.disableArrows();\r\n        }\r\n        this.props.sceneContext.scene.notifyChange();\r\n    };\r\n    enableArrows = () => {\r\n        this.props.sceneContext.addSceneObject(\"__compareArrows\", this.arrows);\r\n        this.props.sceneContext.scene.view.controls.addEventListener('change', this.centerArrowsInView);\r\n\r\n        const renderer = this.props.sceneContext.scene.renderer;\r\n        renderer.domElement.addEventListener(\"pointerdown\", this.dragArrows);\r\n    };\r\n    disableArrows = () => {\r\n        this.props.sceneContext.scene.view.controls?.removeEventListener?.('change', this.centerArrowsInView);\r\n        this.props.sceneContext.removeSceneObject(\"__compareArrows\");\r\n        this.props.sceneContext.scene.renderer.domElement.removeEventListener(\"pointerdown\", this.dragArrows);\r\n    };\r\n    dragArrows = (ev) => {\r\n        const mousePos = (event) => {\r\n            const rect = event.target.getBoundingClientRect();\r\n            const x = ((event.clientX - rect.left) / rect.width) * 2 - 1;\r\n            const y = -((event.clientY - rect.top) / rect.height) * 2 + 1;\r\n            return new Vector2(x, y);\r\n        };\r\n        const camera = this.props.sceneContext.scene.view.camera;\r\n        const raycaster = new Raycaster();\r\n        raycaster.setFromCamera(mousePos(ev), camera);\r\n        const intersects = raycaster.intersectObject(this.arrows).length > 0;\r\n        if (!intersects) {\r\n            return;\r\n        }\r\n        const plane = new Plane().setFromNormalAndCoplanarPoint(new Vector3(0, 0, 1), this.arrows.position);\r\n        const startPos = raycaster.ray.intersectPlane(plane, new Vector3());\r\n        const planePos = new Vector2(this.state.planeX, this.state.planeY);\r\n        const alpha = this.state.planeA / 180 * Math.PI;\r\n        const planeNormal = new Vector3(Math.sin(alpha), Math.cos(alpha), 0);\r\n        const moveArrows = (event) => {\r\n            raycaster.setFromCamera(mousePos(event), camera);\r\n            plane.setFromNormalAndCoplanarPoint(new Vector3(0, 0, 1), this.arrows.position);\r\n            const pos = raycaster.ray.intersectPlane(plane, new Vector3());\r\n            const delta = planeNormal.clone().multiplyScalar(\r\n                new Vector3().copy(pos.sub(startPos)).dot(planeNormal)\r\n            );\r\n            this.setState({planeX: planePos.x + delta.x, planeY: planePos.y + delta.y});\r\n            this.positionArrows(planePos.x + delta.x, planePos.y + delta.y, this.state.planeA);\r\n        };\r\n        this.props.sceneContext.scene.view.controls.enabled = false;\r\n        ev.view.addEventListener(\"pointermove\", moveArrows);\r\n        ev.view.addEventListener(\"pointerup\", () => {\r\n            this.props.sceneContext.scene.view.controls.enabled = true;\r\n            ev.view.removeEventListener(\"pointermove\", moveArrows);\r\n        }, {once: true});\r\n    };\r\n    centerArrowsInView = () => {\r\n        const cameraTarget = this.props.sceneContext.scene.view.controls.target.clone();\r\n        const alpha = this.state.planeA / 180 * Math.PI;\r\n        const dir = new Vector3(Math.cos(alpha), -Math.sin(alpha), 0);\r\n        const curPos = new Vector3(this.state.planeX, this.state.planeY, 0);\r\n        const newPos = curPos.add(dir.multiplyScalar(cameraTarget.sub(curPos).dot(dir)));\r\n        this.setState({planeX: newPos.x, planeY: newPos.y});\r\n        this.positionArrows(newPos.x, newPos.y, this.state.planeA);\r\n    };\r\n    positionArrows = (x, y, alpha) => {\r\n        const target = new Vector3(x, y, 0);\r\n        const distance = this.props.sceneContext.scene.view.camera.position.distanceTo(target);\r\n        const scale = Math.max(1, distance / 200);\r\n\r\n        const coordinates = new Coordinates(this.props.sceneContext.mapCrs, x, y, 0);\r\n        const result = this.props.sceneContext.map.getElevation({coordinates});\r\n        let z = 0;\r\n        if (result.samples.length > 0) {\r\n            result.samples.sort((a, b) => a.resolution - b.resolution);\r\n            z = result.samples[0].elevation;\r\n        }\r\n\r\n        this.arrows.position.x = target.x;\r\n        this.arrows.position.y = target.y;\r\n        this.arrows.position.z = z;\r\n        this.arrows.rotation.z = -alpha / 180 * Math.PI;\r\n        this.arrows.scale.set(scale, scale, scale);\r\n        this.arrows.updateMatrixWorld();\r\n    };\r\n    render() {\r\n        return (\r\n            <div>\r\n                <SideBar icon=\"layers\" id=\"Compare3D\"\r\n                    title={LocaleUtils.tr(\"appmenu.items.Compare3D\")}\r\n                    width=\"20em\"\r\n                >\r\n                    {() => ({\r\n                        body: this.renderBody()\r\n                    })}\r\n                </SideBar>\r\n            </div>\r\n        );\r\n    }\r\n    renderBody = () => {\r\n        const sceneContext = this.props.sceneContext;\r\n        const objects = {__terrain: {layertree: true, title: LocaleUtils.tr(\"map3d.terrain\")}, ...sceneContext.sceneObjects};\r\n        const objectIds = Object.keys(objects).filter(objectId => objects[objectId].layertree);\r\n        return (\r\n            <div className=\"compare3d-body\" role=\"body\">\r\n                <div className=\"compare3d-title\" onClick={this.toggleCompare}>\r\n                    <Icon icon={this.state.enabled ? \"checked\" : \"unchecked\"} />\r\n                    <span>{LocaleUtils.tr(\"compare3d.compare_objects\")}</span>\r\n                </div>\r\n                <div className=\"compare3d-objects\">\r\n                    {[\"left\", \"right\"].map(section => {\r\n                        const clipState = this.state.clippedObjects;\r\n                        let toggleAllIcon = \"checked\";\r\n                        let toggleAllValue = true;\r\n                        const toggleAllState = objectIds.reduce((res, id) => res + clipState[id]?.[section], 0);\r\n                        if (toggleAllState === objectIds.length) {\r\n                            toggleAllIcon = \"unchecked\";\r\n                            toggleAllValue = false;\r\n                        } else if (toggleAllState > 0) {\r\n                            toggleAllIcon = \"tristate\";\r\n                        }\r\n                        return (\r\n                            <div className=\"compare3d-section\" key={\"compare-\" + section}>\r\n                                <div\r\n                                    className=\"compare3d-item compare3d-item-toggleall\"\r\n                                    onClick={this.state.enabled ? () => this.toggleAllObjects(section, objectIds, toggleAllValue) : null}\r\n                                    title={LocaleUtils.tr(\"compare3d.toggleall\")}\r\n                                >\r\n                                    <Icon className=\"compare3d-item-checkbox\" disabled={!this.state.enabled} icon={toggleAllIcon} />\r\n                                    <span>{LocaleUtils.tr(\"compare3d.toggleall\")}</span>\r\n                                </div>\r\n                                {objectIds.map(objectId => (\r\n                                    <div\r\n                                        className=\"compare3d-item\"\r\n                                        key={objectId}\r\n                                        onClick={this.state.enabled ? () => this.toggleObject(section, objectId) : null}\r\n                                        title={objects[objectId].title ?? objectId}\r\n                                    >\r\n                                        <Icon className=\"compare3d-item-checkbox\" disabled={!this.state.enabled} icon={clipState[objectId]?.[section] ? \"unchecked\" : \"checked\"} />\r\n                                        <span>{objects[objectId].title ?? objectId}</span>\r\n                                    </div>\r\n                                ))}\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n                <div className=\"compare3d-title\">{LocaleUtils.tr(\"compare3d.clipplane\")}</div>\r\n                <table className=\"compare3d-planeconfig\">\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>x</td>\r\n                            <td><NumberInput disabled={!this.state.enabled} onChange={x => this.setState({planeX: x})} value={this.state.planeX}/></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>y</td>\r\n                            <td><NumberInput disabled={!this.state.enabled} onChange={y => this.setState({planeY: y})} value={this.state.planeY}/></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>&#945;</td>\r\n                            <td><NumberInput disabled={!this.state.enabled} onChange={a => this.setState({planeA: a})} suffix=\"\" value={this.state.planeA} /></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        );\r\n    };\r\n    toggleCompare = () => {\r\n        this.setState(state => {\r\n            const newState = {enabled: !state.enabled};\r\n            if (newState.enabled) {\r\n                // Position plane in current view\r\n                newState.planeX = this.props.sceneContext.scene.view.controls.target.x;\r\n                newState.planeY = this.props.sceneContext.scene.view.controls.target.y;\r\n                newState.planeA = -this.props.sceneContext.scene.view.controls.getAzimuthalAngle() / Math.PI * 180 + 90;\r\n            }\r\n            return newState;\r\n        });\r\n    };\r\n    toggleObject = (section, objectId) => {\r\n        this.setState(state => ({\r\n            clippedObjects: {\r\n                ...state.clippedObjects,\r\n                [objectId]: {\r\n                    ...state.clippedObjects[objectId],\r\n                    [section]: !state.clippedObjects[objectId]?.[section]\r\n                }\r\n            }\r\n        }));\r\n    };\r\n    toggleAllObjects = (section, objectIds, value) => {\r\n        this.setState(state => ({\r\n            clippedObjects: objectIds.reduce((res, objectId) => ({\r\n                ...res,\r\n                [objectId]: {\r\n                    ...state.clippedObjects[objectId],\r\n                    [section]: value\r\n                }\r\n            }), {})\r\n        }));\r\n    };\r\n}\r\n\r\nexport default connect(state => ({\r\n    active: state.task.id === \"Compare3D\"\r\n}), {\r\n\r\n})(Compare3D);\r\n","/**\r\n * Copyright 2025 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport {default as GiroShape} from '@giro3d/giro3d/entities/Shape';\r\nimport PropTypes from 'prop-types';\r\nimport {BoxGeometry, Color, ConeGeometry, CylinderGeometry, ExtrudeGeometry, Mesh, MeshStandardMaterial, Shape, SphereGeometry} from 'three';\r\n\r\nimport LocaleUtils from '../../../utils/LocaleUtils';\r\nimport Icon from '../../Icon';\r\nimport ColorButton from '../../widgets/ColorButton';\r\nimport NumberInput from '../../widgets/NumberInput';\r\n\r\n\r\nexport default class CreateTool3D extends React.Component {\r\n    static propTypes = {\r\n        baseSize: PropTypes.number,\r\n        baseSizeChanged: PropTypes.func,\r\n        color: PropTypes.array,\r\n        colorChanged: PropTypes.func,\r\n        drawGroupId: PropTypes.string,\r\n        geomType: PropTypes.string,\r\n        objectCreated: PropTypes.func,\r\n        sceneContext: PropTypes.object\r\n    };\r\n    componentDidMount() {\r\n        this.drawCursor = new GiroShape({\r\n            showVertices: true\r\n        });\r\n        this.props.sceneContext.addSceneObject(\"__drawCursor\", this.drawCursor);\r\n        const renderer = this.props.sceneContext.scene.renderer;\r\n        renderer.domElement.addEventListener(\"pointermove\", this.moveDrawCursor);\r\n        renderer.domElement.addEventListener(\"pointerdown\", this.drawShapeOnRelease);\r\n    }\r\n    componentWillUnmount() {\r\n        this.props.sceneContext.removeSceneObject(\"__drawCursor\");\r\n        const renderer = this.props.sceneContext.scene.renderer;\r\n        renderer.domElement.removeEventListener(\"pointermove\", this.moveDrawCursor);\r\n        renderer.domElement.removeEventListener(\"pointerdown\", this.drawShapeOnRelease);\r\n    }\r\n    render() {\r\n        return (\r\n            <div className=\"redlining-controlsbar\">\r\n                <span>\r\n                    <Icon className=\"redlining-control-icon\" icon=\"pen\" size=\"large\" />\r\n                    <ColorButton alpha={false} color={this.props.color} onColorChanged={this.props.colorChanged} />\r\n                </span>\r\n                <span>\r\n                    <span>{LocaleUtils.tr(\"redlining.size\")}:&nbsp;</span>\r\n                    <NumberInput max={99} min={1} mobile\r\n                        onChange={this.props.baseSizeChanged}\r\n                        value={this.props.baseSize}/>\r\n                </span>\r\n            </div>\r\n        );\r\n    }\r\n    moveDrawCursor = (ev) => {\r\n        const rect = ev.target.getBoundingClientRect();\r\n        const x = ((ev.clientX - rect.left) / rect.width) * 2 - 1;\r\n        const y = -((ev.clientY - rect.top) / rect.height) * 2 + 1;\r\n        const intersection = this.props.sceneContext.getSceneIntersection(x, y);\r\n        if (intersection) {\r\n            const p = intersection.point;\r\n            this.drawCursor.setPoints([p]);\r\n        } else {\r\n            this.drawCursor.setPoints([]);\r\n        }\r\n        this.props.sceneContext.scene.notifyChange();\r\n    };\r\n    drawShapeOnRelease = (ev) => {\r\n        if (ev.button === 0) {\r\n            const renderer = this.props.sceneContext.scene.renderer;\r\n            renderer.domElement.addEventListener(\"pointerup\", this.drawShape, {once: true});\r\n            renderer.domElement.addEventListener(\"pointermove\", () => {\r\n                renderer.domElement.removeEventListener(\"pointerup\", this.drawShape);\r\n            });\r\n        }\r\n    };\r\n    drawShape = () => {\r\n        const drawGroup = this.props.sceneContext.getSceneObject(this.props.drawGroupId);\r\n        if (this.drawCursor.points.length === 0 || !drawGroup) {\r\n            return;\r\n        }\r\n        let geometry = null;\r\n        const s = this.props.baseSize;\r\n        if (this.props.geomType === \"Cuboid\") {\r\n            geometry = new BoxGeometry( s, s, s );\r\n        } else if (this.props.geomType === \"Wedge\") {\r\n            const shape = new Shape();\r\n            shape.moveTo(-0.5 * s, -0.5 * s);\r\n            shape.lineTo(0.5 * s, -0.5 * s);\r\n            shape.lineTo(0.5 * s, 0.5 * s);\r\n            shape.lineTo(-0.5 * s, -0.5 * s);\r\n            geometry = new ExtrudeGeometry(shape, {depth: s});\r\n        } else if (this.props.geomType === \"Cylinder\") {\r\n            geometry = new CylinderGeometry( 0.5 * s, 0.5 * s, s );\r\n        } else if (this.props.geomType === \"Pyramid\") {\r\n            geometry = new ConeGeometry( 0.5 * s * Math.sqrt(2), s, 4, 1, false, Math.PI / 4);\r\n            // Ensure flat normals (pointing from faces, not edges)\r\n            geometry = geometry.toNonIndexed();\r\n            geometry.computeVertexNormals();\r\n        } else if (this.props.geomType === \"Sphere\") {\r\n            geometry = new SphereGeometry( 0.5 * s );\r\n        } else if (this.props.geomType === \"Cone\") {\r\n            geometry = new ConeGeometry( 0.5 * s, s );\r\n        }\r\n        if (geometry) {\r\n            geometry.rotateX(Math.PI / 2); // Z-up\r\n            const material = new MeshStandardMaterial({color: new Color(...this.props.color.map(c => c / 255))});\r\n            const mesh = new Mesh( geometry, material);\r\n            drawGroup.add(mesh);\r\n            mesh.position.copy(this.drawCursor.points[0]);\r\n            mesh.position.z += 0.5 * s;\r\n            mesh.updateMatrixWorld();\r\n            this.props.sceneContext.scene.notifyChange();\r\n            this.props.objectCreated(mesh);\r\n        }\r\n    };\r\n}\r\n","/**\r\n * Copyright 2025 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport PropTypes from 'prop-types';\r\n\r\nimport LocaleUtils from '../../../utils/LocaleUtils';\r\nimport ResizeableWindow from '../../ResizeableWindow';\r\nimport NumberInput from '../../widgets/NumberInput';\r\n\r\n\r\nexport default class NumericInput3D extends React.Component {\r\n    static propTypes = {\r\n        sceneContext: PropTypes.object,\r\n        selectedObject: PropTypes.object,\r\n        toggleNumericInput: PropTypes.func,\r\n        transformControls: PropTypes.object\r\n    };\r\n    state = {\r\n        pos: [0, 0, 0],\r\n        rot: [0, 0, 0],\r\n        scale: [1, 1, 1]\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.el = document.createElement(\"div\");\r\n        this.props.sceneContext.scene.viewport.parentElement.appendChild(this.el);\r\n    }\r\n    componentDidMount() {\r\n        this.props.transformControls.addEventListener('change', this.updateStateFromObject);\r\n        this.updateStateFromObject();\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        if (this.props.selectedObject !== prevProps.selectedObject) {\r\n            this.updateStateFromObject();\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        this.props.sceneContext.scene.viewport.parentElement.removeChild(this.el);\r\n        this.props.transformControls.removeEventListener('change', this.updateStateFromObject);\r\n    }\r\n    render() {\r\n        const pos = this.state.pos;\r\n        const rot = this.state.rot;\r\n        const scale = this.state.scale;\r\n        const disabled = !this.props.selectedObject;\r\n        const contents = (\r\n            <ResizeableWindow fitHeight icon=\"numericinput\" initialWidth={300} initialX={-1}\r\n                onClose={this.props.toggleNumericInput} scrollable title={LocaleUtils.tr(\"draw3d.numericinput\")} >\r\n                <div className=\"draw3d-numeric-input-body\" role=\"body\">\r\n                    <table>\r\n                        <tbody>\r\n                            <tr>\r\n                                <td>{LocaleUtils.tr(\"draw3d.position\")}</td>\r\n                                <td><NumberInput decimals={0} disabled={disabled} onChange={x => this.updatePosition(0, x)} value={pos[0]} /></td>\r\n                                <td><NumberInput decimals={0} disabled={disabled} onChange={y => this.updatePosition(1, y)} value={pos[1]} /></td>\r\n                                <td><NumberInput decimals={0} disabled={disabled} onChange={z => this.updatePosition(2, z)} value={pos[2]} /></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>{LocaleUtils.tr(\"draw3d.rotation\")}</td>\r\n                                <td><NumberInput decimals={1} disabled={disabled} onChange={x => this.updateRotation(0, x)} suffix=\"\" value={rot[0]} /></td>\r\n                                <td><NumberInput decimals={1} disabled={disabled} onChange={y => this.updateRotation(1, y)} suffix=\"\" value={rot[1]} /></td>\r\n                                <td><NumberInput decimals={1} disabled={disabled} onChange={z => this.updateRotation(2, z)} suffix=\"\" value={rot[2]} /></td>\r\n                            </tr>\r\n                            <tr>\r\n                                <td>{LocaleUtils.tr(\"draw3d.thescale\")}</td>\r\n                                <td><NumberInput decimals={1} disabled={disabled} onChange={x => this.updateScale(0, x)} value={scale[0]} /></td>\r\n                                <td><NumberInput decimals={1} disabled={disabled} onChange={y => this.updateScale(1, y)} value={scale[1]} /></td>\r\n                                <td><NumberInput decimals={1} disabled={disabled} onChange={z => this.updateScale(2, z)} value={scale[2]} /></td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </ResizeableWindow>\r\n        );\r\n        return ReactDOM.createPortal(contents, this.el);\r\n    }\r\n    updateStateFromObject = () => {\r\n        if (this.props.selectedObject) {\r\n            this.setState({\r\n                pos: this.props.selectedObject.position.toArray(),\r\n                rot: this.props.selectedObject.rotation.toArray().slice(0, 3).map(x => x / Math.PI * 180),\r\n                scale: this.props.selectedObject.scale.toArray()\r\n            });\r\n        } else {\r\n            this.setState({\r\n                pos: [0, 0, 0],\r\n                rot: [0, 0, 0],\r\n                scale: [1, 1, 1]\r\n            });\r\n        }\r\n    };\r\n    updatePosition = (idx, value) => {\r\n        const newPos = [...this.state.pos];\r\n        newPos[idx] = value;\r\n        this.props.selectedObject.position.set(...newPos);\r\n        this.update();\r\n    };\r\n    updateRotation = (idx, value) => {\r\n        const newRot = [...this.state.rot];\r\n        newRot[idx] = value;\r\n        this.props.selectedObject.rotation.set(\r\n            ...newRot.map(x => x / 180 * Math.PI),\r\n            this.props.selectedObject.rotation.order\r\n        );\r\n        this.update();\r\n    };\r\n    updateScale = (idx, value) => {\r\n        const newScale = [...this.state.scale];\r\n        newScale[idx] = value;\r\n        this.props.selectedObject.scale.set(...newScale);\r\n        this.update();\r\n    };\r\n    update = () => {\r\n        this.props.selectedObject.updateMatrixWorld();\r\n        this.props.transformControls.getHelper().updateMatrixWorld();\r\n        this.updateStateFromObject();\r\n        this.props.sceneContext.scene.notifyChange();\r\n    };\r\n}\r\n\r\n","/**\r\n * Copyright 2025 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport {TransformControls} from 'three/addons/controls/TransformControls';\r\n\r\nimport LocaleUtils from '../../../utils/LocaleUtils';\r\nimport Icon from '../../Icon';\r\nimport ButtonBar from '../../widgets/ButtonBar';\r\nimport ColorButton from '../../widgets/ColorButton';\r\nimport NumericInput3D from './NumericInput3D';\r\n\r\n\r\nexport default class EditTool3D extends React.Component {\r\n    static propTypes = {\r\n        color: PropTypes.array,\r\n        colorChanged: PropTypes.func,\r\n        drawGroupId: PropTypes.string,\r\n        objectPicked: PropTypes.func,\r\n        sceneContext: PropTypes.object,\r\n        selectedObject: PropTypes.object\r\n    };\r\n    state = {\r\n        mode: 'translate',\r\n        numericInput: false\r\n    };\r\n    componentDidMount() {\r\n        const camera = this.props.sceneContext.scene.view.camera;\r\n        const renderer = this.props.sceneContext.scene.renderer;\r\n        this.transformControls = new TransformControls( camera, renderer.domElement );\r\n        this.props.sceneContext.scene.add(this.transformControls.getHelper());\r\n        this.transformControls.setMode(this.state.mode);\r\n        this.transformControls.addEventListener('change', this.toolChanged);\r\n        this.transformControls.addEventListener('mouseUp', this.toolChanged);\r\n        this.transformControls.addEventListener('dragging-changed', (event) => {\r\n            this.props.sceneContext.scene.view.controls.enabled = !event.value;\r\n        });\r\n        renderer.domElement.addEventListener(\"pointerdown\", this.selectShapeOnRelease);\r\n        renderer.domElement.addEventListener('keydown', this.onKeyDown);\r\n        if (this.props.selectedObject) {\r\n            this.transformControls.attach(this.props.selectedObject);\r\n            this.transformControls.getHelper().updateMatrixWorld();\r\n            this.props.colorChanged(this.props.selectedObject.material.color.toArray().map(c => c * 255));\r\n        }\r\n        this.props.sceneContext.scene.view.controls.addEventListener('change', this.updateTransformHelper);\r\n        this.props.sceneContext.scene.notifyChange();\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.selectedObject !== prevProps.selectedObject) {\r\n            if (prevProps.selectedObject) {\r\n                this.transformControls.detach();\r\n            }\r\n            if (this.props.selectedObject) {\r\n                this.transformControls.attach(this.props.selectedObject);\r\n                this.props.colorChanged(this.props.selectedObject.material.color.toArray().map(c => c * 255));\r\n            }\r\n            this.transformControls.getHelper().updateMatrixWorld();\r\n            this.props.sceneContext.scene.notifyChange();\r\n        }\r\n        if (this.state.mode !== prevState.mode) {\r\n            this.transformControls.setMode(this.state.mode);\r\n            this.transformControls.getHelper().updateMatrixWorld();\r\n            this.props.sceneContext.scene.notifyChange();\r\n        }\r\n        if (this.props.color !== prevProps.color && this.props.selectedObject) {\r\n            this.props.selectedObject.material.color.setRGB(...this.props.color.map(c => c / 255));\r\n            this.props.sceneContext.scene.notifyChange();\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        this.transformControls.detach();\r\n        this.props.sceneContext.scene.remove(this.transformControls.getHelper());\r\n        this.transformControls.dispose();\r\n        const domElement = this.props.sceneContext.scene.renderer.domElement;\r\n        this.props.sceneContext.scene.view.controls.removeEventListener('change', this.updateTransformHelper);\r\n        domElement.removeEventListener(\"pointerdown\", this.selectShapeOnRelease);\r\n        domElement.removeEventListener('keydown', this.onKeyDown);\r\n        this.props.sceneContext.scene.notifyChange();\r\n    }\r\n    render() {\r\n        const editButtons = [\r\n            {key: \"translate\", label: LocaleUtils.tr(\"draw3d.translate\")},\r\n            {key: \"scale\", label: LocaleUtils.tr(\"draw3d.scale\")},\r\n            {key: \"rotate\", label: LocaleUtils.tr(\"draw3d.rotate\")}\r\n        ];\r\n        const extraButtons = [\r\n            {key: \"NumericInput\", tooltip: LocaleUtils.tr(\"draw3d.numericinput\"), icon: \"numericinput\"}\r\n        ];\r\n        return (\r\n            <div className=\"redlining-controlsbar\">\r\n                <span>\r\n                    <Icon className=\"redlining-control-icon\" icon=\"pen\" size=\"large\" />\r\n                    <ColorButton alpha={false} color={this.props.color} onColorChanged={this.props.colorChanged} />\r\n                </span>\r\n                <span>\r\n                    <ButtonBar active={this.state.mode} buttons={editButtons} onClick={mode => this.setState({mode})} />\r\n                </span>\r\n                <span className=\"redlining-group\">\r\n                    <ButtonBar active={this.state.numericInput ? \"NumericInput\" : null} buttons={extraButtons} onClick={this.toggleNumericInput} />\r\n                </span>\r\n                {this.state.numericInput ? (\r\n                    <NumericInput3D\r\n                        sceneContext={this.props.sceneContext} selectedObject={this.props.selectedObject}\r\n                        toggleNumericInput={this.toggleNumericInput} transformControls={this.transformControls}\r\n                    />\r\n                ) : null}\r\n            </div>\r\n        );\r\n    }\r\n    selectShapeOnRelease = (ev) => {\r\n        if (ev.button === 0 && !this.transformControls.dragging) {\r\n            const renderer = this.props.sceneContext.scene.renderer;\r\n            renderer.domElement.addEventListener(\"pointerup\", this.selectShape, {once: true});\r\n            renderer.domElement.addEventListener(\"pointermove\", () => {\r\n                renderer.domElement.removeEventListener(\"pointerup\", this.selectShape);\r\n            });\r\n        }\r\n    };\r\n    selectShape = (ev) => {\r\n        const rect = ev.target.getBoundingClientRect();\r\n        const x = ((ev.clientX - rect.left) / rect.width) * 2 - 1;\r\n        const y = -((ev.clientY - rect.top) / rect.height) * 2 + 1;\r\n        const intersection = this.props.sceneContext.getSceneIntersection(x, y);\r\n        if (intersection) {\r\n            // Check if closest (first) intersected object is within the current draw group\r\n            const object = intersection.object;\r\n            const drawGroup = this.props.sceneContext.getSceneObject(this.props.drawGroupId);\r\n            for (let parent = object.parent; parent; parent = parent.parent) {\r\n                if (parent === drawGroup) {\r\n                    this.props.objectPicked(object);\r\n                    return;\r\n                }\r\n            }\r\n            this.props.objectPicked(null);\r\n        }\r\n    };\r\n    updateTransformHelper = () => {\r\n        this.transformControls.getHelper().updateMatrixWorld();\r\n        this.props.sceneContext.scene.notifyChange();\r\n    };\r\n    toolChanged = () => {\r\n        this.props.selectedObject?.updateMatrixWorld?.();\r\n        this.transformControls.getHelper().updateMatrixWorld();\r\n        this.props.sceneContext.scene.notifyChange();\r\n    };\r\n    onKeyDown = (ev) => {\r\n        if (ev.key === \"Escape\") {\r\n            this.transformControls.reset();\r\n        }\r\n    };\r\n    toggleNumericInput = () => {\r\n        this.setState(state => ({numericInput: !state.numericInput}));\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Draw3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Draw3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2025 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport {Group} from 'three';\r\nimport {v4 as uuidv4} from 'uuid';\r\n\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport Icon from '../Icon';\r\nimport TaskBar from '../TaskBar';\r\nimport ButtonBar from '../widgets/ButtonBar';\r\nimport CreateTool3D from './drawtool/CreateTool3D';\r\nimport EditTool3D from './drawtool/EditTool3D';\r\n\r\nimport './style/Draw3D.css';\r\n\r\nexport default class Draw3D extends React.Component {\r\n    static propTypes = {\r\n        sceneContext: PropTypes.object\r\n    };\r\n    state = {\r\n        action: null,\r\n        baseSize: 10,\r\n        color: [255, 105,   0, 1],\r\n        geomType: null,\r\n        drawGroupId: \"\",\r\n        selectedObject: null\r\n    };\r\n    onShow = () => {\r\n        // Ensure a draw group is present\r\n        const drawGroup = Object.entries(this.props.sceneContext.sceneObjects).find(([key, options]) => {\r\n            return options.drawGroup === true;\r\n        });\r\n        if (drawGroup === undefined) {\r\n            this.addDrawGroup(LocaleUtils.tr(\"draw3d.drawings\"));\r\n        } else {\r\n            this.setState({drawGroupId: drawGroup[0]});\r\n        }\r\n        this.setState({action: 'Pick'});\r\n    };\r\n    onHide = () => {\r\n        // Remove empty draw groups\r\n        Object.entries(this.props.sceneContext.sceneObjects).filter(([objectId, options]) => {\r\n            return options.drawGroup === true;\r\n        }).forEach(([objectId, options]) => {\r\n            const object = this.props.sceneContext.getSceneObject(objectId);\r\n            if (object.children.length === 0) {\r\n                this.props.sceneContext.removeSceneObject(objectId);\r\n            }\r\n        });\r\n    };\r\n    createDrawGroup = () => {\r\n        const message = LocaleUtils.tr(\"draw3d.newgroupprompt\");\r\n        // eslint-disable-next-line\r\n        const name = prompt(message);\r\n        if (name) {\r\n            this.addDrawGroup(name);\r\n        }\r\n    };\r\n    addDrawGroup = (name) => {\r\n        const objectId = uuidv4();\r\n        const options = {\r\n            drawGroup: true,\r\n            layertree: true,\r\n            title: name\r\n        };\r\n        this.props.sceneContext.addSceneObject(objectId, new Group(), options);\r\n        this.setState({drawGroupId: objectId});\r\n    };\r\n    renderBody = () => {\r\n        const activeButton = this.state.action === \"Create\" ? this.state.geomType : this.state.action;\r\n        const drawButtons = [\r\n            {key: \"Cuboid\", tooltip: LocaleUtils.tr(\"draw3d.cuboid\"), icon: \"cuboid\", data: {action: \"Create\", geomType: \"Cuboid\"}},\r\n            {key: \"Wedge\", tooltip: LocaleUtils.tr(\"draw3d.wedge\"), icon: \"wedge\", data: {action: \"Create\", geomType: \"Wedge\"}},\r\n            {key: \"Cylinder\", tooltip: LocaleUtils.tr(\"draw3d.cylinder\"), icon: \"cylinder\", data: {action: \"Create\", geomType: \"Cylinder\"}},\r\n            [\r\n                {key: \"Pyramid\", tooltip: LocaleUtils.tr(\"draw3d.pyramid\"), icon: \"pyramid\", data: {action: \"Create\", geomType: \"Pyramid\"}},\r\n                {key: \"Sphere\", tooltip: LocaleUtils.tr(\"draw3d.sphere\"), icon: \"sphere\", data: {action: \"Create\", geomType: \"Sphere\"}},\r\n                {key: \"Cone\", tooltip: LocaleUtils.tr(\"draw3d.cone\"), icon: \"cone\", data: {action: \"Create\", geomType: \"Cone\"}}\r\n            ]\r\n        ];\r\n        const editButtons = [\r\n            {key: \"Pick\", tooltip: LocaleUtils.tr(\"draw3d.pick\"), icon: \"nodetool\", data: {action: \"Pick\", geomType: null}},\r\n            {key: \"Delete\", tooltip: LocaleUtils.tr(\"draw3d.delete\"), icon: \"trash\", data: {action: \"Delete\", geomType: null}, disabled: !this.state.selectedObject}\r\n        ];\r\n        const drawGroups = Object.entries(this.props.sceneContext.sceneObjects).filter(([key, entry]) => entry.drawGroup === true);\r\n        return (\r\n            <div>\r\n                <div className=\"redlining-buttongroups\">\r\n                    <div className=\"redlining-group\">\r\n                        <div>{LocaleUtils.tr(\"redlining.layer\")}</div>\r\n                        <div className=\"controlgroup\">\r\n                            <select onChange={(ev) => this.setState({drawGroupId: ev.target.value})} value={this.state.drawGroupId}>\r\n                                {drawGroups.map(([objectId, options]) => (\r\n                                    <option key={objectId} value={objectId}>{options.title}</option>\r\n                                ))}\r\n                            </select>\r\n                            <button className=\"button\" onClick={this.createDrawGroup}><Icon icon=\"plus\" /></button>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"redlining-group\">\r\n                        <div>{LocaleUtils.tr(\"redlining.draw\")}</div>\r\n                        <span>\r\n                            <ButtonBar active={activeButton} buttons={drawButtons} onClick={(key, data) => this.actionChanged(data)} />\r\n                        </span>\r\n                    </div>\r\n                    <div className=\"redlining-group\">\r\n                        <div>{LocaleUtils.tr(\"redlining.edit\")}</div>\r\n                        <ButtonBar active={activeButton} buttons={editButtons} onClick={(key, data) => this.actionChanged(data)} />\r\n                    </div>\r\n                </div>\r\n                {this.renderControl()}\r\n            </div>\r\n        );\r\n    };\r\n    renderControl = () => {\r\n        if (this.state.action === \"Create\") {\r\n            return (\r\n                <CreateTool3D\r\n                    baseSize={this.state.baseSize} baseSizeChanged={baseSize => this.setState({baseSize})}\r\n                    color={this.state.color} colorChanged={color => this.setState({color})}\r\n                    drawGroupId={this.state.drawGroupId} geomType={this.state.geomType}\r\n                    objectCreated={this.objectCreated} sceneContext={this.props.sceneContext} />\r\n            );\r\n        } else if (this.state.action === \"Pick\") {\r\n            return (\r\n                <EditTool3D\r\n                    color={this.state.color} colorChanged={color => this.setState({color})}\r\n                    drawGroupId={this.state.drawGroupId} objectPicked={this.objectPicked}\r\n                    sceneContext={this.props.sceneContext}\r\n                    selectedObject={this.state.selectedObject} />\r\n            );\r\n        }\r\n        return null;\r\n    };\r\n    render() {\r\n        return (\r\n            <TaskBar onHide={this.onHide} onShow={this.onShow} task=\"Draw3D\">\r\n                {() => ({\r\n                    body: this.renderBody()\r\n                })}\r\n            </TaskBar>\r\n        );\r\n    }\r\n    actionChanged = (data) => {\r\n        if (data.action === \"Delete\") {\r\n            this.deleteSelectedObject();\r\n            this.setState({action: 'Pick', geomType: null, selectedObject: null});\r\n        } else {\r\n            this.setState({action: data.action, geomType: data.geomType, selectedObject: null});\r\n        }\r\n    };\r\n    deleteSelectedObject = () => {\r\n        this.props.sceneContext.getSceneObject(this.state.drawGroupId).remove(this.state.selectedObject);\r\n        this.state.selectedObject.traverse(obj => obj.dispose?.());\r\n        this.props.sceneContext.scene.notifyChange();\r\n    };\r\n    objectCreated = (object) => {\r\n        this.setState({action: 'Pick', geomType: null, selectedObject: object});\r\n    };\r\n    objectPicked = (object) => {\r\n        this.setState({selectedObject: object});\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./LayerTree3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./LayerTree3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport classNames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport Icon from '../Icon';\r\nimport SideBar from '../SideBar';\r\n\r\nimport './style/LayerTree3D.css';\r\n\r\n\r\nexport default class LayerTree3D extends React.Component {\r\n    static propTypes = {\r\n        sceneContext: PropTypes.object\r\n    };\r\n    render() {\r\n        return (\r\n            <div>\r\n                <SideBar icon=\"layers\" id=\"LayerTree3D\"\r\n                    title={LocaleUtils.tr(\"appmenu.items.LayerTree3D\")}\r\n                    width=\"20em\"\r\n                >\r\n                    {() => ({\r\n                        body: this.renderBody()\r\n                    })}\r\n                </SideBar>\r\n            </div>\r\n        );\r\n    }\r\n    renderBody = () => {\r\n        const sceneContext = this.props.sceneContext;\r\n        return (\r\n            <div className=\"layertree3d-item-container\">\r\n                <div className=\"layertree3d-section\">{LocaleUtils.tr(\"layertree3d.objects\")}</div>\r\n                {Object.entries(sceneContext.sceneObjects).map(([objectId, entry]) => {\r\n                    if (!entry.layertree) {\r\n                        return null;\r\n                    }\r\n                    const classes = classNames({\r\n                        \"layertree3d-item\": true,\r\n                        \"layertree3d-item-disabled\": !entry.visible\r\n                    });\r\n                    return (\r\n                        <div className={classes} key={objectId}>\r\n                            <Icon className=\"layertree3d-item-checkbox\"\r\n                                icon={entry.visible ? \"checked\" : \"unchecked\"}\r\n                                onClick={() => sceneContext.updateSceneObject(objectId, {visible: !entry.visible})}\r\n                            />\r\n                            <span className=\"layertree3d-item-title\" title={entry.title ?? objectId}>{entry.title ?? objectId}</span>\r\n                            <span className=\"layertree3d-item-transparency\">\r\n                                <input className=\"layertree3d-item-transparency-slider\" max=\"100\" min=\"0\"\r\n                                    onChange={(ev) => sceneContext.updateSceneObject(objectId, {opacity: parseInt(ev.target.value, 10) / 100})}\r\n                                    step=\"1\" type=\"range\" value={entry.opacity * 100} />\r\n                            </span>\r\n                        </div>\r\n                    );\r\n                })}\r\n                <div className=\"layertree3d-section\">{LocaleUtils.tr(\"layertree3d.layers\")}</div>\r\n                {sceneContext.colorLayers.map(entry => {\r\n                    const classes = classNames({\r\n                        \"layertree3d-item\": true,\r\n                        \"layertree3d-item-disabled\": !entry.visibility\r\n                    });\r\n                    return (\r\n                        <div className={classes} key={entry.id}>\r\n                            <Icon className=\"layertree3d-item-checkbox\"\r\n                                icon={entry.visibility ? \"checked\" : \"unchecked\"}\r\n                                onClick={() => sceneContext.updateColorLayer(entry.id, {visibility: !entry.visibility})}\r\n                            />\r\n                            <span className=\"layertree3d-item-title\" title={entry.title}>{entry.title}</span>\r\n                            <span className=\"layertree3d-item-transparency\">\r\n                                <input className=\"layertree3d-item-transparency-slider\" max=\"255\" min=\"0\"\r\n                                    onChange={(ev) => sceneContext.updateColorLayer(entry.id, {opacity: parseInt(ev.target.value, 10)})}\r\n                                    step=\"1\" type=\"range\" value={entry.opacity} />\r\n                            </span>\r\n                        </div>\r\n                    );\r\n                })}\r\n            </div>\r\n        );\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Map3DLight.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Map3DLight.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport PropTypes from 'prop-types';\r\nimport suncalc from 'suncalc';\r\nimport {AmbientLight, DirectionalLight} from 'three';\r\n\r\nimport CoordinatesUtils from '../../utils/CoordinatesUtils';\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport SideBar from '../SideBar';\r\nimport Input from '../widgets/Input';\r\nimport ToggleSwitch from '../widgets/ToggleSwitch';\r\n\r\nimport './style/Map3DLight.css';\r\n\r\n\r\nexport default class Map3DLight extends React.Component {\r\n    static propTypes = {\r\n        sceneContext: PropTypes.object\r\n    };\r\n    state = {\r\n        systemTime: false,\r\n        timestamp: 0\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.setTimestampTimeout = null;\r\n        const now = new Date();\r\n        now.setHours(12);\r\n        now.setMinutes(0);\r\n        now.setSeconds(0);\r\n        this.state.timestamp = +now;\r\n    }\r\n    componentDidMount() {\r\n        this.componentDidUpdate({});\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.sceneContext.scene !== prevProps.sceneContext?.scene) {\r\n            const ambientLight = new AmbientLight('white', 0.5);\r\n            this.props.sceneContext.addSceneObject(\"__ambientLight\", ambientLight);\r\n\r\n            const directionalLight = new DirectionalLight(0xffffff, 1.5);\r\n            this.props.sceneContext.addSceneObject(\"__directionalLight\", directionalLight);\r\n\r\n            this.props.sceneContext.scene.view.controls.addEventListener('change', () => this.updateLightPosition());\r\n            // Ensure light position is updated at least once per minute\r\n            this.lightPositionInterval = setInterval(() => this.updateLightPosition(true), 1000 * 60);\r\n            this.updateLightPosition();\r\n        } else if (this.state.timestamp !== prevState.timestamp) {\r\n            this.updateLightPosition(true);\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        clearInterval(this.lightPositionInterval);\r\n    }\r\n    render() {\r\n        return (\r\n            <div>\r\n                <SideBar icon=\"clock\" id=\"DateTime3D\"\r\n                    title={LocaleUtils.tr(\"appmenu.items.DateTime3D\")}\r\n                    width=\"20em\"\r\n                >\r\n                    {() => ({\r\n                        body: this.renderBody()\r\n                    })}\r\n                </SideBar>\r\n            </div>\r\n        );\r\n    }\r\n    renderBody = () => {\r\n        const date = new Date(this.state.timestamp);\r\n        const year = date.getFullYear();\r\n        const month = String(date.getMonth() + 1).padStart(2, '0');\r\n        const day = String(date.getDate()).padStart(2, '0');\r\n        const hours = String(date.getHours()).padStart(2, '0');\r\n        const minutes = String(date.getMinutes() + date.getSeconds() > 30 ? 1 : 0).padStart(2, '0');\r\n        const ymd = `${year}-${month}-${day}`;\r\n        const hm = `${hours}:${minutes}`;\r\n        return (\r\n            <div className=\"datetime3d-body\">\r\n                <table>\r\n                    <tbody>\r\n                        <tr>\r\n                            <td>System time</td>\r\n                            <td><ToggleSwitch active={this.state.systemTime} onChange={this.toggleSystemTime} /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Date</td>\r\n                            <td><Input disabled={this.state.systemTime} onChange={this.updateDate} type=\"date\" value={ymd} /></td>\r\n                        </tr>\r\n                        <tr>\r\n                            <td>Time</td>\r\n                            <td><Input disabled={this.state.systemTime} onChange={this.updateTime} type=\"time\" value={hm} /></td>\r\n                        </tr>\r\n                    </tbody>\r\n                </table>\r\n            </div>\r\n        );\r\n    };\r\n    toggleSystemTime = (active) => {\r\n        if (active) {\r\n            this.setCurrentTimestamp();\r\n        } else {\r\n            clearTimeout(this.setTimestampTimeout);\r\n        }\r\n        this.setState({systemTime: active});\r\n    };\r\n    updateDate = (value) => {\r\n        if (!value) {\r\n            return;\r\n        }\r\n        this.setState(state => {\r\n            const date = new Date(state.timestamp);\r\n            const ymd = value.split(\"-\").map(Number);\r\n            date.setFullYear(ymd[0]);\r\n            date.setMonth(ymd[1] - 1);\r\n            date.setDate(ymd[2]);\r\n            return {timestamp: +date};\r\n        });\r\n    };\r\n    updateTime = (value) => {\r\n        if (!value) {\r\n            return;\r\n        }\r\n        this.setState(state => {\r\n            const date = new Date(state.timestamp);\r\n            const hm = value.split(\":\").map(Number);\r\n            date.setHours(hm[0]);\r\n            date.setMinutes(hm[1]);\r\n            return {timestamp: +date};\r\n        });\r\n    };\r\n    setCurrentTimestamp = () => {\r\n        // Set current timestamp and update it every minute\r\n        const date = new Date();\r\n        const secondsRemaining = 60 - date.getSeconds() - date.getMilliseconds() / 1000;\r\n        this.setState({timestamp: +date});\r\n        this.setTimestampTimeout = setTimeout(this.setCurrentTimestamp, 1000 * secondsRemaining);\r\n    };\r\n    updateLightPosition = (force = false) => {\r\n        const sceneContext = this.props.sceneContext;\r\n        const directionalLight = sceneContext.getSceneObject(\"__directionalLight\");\r\n\r\n        // Recompute light\r\n        if (force || directionalLight.target.position.distanceTo(sceneContext.scene.view.controls.target) > 10000) {\r\n\r\n            const x = sceneContext.scene.view.controls.target.x;\r\n            const y = sceneContext.scene.view.controls.target.y;\r\n            const wgsPos = CoordinatesUtils.reproject([x, y], sceneContext.mapCrs, \"EPSG:4326\");\r\n\r\n            const sunPos = suncalc.getPosition(new Date(this.state.timestamp), wgsPos[1], wgsPos[0]);\r\n            const az = sunPos.azimuth + Math.PI;\r\n            const alt = sunPos.altitude;\r\n            // Assume sun at 10000km distance\r\n            const distance = 10000000;\r\n\r\n            directionalLight.position.x = x + Math.cos(alt) * Math.sin(az) * distance;\r\n            directionalLight.position.y = y + Math.cos(alt) * Math.cos(az) * distance;\r\n            directionalLight.position.z = Math.sin(alt) * distance;\r\n            directionalLight.updateMatrixWorld();\r\n\r\n            directionalLight.target.position.x = x;\r\n            directionalLight.target.position.y = y;\r\n            directionalLight.target.position.z = 0;\r\n            directionalLight.target.updateMatrixWorld();\r\n\r\n            const alpha = Math.max(0, alt / (0.5 * Math.PI));\r\n            const intensity = 1.15 * alpha / (alpha + 0.15);\r\n\r\n            sceneContext.map.hillshading.azimuth = az / Math.PI * 180; // Azimuth is measured from South\r\n            sceneContext.map.hillshading.zenith = 90 - intensity * 30;\r\n            sceneContext.map.hillshading.intensity = 1 - 0.4 * intensity;\r\n            sceneContext.map.hillshading.elevationLayersOnly = true;\r\n\r\n            // Modulate light intensities based on sun altitude\r\n            sceneContext.getSceneObject(\"__ambientLight\").intensity = 0.01 + 0.49 * intensity;\r\n            sceneContext.getSceneObject(\"__directionalLight\").intensity = 0.1 + 1.4 * intensity;\r\n\r\n            sceneContext.scene.notifyChange(sceneContext.map);\r\n            sceneContext.scene.renderer.render(sceneContext.scene.scene, sceneContext.scene.view.camera);\r\n        }\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./MapControls3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./MapControls3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport Coordinates from '@giro3d/giro3d/core/geographic/Coordinates';\r\nimport classNames from 'classnames';\r\nimport PropTypes from 'prop-types';\r\nimport {Raycaster, Vector2, Vector3} from 'three';\r\nimport {MapControls} from 'three/addons/controls/MapControls';\r\n\r\nimport Icon from '../Icon';\r\n\r\nimport './style/MapControls3D.css';\r\n\r\n\r\nexport default class MapControls3D extends React.Component {\r\n    static propTypes = {\r\n        sceneContext: PropTypes.object\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.animationInterrupted = false;\r\n        this.personHeight = 2;\r\n        this.prevTarget = null;\r\n    }\r\n    state = {\r\n        firstPerson: false\r\n    };\r\n    componentDidMount() {\r\n        const sceneElement = this.props.sceneContext.scene.domElement;\r\n        sceneElement.tabIndex = 0;\r\n        this.controls = new MapControls(this.props.sceneContext.scene.view.camera, sceneElement);\r\n        this.controls.zoomToCursor = true;\r\n        this.controls.enableDamping = true;\r\n        this.controls.dampingFactor = 0.2;\r\n        this.controls.maxPolarAngle = Math.PI * 0.5;\r\n        sceneElement.addEventListener('keydown', this.keyHandler);\r\n        this.props.sceneContext.scene.view.setControls(this.controls);\r\n\r\n        const targetPos = this.props.sceneContext.scene.view.camera.position.clone();\r\n        targetPos.z = 0;\r\n        this.controls.target = targetPos;\r\n        this.controls.addEventListener('change', this.updateControlsTarget);\r\n\r\n        sceneElement.addEventListener('dblclick', this.switchToFirstPersonView);\r\n    }\r\n    componentWillUnmount() {\r\n        this.animationInterrupted = true;\r\n        const sceneElement = this.props.sceneContext.scene.domElement;\r\n        sceneElement.addEventListener('keydown', this.keyHandler);\r\n        this.controls.removeEventListener('change', this.updateControlsTarget);\r\n        this.props.sceneContext.scene.view.setControls(null);\r\n        this.controls.dispose();\r\n        this.controls = null;\r\n        this.props.sceneContext.scene.domElement.removeEventListener('dblclick', this.switchToFirstPersonView);\r\n    }\r\n    render() {\r\n        const firstPersonButtonClasses = classNames({\r\n            \"map3d-firstperson-button\": true,\r\n            \"map3d-firstperson-button-active\": this.state.firstPerson\r\n        });\r\n        return [(\r\n            <div className=\"map3d-nav-pan\" key=\"MapPanWidget\">\r\n                <span />\r\n                <Icon icon=\"chevron-up\" onMouseDown={(ev) => this.pan(ev, 0, 1)} />\r\n                <span />\r\n                <Icon icon=\"chevron-left\" onMouseDown={(ev) => this.pan(ev, 1, 0)} />\r\n                <Icon icon=\"home\" onClick={() => this.home()} />\r\n                <Icon icon=\"chevron-right\" onMouseDown={(ev) => this.pan(ev, -1, 0)} />\r\n                <span />\r\n                <Icon icon=\"chevron-down\" onMouseDown={(ev) => this.pan(ev, 0, -1)} />\r\n                <span />\r\n            </div>\r\n        ),\r\n        (\r\n            <div className=\"map3d-nav-rotate\" key=\"MapRotateWidget\">\r\n                <span />\r\n                <Icon icon=\"tilt-up\" onMouseDown={(ev) => this.tilt(ev, 0, 1)} />\r\n                <span />\r\n                <Icon icon=\"tilt-left\" onMouseDown={(ev) => this.tilt(ev, 1, 0)} />\r\n                <Icon icon=\"point\" onClick={() => this.resetTilt()} />\r\n                <Icon icon=\"tilt-right\" onMouseDown={(ev) => this.tilt(ev, -1, 0)} />\r\n                <span />\r\n                <Icon icon=\"tilt-down\" onMouseDown={(ev) => this.tilt(ev, 0, -1)} />\r\n                <span />\r\n            </div>\r\n        ), (\r\n            <div className={firstPersonButtonClasses} key=\"FirstPersonButton\" onClick={this.toggleFirstPersonControls}>\r\n                <Icon icon=\"person\" />\r\n            </div>\r\n        )];\r\n    }\r\n    keyHandler = (event) => {\r\n        if (event.repeat) {\r\n            return;\r\n        } else if (event.key === \"ArrowUp\") {\r\n            if (event.ctrlKey) this.tilt(event, 0, 1, true);\r\n            else this.pan(event, 0, 1, true);\r\n        } else if (event.key === \"ArrowDown\") {\r\n            if (event.ctrlKey) this.tilt(event, 0, -1, true);\r\n            else this.pan(event, 0, -1, true);\r\n        } else if (event.key === \"ArrowLeft\") {\r\n            if (event.ctrlKey) this.tilt(event, 1, 0, true);\r\n            else this.pan(event, 1, 0, true);\r\n        } else if (event.key === \"ArrowRight\") {\r\n            if (event.ctrlKey) this.tilt(event, -1, 0, true);\r\n            else this.pan(event, -1, 0, true);\r\n        }\r\n    };\r\n    home = () => {\r\n        this.leaveFirstPerson();\r\n        const extent = this.props.sceneContext.map.extent;\r\n        const bounds = [extent.west, extent.south, extent.east, extent.north];\r\n        this.setViewToExtent(bounds);\r\n    };\r\n    pan = (ev, dx, dy, keyboard = false) => {\r\n        // Pan faster the heigher one is above the terrain\r\n        const d = this.state.firstPerson ? (\r\n            200000\r\n        ) : (\r\n            100 + (this.props.sceneContext.scene.view.camera.position.z - this.props.sceneContext.scene.view.controls.target.z) / 250\r\n        );\r\n        const delta = new Vector2(dx, dy).multiplyScalar(d);\r\n        this.animationInterrupted = false;\r\n        let lastTimestamp = new Date() / 1000;\r\n        const animate = () => {\r\n            if (this.animationInterrupted) {\r\n                return;\r\n            }\r\n            // Pan <delta> distance per second\r\n            const timestamp = new Date() / 1000;\r\n            const k = timestamp - lastTimestamp;\r\n            lastTimestamp = timestamp;\r\n            this.props.sceneContext.scene.view.controls._pan(delta.x * k, delta.y * k);\r\n            this.props.sceneContext.scene.notifyChange();\r\n            requestAnimationFrame(animate);\r\n        };\r\n        requestAnimationFrame(animate);\r\n        const element = keyboard ? ev.target : ev.view;\r\n        const event = keyboard ? \"keyup\" : \"mouseup\";\r\n        element.addEventListener(event, () => {\r\n            this.animationInterrupted = true;\r\n        }, {once: true});\r\n    };\r\n    tilt = (ev, yaw, az, keyboard = false) => {\r\n        if (this.state.firstPerson) {\r\n            az *= -1;\r\n            yaw *= -1;\r\n        }\r\n        // Pan faster the heigher one is above the terrain\r\n        this.animationInterrupted = false;\r\n        let lastTimestamp = new Date() / 1000;\r\n        const animate = () => {\r\n            if (this.animationInterrupted) {\r\n                return;\r\n            }\r\n            // Pan <delta> distance per second\r\n            const timestamp = new Date() / 1000;\r\n            const k = timestamp - lastTimestamp;\r\n            lastTimestamp = timestamp;\r\n            if (az) {\r\n                this.props.sceneContext.scene.view.controls._rotateUp(az * k);\r\n            }\r\n            if (yaw) {\r\n                this.props.sceneContext.scene.view.controls._rotateLeft(yaw * k);\r\n            }\r\n            this.props.sceneContext.scene.notifyChange();\r\n            requestAnimationFrame(animate);\r\n        };\r\n        requestAnimationFrame(animate);\r\n        const element = keyboard ? ev.target : ev.view;\r\n        const event = keyboard ? \"keyup\" : \"mouseup\";\r\n        element.addEventListener(event, () => {\r\n            this.animationInterrupted = true;\r\n        }, {once: true});\r\n    };\r\n    resetTilt = () => {\r\n        if (this.state.firstPerson) {\r\n            const target = this.props.sceneContext.scene.view.controls.target;\r\n            const camerapos = this.props.sceneContext.scene.view.camera.position;\r\n            this.props.sceneContext.scene.view.controls.target.set(target.x, target.y, camerapos.z);\r\n        } else {\r\n            // Animate from old to new position\r\n            const target = this.props.sceneContext.scene.view.controls.target;\r\n            const oldPosition = this.props.sceneContext.scene.view.camera.position.clone();\r\n            const oldYaw = this.props.sceneContext.scene.view.controls.getAzimuthalAngle();\r\n            const newPosition = new Vector3(target.x, target.y, target.distanceTo(oldPosition));\r\n            const startTime = new Date() / 1000;\r\n\r\n            this.animationInterrupted = false;\r\n            const animate = () => {\r\n                if (!this.props.sceneContext.scene || this.animationInterrupted) {\r\n                    return;\r\n                }\r\n                const duration = 2;\r\n                const elapsed = new Date() / 1000 - startTime;\r\n                const x = elapsed / duration;\r\n                const k =  0.5 * (1 - Math.cos(x * Math.PI));\r\n\r\n                const currentPosition = new Vector3().lerpVectors(oldPosition, newPosition, k);\r\n                currentPosition.x -= target.x;\r\n                currentPosition.y -= target.y;\r\n                currentPosition.applyAxisAngle(new Vector3(0, 0, 1), -oldYaw * k);\r\n                currentPosition.x += target.x;\r\n                currentPosition.y += target.y;\r\n                this.props.sceneContext.scene.view.camera.position.copy(currentPosition);\r\n                this.props.sceneContext.scene.notifyChange();\r\n\r\n                if (elapsed < duration) {\r\n                    requestAnimationFrame(animate);\r\n                } else {\r\n                    this.props.sceneContext.scene.view.camera.position.copy(newPosition);\r\n                    this.props.sceneContext.scene.notifyChange();\r\n                }\r\n            };\r\n            requestAnimationFrame(animate);\r\n        }\r\n    };\r\n    setViewToExtent = (bounds, angle = 0) => {\r\n        if (this.state.firstPerson) {\r\n            this.leaveFirstPerson();\r\n        }\r\n\r\n        const center = {\r\n            x: 0.5 * (bounds[0] + bounds[2]),\r\n            y: 0.5 * (bounds[1] + bounds[3])\r\n        };\r\n        const elevationResult = this.props.sceneContext.map.getElevation({coordinates: new Coordinates(this.props.sceneContext.mapCrs, center.x, center.y)});\r\n        elevationResult.samples.sort((a, b) => a.resolution > b.resolution);\r\n        center.z = elevationResult.samples[0]?.elevation || 0;\r\n\r\n        // Camera height to width bbox width\r\n        const fov = 35 / 180 * Math.PI;\r\n        const cameraHeight = (bounds[2] - bounds[0]) / (2 * Math.tan(fov / 2));\r\n\r\n        // Animate from old to new position/target\r\n        const oldPosition = this.props.sceneContext.scene.view.camera.position.clone();\r\n        const oldTarget = this.props.sceneContext.scene.view.controls.target.clone();\r\n        const oldYaw = this.props.sceneContext.scene.view.controls.getAzimuthalAngle();\r\n        const newPosition = new Vector3(center.x, center.y, center.z + cameraHeight);\r\n        const newTarget = new Vector3(center.x, center.y, center.z);\r\n        let rotateAngle = -oldYaw + angle;\r\n        while (rotateAngle > Math.PI) {\r\n            rotateAngle -= 2 * Math.PI;\r\n        }\r\n        while (rotateAngle < -Math.PI) {\r\n            rotateAngle += 2 * Math.PI;\r\n        }\r\n        const startTime = new Date() / 1000;\r\n\r\n        this.animationInterrupted = false;\r\n        const animate = () => {\r\n            if (!this.props.sceneContext.scene || this.animationInterrupted) {\r\n                return;\r\n            }\r\n            const duration = 2;\r\n            const elapsed = new Date() / 1000 - startTime;\r\n            const x = elapsed / duration;\r\n            const k =  0.5 * (1 - Math.cos(x * Math.PI));\r\n\r\n            const currentPosition = new Vector3().lerpVectors(oldPosition, newPosition, k);\r\n            const currentTarget = new Vector3().lerpVectors(oldTarget, newTarget, k);\r\n            currentPosition.x -= currentTarget.x;\r\n            currentPosition.y -= currentTarget.y;\r\n            currentPosition.applyAxisAngle(new Vector3(0, 0, 1), rotateAngle * k);\r\n            currentPosition.x += currentTarget.x;\r\n            currentPosition.y += currentTarget.y;\r\n            this.props.sceneContext.scene.view.camera.position.copy(currentPosition);\r\n            this.props.sceneContext.scene.view.controls.target.copy(currentTarget);\r\n            this.props.sceneContext.scene.notifyChange();\r\n\r\n            if (elapsed < duration) {\r\n                requestAnimationFrame(animate);\r\n            } else {\r\n                this.props.sceneContext.scene.view.camera.position.copy(newPosition);\r\n                this.props.sceneContext.scene.view.controls.target.copy(newTarget);\r\n                this.props.sceneContext.scene.view.controls._rotateLeft(-angle);\r\n                this.props.sceneContext.scene.notifyChange();\r\n            }\r\n        };\r\n        requestAnimationFrame(animate);\r\n    };\r\n    updateControlsTarget = () => {\r\n        const target = this.props.sceneContext.scene.view.controls.target;\r\n        if (this.prevTarget && this.prevTarget.distanceToSquared(target) < 50) {\r\n            return;\r\n        }\r\n        this.prevTarget = target.clone();\r\n        const x = target.x;\r\n        const y = target.y;\r\n        const raycaster = new Raycaster();\r\n        // Query highest resolution terrain tile (i.e. tile with no children)\r\n        raycaster.set(new Vector3(x, y, target.z + 100000), new Vector3(0, 0, -1));\r\n        const terrInter = raycaster.intersectObjects([this.props.sceneContext.map.object3d]).filter(result => result.object.children.length === 0)[0];\r\n        const terrainHeight = terrInter?.point?.z ?? 0;\r\n        // FIXME: Why does raycaster.intersectObjects on terrain return 0-ish even when above terrain?\r\n        if (terrainHeight <= 1) {\r\n            return;\r\n        }\r\n\r\n        if (this.state.firstPerson) {\r\n            const delta = (terrainHeight + this.personHeight) - this.props.sceneContext.scene.view.camera.position.z;\r\n            this.props.sceneContext.scene.view.camera.position.z += delta;\r\n            this.props.sceneContext.scene.view.controls.target.z += delta;\r\n            return;\r\n        }\r\n        const cameraHeight = this.props.sceneContext.scene.view.camera.position.z;\r\n        // If camera height is at terrain height, target height should be at terrain height\r\n        // If camera height is at twice the terrain height or further, target height should be zero\r\n        const targetHeight = terrainHeight > 0 ? terrainHeight * Math.max(0, 1 - (cameraHeight - terrainHeight) / terrainHeight) : 0;\r\n        this.props.sceneContext.scene.view.controls.target.z = targetHeight;\r\n    };\r\n    stopAnimations = () => {\r\n        this.animationInterrupted = true;\r\n    };\r\n    switchToFirstPersonView = (ev) => {\r\n        if (!this.state.firstPerson) {\r\n            this.setupFirstPerson(ev);\r\n        }\r\n    };\r\n    toggleFirstPersonControls = () => {\r\n        if (this.state.firstPerson) {\r\n            this.leaveFirstPerson();\r\n        } else {\r\n            this.props.sceneContext.scene.domElement.addEventListener('click', this.setupFirstPerson, {once: true});\r\n        }\r\n    };\r\n    setupFirstPerson = (ev) => {\r\n        const rect = ev.target.getBoundingClientRect();\r\n        const mouseX = ((ev.clientX - rect.left) / rect.width) * 2 - 1;\r\n        const mouseY = -((ev.clientY - rect.top) / rect.height) * 2 + 1;\r\n        const intersection = this.props.sceneContext.getSceneIntersection(mouseX, mouseY, false);\r\n        if (!intersection) {\r\n            return;\r\n        }\r\n        const pos = intersection.point;\r\n        this.props.sceneContext.getTerrainHeight([pos.x, pos.y]).then(z => {\r\n            // Animate from old to new position/target\r\n            const oldPosition = this.props.sceneContext.scene.view.camera.position.clone();\r\n            const oldTarget = this.props.sceneContext.scene.view.controls.target.clone();\r\n            const newPosition = new Vector3(pos.x, pos.y, z + this.personHeight);\r\n            const newTarget = new Vector3(pos.x, pos.y + 300, z + this.personHeight);\r\n            const startTime = new Date() / 1000;\r\n\r\n            this.animationInterrupted = false;\r\n            const animate = () => {\r\n                if (!this.props.sceneContext.scene || this.animationInterrupted) {\r\n                    return;\r\n                }\r\n                const duration = 2;\r\n                const elapsed = new Date() / 1000 - startTime;\r\n                const x = elapsed / duration;\r\n                const k =  0.5 * (1 - Math.cos(x * Math.PI));\r\n\r\n                const currentPosition = new Vector3().lerpVectors(oldPosition, newPosition, k);\r\n                const currentTarget = new Vector3().lerpVectors(oldTarget, newTarget, k);\r\n                this.props.sceneContext.scene.view.camera.position.copy(currentPosition);\r\n                this.props.sceneContext.scene.view.controls.target.copy(currentTarget);\r\n                this.props.sceneContext.scene.notifyChange();\r\n\r\n                if (elapsed < duration) {\r\n                    requestAnimationFrame(animate);\r\n                } else {\r\n                    this.props.sceneContext.scene.view.camera.position.copy(newPosition);\r\n                    this.props.sceneContext.scene.view.controls.target.set(pos.x, pos.y + 0.1, z + this.personHeight);\r\n                    this.props.sceneContext.scene.notifyChange();\r\n\r\n                    this.controls.maxPolarAngle = 0.8 * Math.PI;\r\n                    this.controls.panSpeed = 600;\r\n                    this.controls.enableZoom = false;\r\n                    this.setState({firstPerson: true});\r\n                }\r\n            };\r\n            requestAnimationFrame(animate);\r\n        });\r\n    };\r\n    leaveFirstPerson = () => {\r\n        this.controls.maxPolarAngle = Math.PI * 0.5;\r\n        this.controls.panSpeed = 1;\r\n        this.controls.enableZoom = true;\r\n\r\n        this.setState({firstPerson: false}, () => {\r\n            const cameraPos = this.props.sceneContext.scene.view.camera.position;\r\n            const bounds = [cameraPos.x - 1000, cameraPos.y - 1000, cameraPos.x + 1000, cameraPos.y + 1000];\r\n            this.setViewToExtent(bounds);\r\n        });\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./MapExport3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./MapExport3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport axios from 'axios';\r\nimport FileSaver from 'file-saver';\r\nimport formDataEntries from 'formdata-json';\r\nimport isEmpty from 'lodash.isempty';\r\nimport PropTypes from 'prop-types';\r\nimport utif from 'utif';\r\n\r\nimport {setCurrentTask} from '../../actions/task';\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport MiscUtils from '../../utils/MiscUtils';\r\nimport Icon from '../Icon';\r\nimport SideBar from '../SideBar';\r\nimport Spinner from '../widgets/Spinner';\r\n\r\nimport './../../plugins/style/MapExport.css';\r\nimport './style/MapExport3D.css';\r\n\r\n\r\nclass MapExport3D extends React.Component {\r\n    static propTypes = {\r\n        hideAutopopulatedFields: PropTypes.bool,\r\n        sceneContext: PropTypes.object,\r\n        setCurrentTask: PropTypes.func,\r\n        theme: PropTypes.object\r\n    };\r\n    state = {\r\n        minimized: false,\r\n        selectedFormat: 'image/jpeg',\r\n        layout: \"\",\r\n        x: 0,\r\n        y: 0,\r\n        width: 0,\r\n        height: 0,\r\n        exporting: false\r\n    };\r\n    onShow = () => {\r\n        if (!isEmpty(this.props.theme?.print)) {\r\n            const layouts = this.props.theme.print.filter(l => l.map).sort((a, b) => {\r\n                return a.name.localeCompare(b.name, undefined, {numeric: true});\r\n            });\r\n            const layout = layouts.find(l => l.default) || layouts[0];\r\n            this.setState({layout: layout});\r\n        }\r\n    };\r\n    formatChanged = (ev) => {\r\n        this.setState({selectedFormat: ev.target.value});\r\n    };\r\n    layoutChanged = (ev) => {\r\n        const layout = this.props.theme.print.find(item => item.name === ev.target.value);\r\n        this.setState({layout: layout});\r\n    };\r\n    renderBody = () => {\r\n        const formatMap = {\r\n            \"image/jpeg\": \"JPEG\",\r\n            \"image/png\": \"PNG\",\r\n            \"image/tiff\": \"TIFF\",\r\n            \"application/pdf\": \"PDF\"\r\n        };\r\n        const layouts = this.props.theme.print.filter(l => l.map).sort((a, b) => {\r\n            return a.name.localeCompare(b.name, undefined, {numeric: true});\r\n        });\r\n        const exportDisabled = this.state.exporting || this.state.width === 0 || (\r\n            this.state.selectedFormat === \"application/pdf\" && !this.state.layout\r\n        );\r\n        const mapName = this.state.layout?.map?.name || \"\";\r\n        return (\r\n            <div className=\"mapexport-body\">\r\n                <form onSubmit={this.export}>\r\n                    <table className=\"options-table\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td>{LocaleUtils.tr(\"mapexport.format\")}</td>\r\n                                <td>\r\n                                    <select name=\"FORMAT\" onChange={this.formatChanged} value={this.state.selectedFormat}>\r\n                                        {Object.entries(formatMap).map(([format, label]) => (\r\n                                            <option key={format} value={format}>{label}</option>\r\n                                        ))}\r\n                                    </select>\r\n                                </td>\r\n                            </tr>\r\n                            {this.state.selectedFormat === 'application/pdf' ? (\r\n                                <tr>\r\n                                    <td>{LocaleUtils.tr(\"print.layout\")}</td>\r\n                                    <td>\r\n                                        <select onChange={this.layoutChanged} value={this.state.layout.name}>\r\n                                            {layouts.map(item => (\r\n                                                <option key={item.name} value={item.name}>{item.name.split('/').pop()}</option>\r\n                                            ))}\r\n                                        </select>\r\n                                    </td>\r\n                                </tr>\r\n                            ) : null}\r\n                            {this.state.selectedFormat === 'application/pdf' ? (this.state.layout?.labels || []).map(label => {\r\n                                // Omit labels which start with __\r\n                                if (label.startsWith(\"__\")) {\r\n                                    return null;\r\n                                }\r\n                                const opts = {\r\n                                    rows: 1,\r\n                                    name: label.toUpperCase(),\r\n                                    ...this.props.theme.printLabelConfig?.[label]\r\n                                };\r\n                                return this.renderPrintLabelField(label, opts);\r\n                            }) : null}\r\n                        </tbody>\r\n                    </table>\r\n                    {this.state.selectedFormat === 'application/pdf' ? (\r\n                        <div>\r\n                            <input name=\"TEMPLATE\" type=\"hidden\" value={this.state.layout?.name || \"\"} />\r\n                            <input name=\"csrf_token\" type=\"hidden\" value={MiscUtils.getCsrfToken()} />\r\n                            <input name={mapName + \":extent\"} readOnly type=\"hidden\" value=\"0,0,0,0\" />\r\n                            <input name=\"SERVICE\" readOnly type=\"hidden\" value=\"WMS\" />\r\n                            <input name=\"VERSION\" readOnly type=\"hidden\" value={this.props.theme.version} />\r\n                            <input name=\"REQUEST\" readOnly type=\"hidden\" value=\"GetPrint\" />\r\n                            <input name=\"TRANSPARENT\" readOnly type=\"hidden\" value=\"true\" />\r\n                            <input name=\"SRS\" readOnly type=\"hidden\" value={this.props.theme.mapCrs} />\r\n                            <input name=\"LAYERS\" readOnly type=\"hidden\" value=\"\" />\r\n                            <input name={mapName + \":LAYERS\"} readOnly type=\"hidden\" value={\"\"} />\r\n                        </div>\r\n                    ) : null}\r\n                    <div className=\"button-bar\">\r\n                        <button className=\"button\" disabled={exportDisabled} type=\"submit\">\r\n                            {this.state.exporting ? (\r\n                                <span className=\"mapexport-wait\"><Spinner /> {LocaleUtils.tr(\"mapexport.wait\")}</span>\r\n                            ) : LocaleUtils.tr(\"mapexport.submit\")}\r\n                        </button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n        );\r\n    };\r\n    renderExportFrame = () => {\r\n        const boxStyle = {\r\n            left: this.state.x + 'px',\r\n            top: this.state.y + 'px',\r\n            width: this.state.width + 'px',\r\n            height: this.state.height + 'px'\r\n        };\r\n        return (\r\n            <div className=\"mapexport3d-event-container\" onPointerDown={this.startSelection}>\r\n                <div className=\"mapexport3d-frame\" style={boxStyle}>\r\n                    <span className=\"mapexport3d-frame-label\">\r\n                        {this.state.width + \" x \" + this.state.height}\r\n                    </span>\r\n                </div>\r\n            </div>\r\n        );\r\n    };\r\n    render() {\r\n        const minMaxTooltip = this.state.minimized ? LocaleUtils.tr(\"print.maximize\") : LocaleUtils.tr(\"print.minimize\");\r\n        const minMaxIcon = this.state.minimized ? 'chevron-down' : 'chevron-up';\r\n        const extraTitlebarContent = (\r\n            <Icon className=\"mapexport-minimize-maximize\" icon={minMaxIcon} onClick={() => this.setState((state) => ({minimized: !state.minimized}))} title={minMaxTooltip}/>\r\n        );\r\n        return (\r\n            <SideBar extraClasses=\"MapExport\" extraTitlebarContent={extraTitlebarContent} icon={\"rasterexport\"}\r\n                id=\"MapExport3D\" onShow={this.onShow} title={LocaleUtils.tr(\"appmenu.items.MapExport3D\")} width=\"20em\"\r\n            >\r\n                {() => ({\r\n                    body: this.renderBody(),\r\n                    extra: this.renderExportFrame()\r\n                })}\r\n            </SideBar>\r\n        );\r\n    }\r\n    startSelection = (ev) => {\r\n        if (ev.shiftKey) {\r\n            const target = ev.currentTarget;\r\n            const view = ev.view;\r\n            view.addEventListener('pointerup', () => {\r\n                target.style.pointerEvents = '';\r\n                view.document.body.style.userSelect = '';\r\n            }, {once: true});\r\n            // Move behind\r\n            target.style.pointerEvents = 'none';\r\n            view.document.body.style.userSelect = 'none';\r\n            this.props.sceneContext.scene.domElement.dispatchEvent(new PointerEvent('pointerdown', ev));\r\n            return;\r\n        } else if (ev.button === 0) {\r\n            const rect = ev.currentTarget.getBoundingClientRect();\r\n            this.setState({\r\n                x: Math.round(ev.clientX - rect.left),\r\n                y: Math.round(ev.clientY - rect.top),\r\n                width: 0,\r\n                height: 0\r\n            });\r\n            const constrainRatio = this.state.selectedFormat === \"application/pdf\" && this.state.layout;\r\n            const ratio = constrainRatio ? this.state.layout.map.height / this.state.layout.map.width : null;\r\n            const onMouseMove = (event) => {\r\n                this.setState((state) => {\r\n                    const width = Math.round(Math.max(0, Math.round(event.clientX - rect.left) - state.x));\r\n                    const height = constrainRatio ? Math.round(width * ratio) : Math.round(Math.max(0, Math.round(event.clientY - rect.top) - state.y));\r\n                    return {\r\n                        width: width,\r\n                        height: height\r\n                    };\r\n                });\r\n            };\r\n            ev.view.addEventListener('pointermove', onMouseMove);\r\n            ev.view.addEventListener('pointerup', () => {\r\n                ev.view.removeEventListener('pointermove', onMouseMove);\r\n            }, {once: true});\r\n        }\r\n    };\r\n    export = (ev) => {\r\n        ev.preventDefault();\r\n        const form = ev.target;\r\n        this.setState({exporting: true});\r\n        const {x, y, width, height} = this.state;\r\n        if (width > 0 && height > 0) {\r\n            const data = this.props.sceneContext.scene.renderer.domElement.toDataURL('image/png');\r\n            const canvas = document.createElement(\"canvas\");\r\n            const ctx = canvas.getContext(\"2d\");\r\n            const img = new Image();\r\n            img.src = data;\r\n            img.onload = () => {\r\n                canvas.width = width;\r\n                canvas.height = height;\r\n                ctx.drawImage(img, -x, -y);\r\n                if (this.state.selectedFormat === \"application/pdf\") {\r\n                    canvas.toBlob((blob) => {\r\n                        blob.arrayBuffer().then(imgBuffer => this.exportToPdf(form, imgBuffer));\r\n                    }, \"image/png\");\r\n                } else if (this.state.selectedFormat === \"image/tiff\") {\r\n                    const imageData = ctx.getImageData(0, 0, width, height);\r\n                    const blob = new Blob([utif.encodeImage(imageData.data, width, height)], { type: \"image/tiff\" });\r\n                    FileSaver.saveAs(blob, \"export.\" + this.state.selectedFormat.replace(/.*\\//, ''));\r\n                    this.setState({exporting: false});\r\n                } else {\r\n                    canvas.toBlob((blob) => {\r\n                        FileSaver.saveAs(blob, \"export.\" + this.state.selectedFormat.replace(/.*\\//, ''));\r\n                        this.setState({exporting: false});\r\n                    }, this.state.selectedFormat);\r\n                }\r\n            };\r\n        }\r\n    };\r\n    async exportToPdf(form, imgBuffer) {\r\n        const formData = {\r\n            ...formDataEntries(new FormData(form)),\r\n            ...Object.fromEntries((this.props.theme.extraPrintParameters || \"\").split(\"&\").filter(Boolean).map(entry => entry.split(\"=\")))\r\n        };\r\n        const data = Object.entries(formData).map((pair) =>\r\n            pair.map(entry => encodeURIComponent(entry).replace(/%20/g, '+')).join(\"=\")\r\n        ).join(\"&\");\r\n        const config = {\r\n            headers: {'Content-Type': 'application/x-www-form-urlencoded'},\r\n            responseType: \"arraybuffer\"\r\n        };\r\n        const response = await axios.post(this.props.theme.printUrl, data, config);\r\n        if (response) {\r\n            const {PDFDocument} = await import('pdf-lib');\r\n            const doc = await PDFDocument.load(response.data);\r\n            const page = doc.getPages()[0];\r\n            const pngImage = await doc.embedPng(imgBuffer);\r\n            const x = this.state.layout.map.x * 2.8346;\r\n            const y = this.state.layout.map.y * 2.8346;\r\n            const width = this.state.layout.map.width * 2.8346;\r\n            const height = this.state.layout.map.height * 2.8346;\r\n            page.drawImage(pngImage, {\r\n                x: x,\r\n                y: y,\r\n                width: width,\r\n                height: height\r\n            });\r\n            const pdfData = await doc.save();\r\n            const blob = new Blob([pdfData], { type: 'application/pdf' });\r\n            FileSaver.saveAs(blob, this.state.layout.name + \".pdf\");\r\n            this.setState({exporting: false});\r\n        } else {\r\n            /* eslint-disable-next-line */\r\n            alert('Print failed');\r\n            this.setState({exporting: false});\r\n        }\r\n    };\r\n    renderPrintLabelField = (label, opts) => {\r\n        let defaultValue = opts.defaultValue || \"\";\r\n        let autopopulated = false;\r\n        if (label === this.props.theme.printLabelForSearchResult) {\r\n            defaultValue = this.getSearchMarkerLabel();\r\n            autopopulated = true;\r\n        } else if (label === this.props.theme.printLabelForAttribution) {\r\n            defaultValue = this.getAttributionLabel();\r\n            autopopulated = true;\r\n        }\r\n        if (autopopulated && this.props.hideAutopopulatedFields) {\r\n            return (<tr key={\"label.\" + label}><td colSpan=\"2\"><input defaultValue={defaultValue} name={opts.name} type=\"hidden\" /></td></tr>);\r\n        } else {\r\n            if (opts.options) {\r\n                return (\r\n                    <tr key={\"label.\" + label}>\r\n                        <td>{MiscUtils.capitalizeFirst(label)}</td>\r\n                        <td>\r\n                            <select defaultValue={defaultValue} name={opts.name}>\r\n                                {opts.options.map(value => (<option key={value} value={value}>{value}</option>))}\r\n                            </select>\r\n                        </td>\r\n                    </tr>\r\n                );\r\n            } else {\r\n                const style = {};\r\n                if (opts.rows || opts.cols) {\r\n                    style.resize = 'none';\r\n                }\r\n                if (opts.cols) {\r\n                    style.width = 'initial';\r\n                }\r\n                return (\r\n                    <tr key={\"label.\" + label}>\r\n                        <td>{MiscUtils.capitalizeFirst(label)}</td>\r\n                        <td><textarea {...opts} defaultValue={defaultValue} readOnly={autopopulated} style={style} /></td>\r\n                    </tr>\r\n                );\r\n            }\r\n        }\r\n    };\r\n    getSearchMarkerLabel = () => {\r\n        // TODO\r\n        return \"\";\r\n    };\r\n    getAttributionLabel = () => {\r\n        // TODO\r\n        return \"\";\r\n    };\r\n}\r\n\r\nexport default connect((state) => ({\r\n}), {\r\n    setCurrentTask: setCurrentTask\r\n})(MapExport3D);\r\n","/**\r\n * Copyright 2017-2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport {Line} from \"react-chartjs-2\";\r\nimport ReactDOM from 'react-dom';\r\n\r\nimport Shape from '@giro3d/giro3d/entities/Shape.js';\r\nimport {\r\n    Chart as ChartJS,\r\n    CategoryScale,\r\n    LinearScale,\r\n    PointElement,\r\n    LineElement,\r\n    Title,\r\n    Tooltip,\r\n    Filler\r\n} from 'chart.js';\r\nimport FileSaver from 'file-saver';\r\nimport PropTypes from 'prop-types';\r\nimport {Vector3} from 'three';\r\n\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport MeasureUtils from '../../utils/MeasureUtils';\r\nimport MiscUtils from '../../utils/MiscUtils';\r\nimport ResizeableWindow from '../ResizeableWindow';\r\n\r\nimport '../../plugins/style/HeightProfile.css';\r\n\r\nChartJS.register(\r\n    CategoryScale,\r\n    LinearScale,\r\n    PointElement,\r\n    LineElement,\r\n    Title,\r\n    Tooltip,\r\n    Filler\r\n);\r\n\r\nclass HeightProfilePrintDialog extends React.PureComponent {\r\n    static propTypes = {\r\n        children: PropTypes.func,\r\n        onClose: PropTypes.func,\r\n        sceneContext: PropTypes.object,\r\n        templatePath: PropTypes.string\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.externalWindow = null;\r\n        this.chart = null;\r\n        this.portalEl = null;\r\n        this.imageEl = null;\r\n    }\r\n    state = {\r\n        initialized: false,\r\n        imageUrl: ''\r\n    };\r\n    componentDidMount() {\r\n        const templatePath = MiscUtils.resolveAssetsPath(this.props.templatePath);\r\n        this.externalWindow = window.open(templatePath, LocaleUtils.tr(\"heightprofile.title\"), \"toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes\");\r\n        this.externalWindow.addEventListener('load', this.setWindowContent, false);\r\n        this.externalWindow.addEventListener('resize', this.windowResized, false);\r\n        window.addEventListener('beforeunload', this.closePrintWindow);\r\n        this.props.sceneContext.scene.view.controls.addEventListener('change', this.scheduleRefreshImage);\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if ((this.state.initialized && !prevState.initialized)) {\r\n            this.refreshImage();\r\n        }\r\n    }\r\n    componentWillUnmount() {\r\n        this.closePrintWindow();\r\n        window.removeEventListener('beforeunload', this.closePrintWindow);\r\n        this.props.sceneContext.scene.view.controls.removeEventListener('change', this.scheduleRefreshImage);\r\n    }\r\n    closePrintWindow = () => {\r\n        this.externalWindow.close();\r\n    };\r\n    setWindowContent = () => {\r\n        this.externalWindow.addEventListener('beforeunload', this.props.onClose, false);\r\n        const container = this.externalWindow.document.getElementById(\"heightprofilecontainer\");\r\n        if (container) {\r\n            const printBtn = this.externalWindow.document.createElement('div');\r\n            printBtn.id = \"print\";\r\n            printBtn.style.marginBottom = \"1em\";\r\n            printBtn.innerHTML = '<style type=\"text/css\">@media print{ #print { display: none; }}</style>' +\r\n                '<button onClick=\"(function(){window.print();})()\">' + LocaleUtils.tr(\"heightprofile.print\") + '</button>';\r\n            container.appendChild(printBtn);\r\n\r\n            this.imageEl = this.externalWindow.document.createElement('div');\r\n            this.imageEl.innerHTML = LocaleUtils.tr(\"heightprofile.loadingimage\");\r\n            container.appendChild(this.imageEl);\r\n\r\n            this.portalEl = this.externalWindow.document.createElement('div');\r\n            this.portalEl.id = 'profile';\r\n            container.appendChild(this.portalEl);\r\n\r\n            this.setState({initialized: true});\r\n            this.externalWindow.document.body.style.overflowX = 'hidden';\r\n        } else {\r\n            this.externalWindow.document.body.innerHTML = \"Broken template. An element with id=heightprofilecontainer must exist.\";\r\n        }\r\n    };\r\n    scheduleRefreshImage = () => {\r\n        clearTimeout(this.refreshTimeout);\r\n        this.refreshTimeout = setTimeout(this.refreshImage, 500);\r\n    };\r\n    refreshImage = () => {\r\n        const src = this.props.sceneContext.scene.renderer.domElement.toDataURL('image/png');\r\n        const width = this.props.sceneContext.scene.renderer.domElement.offsetWidth;\r\n        this.imageEl.innerHTML = `<img src=\"${src}\" style=\"width: 100%; max-width: ${width}px\" />`;\r\n    };\r\n    windowResized = () => {\r\n        if (this.chart) {\r\n            this.chart.resize();\r\n        }\r\n    };\r\n    render() {\r\n        if (!this.state.initialized) {\r\n            return null;\r\n        }\r\n        return ReactDOM.createPortal(this.props.children(el => {this.chart = el;}, false), this.portalEl);\r\n    }\r\n}\r\n\r\n\r\nexport default class HeightProfile extends React.Component {\r\n    static propTypes = {\r\n        data: PropTypes.array,\r\n        /** The height of the height profile widget in pixels. */\r\n        height: PropTypes.number,\r\n        /** The precision of displayed and exported values (0: no decimals, 1: 1 decimal position, etc). */\r\n        heightProfilePrecision: PropTypes.number,\r\n        sceneContext: PropTypes.object,\r\n        /** Template location for the height profile print functionality */\r\n        templatePath: PropTypes.string\r\n    };\r\n    static defaultProps = {\r\n        heightProfilePrecision: 0,\r\n        height: 150,\r\n        templatePath: \":/templates/heightprofileprint.html\"\r\n    };\r\n    state = {\r\n        printdialog: false,\r\n        visible: true\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.chart = null;\r\n        this.profilePrintWindow = null;\r\n    }\r\n    componentDidMount() {\r\n        this.marker = new Shape({\r\n            showVertexLabels: true,\r\n            showLine: false,\r\n            showVertices: true,\r\n            vertexLabelFormatter: ({position}) => MeasureUtils.formatMeasurement(position.z, false, 'm')\r\n        });\r\n        this.marker.visible = false;\r\n        this.props.sceneContext.scene.add(this.marker);\r\n    }\r\n    componentWillUnmount() {\r\n        this.props.sceneContext.scene.remove(this.marker);\r\n    }\r\n    componentDidUpdate(prevProps) {\r\n        if (this.props.data !== prevProps.data) {\r\n            this.setState({visible: true});\r\n        }\r\n    }\r\n    onClose = () => {\r\n        this.setState({visible: false, printdialog: false});\r\n        this.marker.visible = false;\r\n    };\r\n    render() {\r\n        if (!this.state.visible) {\r\n            return null;\r\n        }\r\n        const extraControls = [\r\n            {icon: 'export', callback: this.exportProfile, title: LocaleUtils.tr(\"heightprofile.export\")},\r\n            {icon: 'print', active: this.state.printdialog, callback: () => this.setState(state => ({printdialog: !state.printdialog})), title: LocaleUtils.tr(\"heightprofile.print\")}\r\n        ];\r\n        return [(\r\n            <ResizeableWindow\r\n                dockable=\"bottom\" extraControls={extraControls} icon=\"line\"\r\n                initialHeight={this.props.height} initialWidth={600} initiallyDocked\r\n                key=\"ProfileDialog\" onClose={this.onClose} onExternalWindowResized={this.resizeChart}\r\n                splitScreenWhenDocked\r\n                title={LocaleUtils.tr(\"heightprofile.title\")} usePortal={false}\r\n            >\r\n                {this.renderHeightProfile((el) => { this.chart = el; }, true)}\r\n            </ResizeableWindow>\r\n        ),\r\n        this.state.printdialog ? (\r\n            <HeightProfilePrintDialog key=\"ProfilePrintDialog\" onClose={() => this.setState({printdialog: false})} sceneContext={this.props.sceneContext} templatePath={this.props.templatePath}>\r\n                {this.renderHeightProfile}\r\n            </HeightProfilePrintDialog>\r\n        ) : null];\r\n    }\r\n    renderHeightProfile = (saveRef, interactive) => {\r\n        const distanceStr = LocaleUtils.tr(\"heightprofile.distance\");\r\n        const heightStr = LocaleUtils.tr(\"heightprofile.height\");\r\n        const aslStr = LocaleUtils.tr(\"heightprofile.asl\");\r\n\r\n        const data = {\r\n            labels: this.props.data.map(entry => entry[3]),\r\n            datasets: [\r\n                {\r\n                    data: this.props.data.map(entry => entry[2]),\r\n                    fill: true,\r\n                    backgroundColor: \"rgba(255,0,0,0.5)\",\r\n                    borderColor: \"rgb(255,0,0)\",\r\n                    borderWidth: 2,\r\n                    pointRadius: 0,\r\n                    order: 1\r\n                }\r\n            ]\r\n        };\r\n        // Approx 10 ticks\r\n        const totLength = this.props.data[this.props.data.length - 1][3];\r\n        const maxHeight = Math.max(...this.props.data.map(x => x[2]));\r\n        const stepSizeFact = Math.pow(10, Math.ceil(Math.log10(totLength / 10)));\r\n        const stepSize = Math.round(totLength / (stepSizeFact)) * stepSizeFact / 10;\r\n        const prec = this.props.heightProfilePrecision;\r\n        const options = {\r\n            responsive: true,\r\n            maintainAspectRatio: false,\r\n            animation: {\r\n                duration: 0\r\n            },\r\n            plugins: {\r\n                legend: {\r\n                    display: false\r\n                },\r\n                tooltip: {\r\n                    enabled: interactive,\r\n                    intersect: false,\r\n                    displayColors: false,\r\n                    bodyFont: {weight: 'bold'},\r\n                    callbacks: {\r\n                        title: (ctx) => (distanceStr + \": \" + MeasureUtils.formatMeasurement(ctx[0].parsed.x, false, 'metric')),\r\n                        label: (ctx) => (heightStr + \": \" + MeasureUtils.formatMeasurement(ctx.parsed.y, false, 'm') + \" \" + aslStr)\r\n                    }\r\n                }\r\n            },\r\n            scales: {\r\n                x: {\r\n                    type: 'linear',\r\n                    ticks: {\r\n                        stepSize: stepSize,\r\n                        font: {size: 10},\r\n                        callback: (value) => value\r\n                    },\r\n                    title: {\r\n                        display: true,\r\n                        text: distanceStr + \" [m]\",\r\n                        padding: 0\r\n                    },\r\n                    max: Math.ceil(totLength)\r\n                },\r\n                y: {\r\n                    ticks: {\r\n                        font: {size: 10},\r\n                        callback: (value) => value.toFixed(prec)\r\n                    },\r\n                    title: {\r\n                        display: true,\r\n                        text: heightStr + \" [m \" + aslStr + \"]\"\r\n                    },\r\n                    max: Math.ceil(maxHeight)\r\n                }\r\n            },\r\n            onHover: interactive ? (evt, activeEls, chart) => {\r\n                const chartArea = chart.chartArea;\r\n                const chartX = Math.min(Math.max(evt.x - chartArea.left), chartArea.width);\r\n                this.updateMarker(chartX / chartArea.width * totLength);\r\n            } : undefined\r\n        };\r\n\r\n        return (\r\n            <div className=\"height-profile-chart-container\" onMouseLeave={this.hideMarker} role=\"body\" style={{position: 'relative'}}>\r\n                <Line data={data} options={options} ref={saveRef} />\r\n            </div>\r\n        );\r\n    };\r\n    resizeChart = () => {\r\n        if (this.chart) {\r\n            this.chart.resize();\r\n        }\r\n    };\r\n    updateMarker = (dist) => {\r\n        const data = this.props.data;\r\n        const i = data.findIndex(x => x[3] >= dist);\r\n        if (i === 0) {\r\n            this.marker.setPoints([new Vector3(...data[0])]);\r\n        } else {\r\n            const lambda = (dist - data[i - 1][3]) / (data[i][3] - data[i - 1][3]);\r\n            const p = new Vector3(\r\n                data[i - 1][0] + lambda * (data[i][0] - data[i][0]),\r\n                data[i - 1][1] + lambda * (data[i][1] - data[i][1]),\r\n                data[i - 1][2] + lambda * (data[i][2] - data[i][2])\r\n            );\r\n            this.marker.setPoints([p]);\r\n        }\r\n        this.marker.visible = true;\r\n    };\r\n    hideMarker = () => {\r\n        this.marker.visible = false;\r\n    };\r\n    exportProfile = () => {\r\n        let csv = \"\";\r\n        csv += \"index\" + \"\\t\" + \"distance\" + \"\\t\" + \"elevation\" + \"\\n\";\r\n        this.props.data.forEach((entry, idx) => {\r\n            const sample = {x: entry[3], y: entry[2]};\r\n            const prec = this.props.heightProfilePrecision;\r\n            const distance = Math.round(sample.x * Math.pow(10, prec)) / Math.pow(10, prec);\r\n            const height = Math.round(sample.y * Math.pow(10, prec)) / Math.pow(10, prec);\r\n            csv += String(idx).replace('\"', '\"\"') + \"\\t\"\r\n                + String(distance) + \"\\t\"\r\n                + String(height) + \"\\n\";\r\n        });\r\n        FileSaver.saveAs(new Blob([csv], {type: \"text/plain;charset=utf-8\"}), \"heightprofile.csv\");\r\n    };\r\n}\r\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport Coordinates from '@giro3d/giro3d/core/geographic/Coordinates';\r\nimport ColorLayer from '@giro3d/giro3d/core/layer/ColorLayer';\r\nimport Shape from '@giro3d/giro3d/entities/Shape';\r\nimport DrawTool, {conditions} from \"@giro3d/giro3d/interactions/DrawTool.js\";\r\nimport VectorSource from '@giro3d/giro3d/sources/VectorSource';\r\nimport ol from 'openlayers';\r\nimport pointInPolygon from 'point-in-polygon';\r\nimport PropTypes from 'prop-types';\r\nimport {CurvePath, LineCurve, Vector2, Vector3} from 'three';\r\n\r\nimport ConfigUtils from '../../utils/ConfigUtils';\r\nimport CoordinatesUtils from '../../utils/CoordinatesUtils';\r\nimport LocaleUtils from '../../utils/LocaleUtils';\r\nimport MeasureUtils from '../../utils/MeasureUtils';\r\nimport TaskBar from '../TaskBar';\r\nimport ButtonBar from '../widgets/ButtonBar';\r\nimport CopyButton from '../widgets/CopyButton';\r\nimport HeightProfile3D from './HeightProfile3D';\r\n\r\nimport '../../plugins/style/Measure.css';\r\n\r\n\r\nexport default class Measure3D extends React.Component {\r\n    static propTypes = {\r\n        maxSampleCount: PropTypes.number,\r\n        minMeasureLength: PropTypes.number,\r\n        sceneContext: PropTypes.object\r\n    };\r\n    static defaultProps = {\r\n        maxSampleCount: 500,\r\n        minMeasureLength: 5\r\n    };\r\n    state = {\r\n        mode: null,\r\n        result: null,\r\n        lenUnit: 'metric',\r\n        areaUnit: 'metric',\r\n        elevUnit: 'absolute'\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.measureTool = null;\r\n        this.measurementObjects = [];\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.state.mode !== prevState.mode) {\r\n            this.clearResult();\r\n            this.restart();\r\n        }\r\n        if (this.state.elevUnit !== prevState.elevUnit) {\r\n            // Re-render height label\r\n            this.measurementObjects[0].rebuildLabels();\r\n            this.props.sceneContext.scene.notifyChange();\r\n        }\r\n    }\r\n    onShow = (mode) => {\r\n        this.setState({mode: mode ?? 'Point'});\r\n        this.abortController = new AbortController();\r\n        this.measureTool = new DrawTool({\r\n            instance: this.props.sceneContext.scene\r\n        });\r\n        this.drawLayer = new ColorLayer({\r\n            source: new VectorSource({\r\n                data: [],\r\n                format: new ol.format.GeoJSON(),\r\n                style: this.featureStyleFunction\r\n            })\r\n        });\r\n        this.props.sceneContext.map.addLayer(this.drawLayer);\r\n    };\r\n    onHide = () => {\r\n        this.clearResult();\r\n        this.setState({mode: null});\r\n        this.abortController.abort();\r\n        this.abortController = null;\r\n        this.measureTool.dispose();\r\n        this.measureTool = null;\r\n        this.props.sceneContext.map.removeLayer(this.drawLayer, {dispose: true});\r\n    };\r\n    renderModeSwitcher = () => {\r\n        const buttons = [\r\n            {key: \"Point\", label: LocaleUtils.tr(\"measureComponent.pointLabel\")},\r\n            {key: \"LineString\", label: LocaleUtils.tr(\"measureComponent.lengthLabel\")},\r\n            {key: \"Polygon\", label: LocaleUtils.tr(\"measureComponent.areaLabel\")}\r\n        ];\r\n        return (\r\n            <ButtonBar active={this.state.mode} buttons={buttons} onClick={mode => this.setState({mode, result: null})} />\r\n        );\r\n    };\r\n    renderResult = () => {\r\n        if (!this.state.result) {\r\n            return null;\r\n        }\r\n        let text = \"\";\r\n        let unitSelector = null;\r\n\r\n        if (this.state.mode === \"Point\") {\r\n            text = CoordinatesUtils.getFormattedCoordinate(this.state.result.pos.slice(0, 2), this.props.sceneContext.mapCrs);\r\n            const prec = ConfigUtils.getConfigProp(\"measurementPrecision\");\r\n            text += \", \" + (this.state.result.ground > 0 && this.state.elevUnit === 'ground' ? this.state.result.ground : this.state.result.pos[2]).toFixed(prec);\r\n            if (this.state.result.ground > 0) {\r\n                unitSelector = (\r\n                    <select onChange={ev => this.setState({elevUnit: ev.target.value})} value={this.state.elevUnit}>\r\n                        <option value=\"ground\">{LocaleUtils.tr(\"measureComponent.ground\")}</option>\r\n                        <option value=\"absolute\">{LocaleUtils.tr(\"measureComponent.absolute\")}</option>\r\n                    </select>\r\n                );\r\n            } else {\r\n                unitSelector = (\r\n                    <span className=\"measure-unit-label\">{LocaleUtils.tr(\"measureComponent.absolute\")}</span>\r\n                );\r\n            }\r\n        } else if (this.state.mode === \"LineString\") {\r\n            text = MeasureUtils.formatMeasurement(this.state.result.length, false, this.state.lenUnit);\r\n            unitSelector = (\r\n                <select onChange={ev => this.setState({lenUnit: ev.target.value})} value={this.state.lenUnit}>\r\n                    <option value=\"metric\">{LocaleUtils.tr(\"measureComponent.metric\")}</option>\r\n                    <option value=\"imperial\">{LocaleUtils.tr(\"measureComponent.imperial\")}</option>\r\n                    <option value=\"m\">m</option>\r\n                    <option value=\"km\">km</option>\r\n                    <option value=\"ft\">ft</option>\r\n                    <option value=\"mi\">mi</option>\r\n                </select>\r\n            );\r\n        } else if (this.state.mode === \"Polygon\") {\r\n            text = MeasureUtils.formatMeasurement(this.state.result, true, this.state.areaUnit);\r\n            unitSelector = (\r\n                <select onChange={ev => this.setState({areaUnit: ev.target.value})} value={this.state.areaUnit}>\r\n                    <option value=\"metric\">{LocaleUtils.tr(\"measureComponent.metric\")}</option>\r\n                    <option value=\"imperial\">{LocaleUtils.tr(\"measureComponent.imperial\")}</option>\r\n                    <option value=\"sqm\">m&#178;</option>\r\n                    <option value=\"ha\">ha</option>\r\n                    <option value=\"sqkm\">km&#178;</option>\r\n                    <option value=\"sqft\">ft&#178;</option>\r\n                    <option value=\"acre\">acre</option>\r\n                    <option value=\"sqmi\">mi&#178;</option>\r\n                </select>\r\n            );\r\n        }\r\n        return (\r\n            <div className=\"controlgroup\">\r\n                <input className=\"measure-result\" readOnly type=\"text\" value={text} />\r\n                {unitSelector}\r\n                <CopyButton text={text} />\r\n            </div>\r\n        );\r\n    };\r\n    render() {\r\n        return [\r\n            (\r\n                <TaskBar key=\"TaskBar\" onHide={this.onHide} onShow={this.onShow} task=\"Measure3D\">\r\n                    {() => ({\r\n                        body: (\r\n                            <div>\r\n                                {this.renderModeSwitcher()}\r\n                                {this.renderResult()}\r\n                            </div>\r\n                        )\r\n                    })}\r\n                </TaskBar>\r\n            ),\r\n            this.state.result?.profile ? (\r\n                <HeightProfile3D data={this.state.result.profile} key=\"HeightProfile\" sceneContext={this.props.sceneContext} />\r\n            ) : null\r\n        ];\r\n    }\r\n    featureStyleFunction = () => {\r\n        return [\r\n            new ol.style.Style({\r\n                fill: new ol.style.Fill({\r\n                    color: [41, 120, 180, 0.5]\r\n                })\r\n            }),\r\n            new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: [255, 255, 255],\r\n                    width: 4\r\n                })\r\n            }),\r\n            new ol.style.Style({\r\n                stroke: new ol.style.Stroke({\r\n                    color: [41, 120, 180],\r\n                    width: 1.5\r\n                })\r\n            })\r\n        ];\r\n    };\r\n    clearResult = () => {\r\n        this.drawLayer.source.clear();\r\n        this.measurementObjects.forEach(object => {\r\n            this.props.sceneContext.scene.remove(object);\r\n        });\r\n        this.measurementObjects = [];\r\n        this.setState({result: null});\r\n    };\r\n    restart = () => {\r\n        if (this.abortController) {\r\n            this.abortController.abort();\r\n        }\r\n        this.abortController = new AbortController();\r\n        const options = {\r\n            signal: this.abortController.signal,\r\n            endCondition: conditions.doubleClick\r\n        };\r\n        if (this.state.mode === 'Point') {\r\n            this.measureTool.createPoint(options).then(this.measurePoint);\r\n        } else if (this.state.mode === 'LineString') {\r\n            this.measureTool.createLineString(options).then(this.measureLine);\r\n        } else if (this.state.mode === 'Polygon') {\r\n            this.measureTool.createPolygon(options).then(this.measureArea);\r\n        } else if (this.state.mode === 'Height') {\r\n            this.measureTool.createVerticalMeasure(options).then(this.measureHeight);\r\n        }\r\n    };\r\n    measurePoint = (point) => {\r\n        if (point === null) {\r\n            this.restart();\r\n            return;\r\n        }\r\n        this.clearResult();\r\n        const pos = point.points[0];\r\n\r\n        // Measure point above terrain\r\n        const elevation = this.getElevation([pos.x, pos.y]);\r\n        const ground = pos.z - elevation > 0.3 ? pos.z - elevation : 0;\r\n\r\n        const elevationLabelFormatter = (options) => {\r\n            if (options.index === 0) {\r\n                return MeasureUtils.formatMeasurement(elevation, false, LocaleUtils.tr(\"measureComponent.absolute\"));\r\n            } else if (ground > 0 && this.state.elevUnit === \"ground\") {\r\n                return MeasureUtils.formatMeasurement(pos.z - elevation, false, LocaleUtils.tr(\"measureComponent.ground\"));\r\n            } else {\r\n                return MeasureUtils.formatMeasurement(pos.z, false, LocaleUtils.tr(\"measureComponent.absolute\"));\r\n            }\r\n        };\r\n        let shape = null;\r\n        if (ground > 0) {\r\n            // Add line\r\n            shape = new Shape({\r\n                showVertexLabels: true,\r\n                showLine: true,\r\n                showVertices: true,\r\n                vertexLabelFormatter: elevationLabelFormatter\r\n            });\r\n            shape.setPoints([new Vector3(pos.x, pos.y, elevation), pos]);\r\n        } else {\r\n            // Add point\r\n            shape = new Shape({\r\n                showVertexLabels: true,\r\n                showLine: false,\r\n                showVertices: true,\r\n                vertexLabelFormatter: elevationLabelFormatter\r\n            });\r\n            shape.setPoints([new Vector3(pos.x, pos.y, pos.z)]);\r\n        }\r\n        this.props.sceneContext.scene.add(shape);\r\n        this.measurementObjects.push(shape);\r\n        this.props.sceneContext.scene.remove(point);\r\n\r\n        this.setState({result: {pos: [pos.x, pos.y, pos.z], ground: ground}});\r\n\r\n        // Setup for next measurement\r\n        this.restart();\r\n    };\r\n    measureLine = (lineString) => {\r\n        if (lineString === null) {\r\n            this.restart();\r\n            return;\r\n        }\r\n        this.clearResult();\r\n        const features = (new ol.format.GeoJSON()).readFeatures(lineString.toGeoJSON(), {\r\n            dataProjection: \"EPSG:4326\",\r\n            featureProjection: this.props.sceneContext.mapCrs\r\n        });\r\n        this.drawLayer.source.addFeatures(features);\r\n        this.props.sceneContext.scene.remove(lineString);\r\n\r\n        // Compute 2d length and nSamples spaced points\r\n        const path = new CurvePath();\r\n        let len2d = 0;\r\n        for (let i = 0; i < lineString.points.length - 1; i++) {\r\n            const v0 = lineString.points[i];\r\n            const v1 = lineString.points[i + 1];\r\n\r\n            const line = new LineCurve(\r\n                new Vector2(v0.x, v0.y),\r\n                new Vector2(v1.x, v1.y),\r\n            );\r\n            path.add(line);\r\n            len2d += Math.sqrt((v1.x - v0.x) * (v1.x - v0.x) + (v1.y - v0.y) * (v1.y - v0.y));\r\n        }\r\n        const nSamples = Math.min(this.props.maxSampleCount, Math.round(len2d / this.props.minMeasureLength));\r\n\r\n        const points = path.getSpacedPoints(nSamples - 1);\r\n        const line3d = new Array(nSamples);\r\n        line3d[0] = [points[0].x, points[0].y, this.getElevation([points[0].x, points[0].y]), 0];\r\n        let len3d = 0;\r\n        for (let i = 1; i < nSamples; ++i) {\r\n            line3d[i] = [points[i].x, points[i].y, this.getElevation([points[i].x, points[i].y]), 0];\r\n            const dx = line3d[i][0] - line3d[i - 1][0];\r\n            const dy = line3d[i][1] - line3d[i - 1][1];\r\n            const dz = line3d[i][2] - line3d[i - 1][2];\r\n            len3d += Math.sqrt(dx * dx + dy * dy + dz * dz);\r\n            line3d[i][3] = len3d; // Also store incremental length for height profie\r\n        }\r\n        this.setState({result: {length: len3d, profile: line3d}});\r\n\r\n        // Setup for next measurement\r\n        this.restart();\r\n    };\r\n    measureArea = (polygon) => {\r\n        if (polygon === null) {\r\n            this.restart();\r\n            return;\r\n        }\r\n        this.clearResult();\r\n\r\n        const features = (new ol.format.GeoJSON()).readFeatures(polygon.toGeoJSON(), {\r\n            dataProjection: \"EPSG:4326\",\r\n            featureProjection: this.props.sceneContext.mapCrs\r\n        });\r\n        this.drawLayer.source.addFeatures(features);\r\n        this.props.sceneContext.scene.remove(polygon);\r\n\r\n        // Compute boundingbox of polygon, divide boundingbox into quads,\r\n        // compute quad area on terrain for each quad in polygon\r\n        const bbox = [\r\n            polygon.points[0].x, polygon.points[0].y,\r\n            polygon.points[0].x, polygon.points[0].y\r\n        ];\r\n        const coordinates = polygon.points.map(v => {\r\n            bbox[0] = Math.min(bbox[0], v.x);\r\n            bbox[1] = Math.min(bbox[1], v.y);\r\n            bbox[2] = Math.max(bbox[2], v.x);\r\n            bbox[3] = Math.max(bbox[3], v.y);\r\n            return [v.x, v.y];\r\n        });\r\n        const quadSize = this.props.minMeasureLength;\r\n        const numX = Math.min(this.props.maxSampleCount, Math.round((bbox[2] - bbox[0]) / quadSize));\r\n        const numY = Math.min(this.props.maxSampleCount, Math.round((bbox[3] - bbox[1]) / quadSize));\r\n        const deltaX = (bbox[2] - bbox[0]) / numX;\r\n        const deltaY = (bbox[3] - bbox[1]) / numY;\r\n        let area = 0;\r\n        const elevationCache = new Array(numX * numY);\r\n        for (let iX = 0; iX < numX - 1; ++iX) {\r\n            for (let iY = 0; iY < numY - 1; ++iY) {\r\n                // If quad center lies in polygon, consider it\r\n                const p = [bbox[0] + iX * deltaX, bbox[1] + iY * deltaY];\r\n                const c = [p[0] + 0.5 * deltaX, p[1] + 0.5 * deltaY];\r\n                if (!pointInPolygon(c, coordinates)) {\r\n                    continue;\r\n                }\r\n                // Get elevations\r\n                const z1 = elevationCache[iY * numX + iX] ?? (elevationCache[iY * numX + iX] = this.getElevation(p));\r\n                const z2 = elevationCache[iY * numX + iX + 1] ?? (elevationCache[iY * numX + iX + 1] = this.getElevation([p[0] + deltaX, p[1]]));\r\n                const z3 = elevationCache[(iY + 1) * numX + iX + 1] ?? (elevationCache[(iY + 1) * numX + iX + 1] = this.getElevation([p[0] + deltaX, p[1] + deltaY]));\r\n                const z4 = elevationCache[(iY + 1) * numX + iX] ?? (elevationCache[(iY + 1) * numX + iX] = this.getElevation([p[0], p[1] + deltaY]));\r\n                // Divide quad along diagonal with smaller elevation difference\r\n                const dz1 = Math.abs(z3 - z1);\r\n                const dz2 = Math.abs(z4 - z2);\r\n                if (dz1 < dz2) {\r\n                    const area1 = this.triangleArea([-deltaX, 0, z1 - z2], [0, deltaY, z3 - z2]);\r\n                    const area2 = this.triangleArea([0, -deltaY, z1 - z4], [deltaX, 0, z3 - z4]);\r\n                    area += area1 + area2;\r\n                } else {\r\n                    const area1 = this.triangleArea([deltaX, 0, z2 - z1], [0, deltaY, z4 - z1]);\r\n                    const area2 = this.triangleArea([-deltaX, 0, z4 - z3], [0, -deltaY, z1 - z3]);\r\n                    area += area1 + area2;\r\n                }\r\n            }\r\n        }\r\n        this.setState({result: area});\r\n\r\n        // Setup for next measurement\r\n        this.restart();\r\n    };\r\n    measureHeight = (lineString) => {\r\n        if (lineString === null) {\r\n            this.restart();\r\n            return;\r\n        }\r\n        this.clearResult();\r\n        this.measurementObjects.push(lineString);\r\n\r\n        // Setup for next measurement\r\n        this.restart();\r\n    };\r\n    getElevation = (point) => {\r\n        const coordinates = new Coordinates(this.props.sceneContext.mapCrs, point[0], point[1], 0);\r\n        const result = this.props.sceneContext.map.getElevation({coordinates});\r\n        if (result.samples.length > 0) {\r\n            result.samples.sort((a, b) => a.resolution - b.resolution);\r\n            return result.samples[0].elevation;\r\n        }\r\n        return null;\r\n    };\r\n    triangleArea = (u, v) => {\r\n        const cross = [u[1] * v[2] - u[2] * v[1], u[0] * v[2] - u[2] * v[0], u[0] * v[1] - u[1] * v[0]];\r\n        return 0.5 * Math.sqrt(cross[0] * cross[0] + cross[1] * cross[1] + cross[2] * cross[2]);\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./OverviewMap3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./OverviewMap3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport ol from 'openlayers';\r\nimport PropTypes from 'prop-types';\r\n\r\nimport OlLayer from '../../components/map/OlLayer';\r\nimport viewconeIcon from './img/viewcone.svg';\r\n\r\nimport './style/OverviewMap3D.css';\r\n\r\n/**\r\n * Overview map support for the map component.\r\n*/\r\nexport default class OverviewMap3D extends React.Component {\r\n    static propTypes = {\r\n        baseLayer: PropTypes.object,\r\n        sceneContext: PropTypes.object\r\n    };\r\n    state = {\r\n        collapsed: true\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.map = null;\r\n        this.viewConeFeature = new ol.Feature(new ol.geom.Point([0, 0]));\r\n        this.viewConeLayer = new ol.layer.Vector({\r\n            source: new ol.source.Vector({\r\n                features: [this.viewConeFeature]\r\n            }),\r\n            style: (feature) => new ol.style.Style({\r\n                fill: new ol.style.Fill({\r\n                    color: 'white'\r\n                }),\r\n                stroke: new ol.style.Stroke({\r\n                    color: 'red',\r\n                    width: 2\r\n                }),\r\n                image: new ol.style.Icon({\r\n                    anchor: [0.5, 1],\r\n                    anchorXUnits: 'fraction',\r\n                    anchorYUnits: 'fraction',\r\n                    src: viewconeIcon,\r\n                    rotation: feature.get('rotation'),\r\n                    scale: 2\r\n                })\r\n            }),\r\n            zIndex: 10000\r\n        });\r\n    }\r\n    componentDidMount() {\r\n        this.props.sceneContext.scene.view.controls.addEventListener('change', this.updateViewCone);\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.sceneContext.mapCrs !== prevProps.sceneContext.mapCrs) {\r\n            this.setupView();\r\n        }\r\n        if (this.map) {\r\n            if (this.state.center !== prevState.center || this.state.azimuth !== prevState.azimuth) {\r\n                this.map.getView().setCenter(this.state.center);\r\n                this.viewConeFeature.getGeometry().setCoordinates(this.state.center);\r\n                this.viewConeFeature.set('rotation', -this.state.azimuth, true);\r\n                this.viewConeLayer.getSource().changed();\r\n            }\r\n            if (this.state.resolution !== prevState.resolution) {\r\n                this.map.getView().setResolution(this.state.resolution);\r\n            }\r\n        }\r\n    }\r\n    initOverviewMap = (el) => {\r\n        if (el) {\r\n            this.map = new ol.Map({\r\n                layers: [this.viewConeLayer],\r\n                controls: [],\r\n                target: el\r\n            });\r\n            this.setupView();\r\n        }\r\n    };\r\n    setupView = () => {\r\n        const overviewView = new ol.View({\r\n            enableRotation: false,\r\n            projection: this.props.sceneContext.mapCrs\r\n        });\r\n        this.map.setView(overviewView);\r\n        this.updateViewCone();\r\n    };\r\n    render() {\r\n        const style = {\r\n            display: this.state.collapsed ? 'none' : 'initial'\r\n        };\r\n        return [\r\n            (\r\n                <div className=\"overview-map-3d\" key=\"map3d-overview-map\">\r\n                    <div className=\"ol-overviewmap-map-3d\" ref={this.initOverviewMap} style={style} />\r\n                    <button onClick={() => this.setState(state => ({collapsed: !state.collapsed}))} type=\"button\">\r\n                        {this.state.collapsed ? '' : ''}\r\n                    </button>\r\n                </div>\r\n            ),\r\n            this.map && this.props.baseLayer ? (\r\n                <OlLayer key={this.props.baseLayer.name} map={this.map} options={this.props.baseLayer} projection={this.props.sceneContext.mapCrs} />\r\n            ) : null\r\n        ];\r\n    }\r\n    updateViewCone = () => {\r\n        if (!this.map) {\r\n            return;\r\n        }\r\n        const scene = this.props.sceneContext.scene;\r\n        const x = scene.view.camera.position.x;\r\n        const y = scene.view.camera.position.y;\r\n        const azimuth = scene.view.controls?.getAzimuthalAngle?.() ?? 0;\r\n        const cameraHeight = scene.view.camera.position.z;\r\n        const resolution = cameraHeight / 100;\r\n\r\n        this.map.getView().setCenter([x, y]);\r\n        this.map.getView().setResolution(resolution);\r\n        this.viewConeFeature.getGeometry().setCoordinates([x, y]);\r\n        this.viewConeFeature.set('rotation', -azimuth, true);\r\n        this.viewConeLayer.getSource().changed();\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./SearchField3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./SearchField3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\n\r\nimport ColorLayer from '@giro3d/giro3d/core/layer/ColorLayer';\r\nimport VectorSource from '@giro3d/giro3d/sources/VectorSource';\r\nimport ol from 'openlayers';\r\nimport PropTypes from 'prop-types';\r\nimport {Group} from 'three';\r\nimport {GLTFLoader} from 'three/addons/loaders/GLTFLoader';\r\nimport {CSS2DObject} from 'three/addons/renderers/CSS2DRenderer';\r\n\r\nimport CoordinatesUtils from '../../utils/CoordinatesUtils';\r\nimport FeatureStyles from '../../utils/FeatureStyles';\r\nimport VectorLayerUtils from '../../utils/VectorLayerUtils';\r\nimport SearchWidget from '../widgets/SearchWidget';\r\nimport pinModel from './models/pin.glb';\r\n\r\nimport './style/SearchField3D.css';\r\n\r\n\r\nexport default class SearchField3D extends React.Component {\r\n    static propTypes = {\r\n        options: PropTypes.object,\r\n        sceneContext: PropTypes.object,\r\n        searchProviders: PropTypes.object\r\n    };\r\n\r\n    render() {\r\n        return (\r\n            <SearchWidget\r\n                queryGeometries\r\n                resultSelected={this.searchResultSelected}\r\n                searchParams={{mapcrs: this.props.sceneContext.mapCrs, displaycrs: this.props.sceneContext.mapCrs}}\r\n                searchProviders={Object.values(this.props.searchProviders)}\r\n                value={\"\"}\r\n            />\r\n        );\r\n    }\r\n    searchResultSelected = (result) => {\r\n        const sceneContext = this.props.sceneContext;\r\n        sceneContext.removeLayer(\"__searchHighlight\");\r\n        sceneContext.removeSceneObject(\"__searchMarker\");\r\n        if (!result) {\r\n            return;\r\n        }\r\n        const mapCrs = sceneContext.mapCrs;\r\n        const scenePos = CoordinatesUtils.reproject([result.x, result.y], result.crs ?? mapCrs, mapCrs);\r\n\r\n        // Add higlight geometry\r\n        if (result.feature && result.feature?.geometry?.type !== \"Point\") {\r\n            const format = new ol.format.GeoJSON();\r\n            const olFeatures = format.readFeatures(result.feature, {\r\n                dataProjection: result.crs ?? mapCrs, featureProjection: mapCrs\r\n            });\r\n            const highlightLayer = new ColorLayer({\r\n                source: new VectorSource({\r\n                    data: olFeatures,\r\n                    format: format,\r\n                    style: (feat) => FeatureStyles.default(feat, {})\r\n                })\r\n            });\r\n            sceneContext.addLayer(\"__searchHighlight\", highlightLayer);\r\n        }\r\n\r\n        // Zoom to bounds\r\n        let bounds = result.feature ? VectorLayerUtils.computeFeatureBBox(result.feature) : [\r\n            scenePos[0], scenePos[1],\r\n            scenePos[0], scenePos[1]\r\n        ];\r\n        // Adjust bounds so that we do not zoom further than 1:searchMinScaleDenom\r\n        const bbWidth = bounds[2] - bounds[0];\r\n        const bbHeight = bounds[3] - bounds[1];\r\n        const sceneRect = this.props.sceneContext.scene.viewport.getBoundingClientRect();\r\n        // Compute maximum allowed dimensions at the given scale\r\n        const px2m = 0.0254 / 96;\r\n        const minWidth = sceneRect.width * px2m * this.props.options.searchMinScaleDenom;\r\n        const minHeight = sceneRect.height * px2m * this.props.options.searchMinScaleDenom;\r\n        const scaleFactor = Math.max(bbWidth / minWidth, bbHeight / minHeight);\r\n        if (scaleFactor < 1) {\r\n            const bbCenterX = 0.5 * (bounds[0] + bounds[2]);\r\n            const bbCenterY = 0.5 * (bounds[1] + bounds[3]);\r\n            bounds = [\r\n                bbCenterX - minWidth / 2, bbCenterY - minHeight / 2,\r\n                bbCenterX + minWidth / 2, bbCenterY + minHeight / 2\r\n            ];\r\n        }\r\n\r\n        sceneContext.setViewToExtent(bounds, 0);\r\n        // Add pin and label at result position above terrain\r\n        sceneContext.getTerrainHeight(scenePos).then((terrainHeight) => {\r\n\r\n            const loader = new GLTFLoader();\r\n            loader.load(pinModel, (gltf) => {\r\n                const searchMarker = new Group();\r\n\r\n                // Add pin\r\n                const pin = gltf.scene;\r\n                pin.position.x = scenePos[0];\r\n                pin.position.y = scenePos[1];\r\n                pin.position.z = terrainHeight;\r\n                pin.rotation.x = Math.PI / 2;\r\n                pin.updateMatrixWorld();\r\n                searchMarker.add(pin);\r\n\r\n                // Add label\r\n                const labelEl = document.createElement(\"span\");\r\n                labelEl.innerText = result.label ?? result.text;\r\n                labelEl.className = \"map3d-search-pin-label\";\r\n                const label = new CSS2DObject(labelEl);\r\n                label.position.set(scenePos[0], scenePos[1], terrainHeight + 2);\r\n                label.updateMatrixWorld();\r\n                searchMarker.add(label);\r\n\r\n                sceneContext.addSceneObject(\"__searchMarker\", searchMarker);\r\n\r\n                // Scale search marker with distance\r\n                const scaleSearchMarker = () => {\r\n                    const distance = sceneContext.scene.view.camera.position.distanceTo(pin.position) / 30;\r\n                    const scale = Math.max(1, distance);\r\n                    label.position.z = terrainHeight + 2 * scale;\r\n                    label.updateMatrixWorld();\r\n                    pin.scale.set(scale, scale, scale);\r\n                    pin.updateMatrixWorld();\r\n                };\r\n\r\n                sceneContext.scene.view.controls.addEventListener('change', scaleSearchMarker);\r\n                searchMarker.addEventListener('removed', () => {\r\n                    sceneContext.scene.view.controls.removeEventListener('change', scaleSearchMarker);\r\n                    // The label DOM element is not removed when the searchMarker group is removed from the instance\r\n                    labelEl.parentNode.removeChild(labelEl);\r\n                });\r\n            });\r\n        });\r\n    };\r\n}\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./TopBar3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./TopBar3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport PropTypes from 'prop-types';\r\n\r\nimport {setTopbarHeight} from '../../actions/map';\r\nimport AppMenu from '../AppMenu';\r\nimport Icon from '../Icon';\r\nimport SearchField3D from './SearchField3D';\r\n\r\nimport './style/TopBar3D.css';\r\n\r\n\r\nclass TopBar3D extends React.Component {\r\n    static propTypes = {\r\n        options: PropTypes.object,\r\n        sceneContext: PropTypes.object,\r\n        searchProviders: PropTypes.object,\r\n        setTopbarHeight: PropTypes.func\r\n    };\r\n    state = {\r\n    };\r\n    render() {\r\n        const menuItems = [\r\n            {key: \"LayerTree3D\", icon: \"layers\"},\r\n            {key: \"Draw3D\", icon: \"draw\"},\r\n            {key: \"Measure3D\", icon: \"measure\"},\r\n            {key: \"Compare3D\", icon: \"compare\"},\r\n            {key: \"DateTime3D\", icon: \"clock\"},\r\n            {key: \"MapExport3D\", icon: \"rasterexport\"}\r\n        ];\r\n        return (\r\n            <div className=\"map3d-topbar\" ref={this.storeHeight}>\r\n                <SearchField3D options={this.props.options} sceneContext={this.props.sceneContext} searchProviders={this.props.searchProviders} />\r\n                <span className=\"map3d-topbar-spacer\" />\r\n                <AppMenu appMenuClearsTask buttonContents={this.menuButtonContents()} menuItems={menuItems} />\r\n            </div>\r\n        );\r\n    }\r\n    menuButtonContents = () => {\r\n        return (\r\n            <span className=\"map3d-topbar-menu-button\">\r\n                <Icon icon=\"menu-hamburger\"/>\r\n            </span>\r\n        );\r\n    };\r\n    storeHeight = (el) => {\r\n        if (el) {\r\n            this.props.setTopbarHeight(el.clientHeight);\r\n        }\r\n    };\r\n}\r\n\r\nexport default connect(() => ({}), {\r\n    setTopbarHeight: setTopbarHeight\r\n})(TopBar3D);\r\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport ColorLayer from '@giro3d/giro3d/core/layer/ColorLayer';\r\nimport VectorSource from \"@giro3d/giro3d/sources/VectorSource.js\";\r\nimport ol from 'openlayers';\r\n\r\nimport FeatureStyles from '../../../utils/FeatureStyles';\r\nimport {createFeatures, featureStyleFunction, updateFeatures} from '../../map/layers/VectorLayer';\r\n\r\n\r\nexport default {\r\n    create3d: (options, projection) => {\r\n        return new ColorLayer({\r\n            name: options.name,\r\n            source: new VectorSource({\r\n                data: createFeatures(options, projection),\r\n                format: new ol.format.GeoJSON(),\r\n                style: options.styleFunction || (feature => {\r\n                    const styleName = options.styleName || 'default';\r\n                    const styleOptions = options.styleOptions || {};\r\n                    return FeatureStyles[styleName](feature, styleOptions);\r\n                })\r\n            })\r\n        });\r\n    },\r\n    update3d: (layer, newOptions, oldOptions, projection) => {\r\n        if (newOptions.styleName !== oldOptions.styleName || newOptions.styleOptions !== oldOptions.styleOptions) {\r\n            layer.source.setStyle(featureStyleFunction(newOptions));\r\n        } else if (newOptions.styleFunction !== oldOptions.styleFunction) {\r\n            layer.source.setStyle(newOptions.styleFunction);\r\n        }\r\n        if (newOptions.features !== oldOptions.features) {\r\n            updateFeatures(layer.source, newOptions, oldOptions, projection);\r\n        } else if ((oldOptions.rev || 0) !== (newOptions.rev || 0)) {\r\n            layer.source.update();\r\n        }\r\n    }\r\n};\r\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport ColorLayer from '@giro3d/giro3d/core/layer/ColorLayer';\r\nimport TiledImageSource from '@giro3d/giro3d/sources/TiledImageSource.js';\r\nimport ol from 'openlayers';\r\n\r\nimport {wmsImageLoadFunction, wmsToOpenlayersOptions} from '../../map/layers/WMSLayer';\r\n\r\n\r\nexport default {\r\n    create3d: (options, projection) => {\r\n        const queryParameters = {...wmsToOpenlayersOptions(options), __t: +new Date()};\r\n        return new ColorLayer({\r\n            name: options.name,\r\n            source: new TiledImageSource({\r\n                source: new ol.source.TileWMS({\r\n                    url: options.url.split(\"?\")[0],\r\n                    params: queryParameters,\r\n                    version: options.version,\r\n                    projection: projection,\r\n                    tileLoadFunction: (imageTile, src) => wmsImageLoadFunction(imageTile.getImage(), src)\r\n                })\r\n            })\r\n        });\r\n    },\r\n    update3d: (layer, newOptions, oldOptions, projection) => {\r\n        if (oldOptions && layer?.source?.source?.updateParams) {\r\n            let changed = (oldOptions.rev || 0) !== (newOptions.rev || 0);\r\n            const oldParams = wmsToOpenlayersOptions(oldOptions);\r\n            const newParams = wmsToOpenlayersOptions(newOptions);\r\n            Object.keys(oldParams).forEach(key => {\r\n                if (!(key in newParams)) {\r\n                    newParams[key] = undefined;\r\n                }\r\n            });\r\n            if (!changed) {\r\n                changed = Object.keys(newParams).find(key => {\r\n                    return newParams[key] !== oldParams[key];\r\n                }) !== undefined;\r\n            }\r\n            changed |= newOptions.visibility !== oldOptions.visibility;\r\n            if (changed) {\r\n                const queryParameters = {...newParams,  __t: +new Date()};\r\n                if (layer.__updateTimeout) {\r\n                    clearTimeout(layer.__updateTimeout);\r\n                }\r\n                if (!newOptions.visibility || !queryParameters.LAYERS) {\r\n                    layer.visible = false;\r\n                }\r\n                layer.__updateTimeout = setTimeout(() => {\r\n                    layer.visible = queryParameters.LAYERS && newOptions.visibility;\r\n                    layer.source.source.updateParams(queryParameters);\r\n                    layer.source.update();\r\n                    layer.__updateTimeout = null;\r\n                }, 500);\r\n            }\r\n        }\r\n    }\r\n};\r\n","/**\r\n * Copyright 2015 GeoSolutions Sas\r\n * Copyright 2016-2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport ColorLayer from '@giro3d/giro3d/core/layer/ColorLayer';\r\nimport TiledImageSource from \"@giro3d/giro3d/sources/TiledImageSource.js\";\r\n\r\nimport {createWMTSSource} from '../../map/layers/WMTSLayer';\r\n\r\n\r\nexport default {\r\n    create3d: (options, projection) => {\r\n        return new ColorLayer({\r\n            name: options.name,\r\n            source: new TiledImageSource({\r\n                source: createWMTSSource({...options, projection})\r\n            })\r\n        });\r\n    },\r\n    update3d: (layer, newOptions, oldOptions, projection) => {\r\n        // pass\r\n    }\r\n};\r\n","/**\r\n * Copyright 2015 GeoSolutions Sas\r\n * Copyright 2016-2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport vectorLayer from './VectorLayer3D';\r\nimport wmsLayer from './WMSLayer3D';\r\nimport wmtsLayer from './WMTSLayer3D';\r\n\r\nexport default {\r\n    vector: vectorLayer,\r\n    wms: wmsLayer,\r\n    wmts: wmtsLayer\r\n};\r\n","\n      import API from \"!../../../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n      import domAPI from \"!../../../../node_modules/style-loader/dist/runtime/styleDomAPI.js\";\n      import insertFn from \"!../../../../node_modules/style-loader/dist/runtime/insertBySelector.js\";\n      import setAttributes from \"!../../../../node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js\";\n      import insertStyleElement from \"!../../../../node_modules/style-loader/dist/runtime/insertStyleElement.js\";\n      import styleTagTransformFn from \"!../../../../node_modules/style-loader/dist/runtime/styleTagTransform.js\";\n      import content, * as namedExport from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Map3D.css\";\n      \n      \n\nvar options = {};\n\noptions.styleTagTransform = styleTagTransformFn;\noptions.setAttributes = setAttributes;\noptions.insert = insertFn.bind(null, \"head\");\noptions.domAPI = domAPI;\noptions.insertStyleElement = insertStyleElement;\n\nvar update = API(content, options);\n\n\n\nexport * from \"!!../../../../node_modules/css-loader/dist/cjs.js!./Map3D.css\";\n       export default content && content.locals ? content.locals : undefined;\n","/**\r\n * Copyright 2024 Sourcepole AG\r\n * All rights reserved.\r\n *\r\n * This source code is licensed under the BSD-style license found in the\r\n * LICENSE file in the root directory of this source tree.\r\n */\r\n\r\nimport React from 'react';\r\nimport {connect} from 'react-redux';\r\n\r\nimport Instance from '@giro3d/giro3d/core/Instance.js';\r\nimport Extent from '@giro3d/giro3d/core/geographic/Extent.js';\r\nimport ElevationLayer from '@giro3d/giro3d/core/layer/ElevationLayer.js';\r\nimport Map from '@giro3d/giro3d/entities/Map.js';\r\nimport Tiles3D from \"@giro3d/giro3d/entities/Tiles3D.js\";\r\nimport GeoTIFFSource from \"@giro3d/giro3d/sources/GeoTIFFSource.js\";\r\nimport Tiles3DSource from \"@giro3d/giro3d/sources/Tiles3DSource.js\";\r\nimport {fromUrl} from \"geotiff\";\r\nimport PropTypes from 'prop-types';\r\nimport {Vector2, CubeTextureLoader, Group, Raycaster, Mesh} from 'three';\r\nimport {v1 as uuidv1} from 'uuid';\r\n\r\nimport {LayerRole} from '../../actions/layers';\r\nimport {setMapCrs} from '../../actions/map3d';\r\nimport {setCurrentTask} from '../../actions/task';\r\nimport {BackgroundSwitcher} from '../../plugins/BackgroundSwitcher';\r\nimport ConfigUtils from '../../utils/ConfigUtils';\r\nimport CoordinatesUtils from '../../utils/CoordinatesUtils';\r\nimport BottomBar3D from './BottomBar3D';\r\nimport Compare3D from './Compare3D';\r\nimport Draw3D from './Draw3D';\r\nimport LayerTree3D from './LayerTree3D';\r\nimport Map3DLight from './Map3DLight';\r\nimport MapControls3D from './MapControls3D';\r\nimport MapExport3D from './MapExport3D';\r\nimport Measure3D from './Measure3D';\r\nimport OverviewMap3D from './OverviewMap3D';\r\nimport TopBar3D from './TopBar3D';\r\nimport LayerRegistry from './layers/index';\r\n\r\nimport './style/Map3D.css';\r\n\r\nclass UnloadWrapper extends React.Component {\r\n    static propTypes = {\r\n        children: PropTypes.oneOfType([PropTypes.node, PropTypes.func]),\r\n        onUnload: PropTypes.func,\r\n        sceneId: PropTypes.string\r\n    };\r\n    onUnload = (el) => {\r\n        if (!el) {\r\n            this.props.onUnload(this.props.sceneId);\r\n        }\r\n    };\r\n    render() {\r\n        return (\r\n            <div>\r\n                {this.props.children}\r\n                <span ref={this.onUnload} />\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nclass Map3D extends React.Component {\r\n    static propTypes = {\r\n        innerRef: PropTypes.func,\r\n        layers: PropTypes.array,\r\n        mapBBox: PropTypes.object,\r\n        mapMargins: PropTypes.object,\r\n        options: PropTypes.object,\r\n        projection: PropTypes.string,\r\n        searchProviders: PropTypes.object,\r\n        setCurrentTask: PropTypes.func,\r\n        setMapCrs: PropTypes.func,\r\n        theme: PropTypes.object\r\n    };\r\n    static defaultProps = {\r\n        geometry: {\r\n            initialWidth: 600,\r\n            initialHeight: 800,\r\n            initialX: 0,\r\n            initialY: 0,\r\n            initiallyDocked: true\r\n        },\r\n        options: {\r\n            searchMinScaleDenom: 1000\r\n        }\r\n    };\r\n    static defaultSceneState = {\r\n        scene: null,\r\n        map: null,\r\n        mapCrs: null,\r\n        dtmUrl: null,\r\n        dtmCrs: null,\r\n        baseLayers: [],\r\n        colorLayers: [],\r\n        sceneObjects: {}\r\n    };\r\n    state = {\r\n        sceneContext: {\r\n            ...Map3D.defaultSceneState,\r\n\r\n            addLayer: (layer) => {},\r\n            getLayer: (layerId) => {},\r\n            removeLayer: (layerId) => {},\r\n            updateColorLayer: (layerId, options) => {},\r\n\r\n            addSceneObject: (objectId, object, options = {}) => {},\r\n            getSceneObject: (objectId) => {},\r\n            removeSceneObject: (objectId) => {},\r\n            updateSceneObject: (objectId, options) => {},\r\n\r\n            setViewToExtent: (bounds, angle) => {},\r\n            getTerrainHeight: (scenePos) => {},\r\n            getSceneIntersection: (x, y) => {}\r\n        },\r\n        sceneId: null\r\n    };\r\n    constructor(props) {\r\n        super(props);\r\n        this.container = null;\r\n        this.inspector = null;\r\n        this.instance = null;\r\n        this.map = null;\r\n        this.sceneObjectGroup = null;\r\n        this.objectMap = {};\r\n        this.state.sceneContext.addLayer = this.addLayer;\r\n        this.state.sceneContext.getLayer = this.getLayer;\r\n        this.state.sceneContext.removeLayer = this.removeLayer;\r\n        this.state.sceneContext.updateColorLayer = this.updateColorLayer;\r\n        this.state.sceneContext.addSceneObject = this.addSceneObject;\r\n        this.state.sceneContext.getSceneObject = this.getSceneObject;\r\n        this.state.sceneContext.removeSceneObject = this.removeSceneObject;\r\n        this.state.sceneContext.updateSceneObject = this.updateSceneObject;\r\n        this.state.sceneContext.getTerrainHeight = this.getTerrainHeight;\r\n        this.state.sceneContext.getSceneIntersection = this.getSceneIntersection;\r\n    }\r\n    componentDidMount() {\r\n        this.props.innerRef(this);\r\n    }\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (this.props.theme !== prevProps.theme) {\r\n            this.setupInstance();\r\n        } else if (this.props.layers !== prevProps.layers) {\r\n            this.setState((state) => (\r\n                {\r\n                    sceneContext: {...state.sceneContext, colorLayers: this.collectColorLayers(state.sceneContext.colorLayers)}\r\n                }\r\n            ));\r\n        }\r\n\r\n        // Update map layers\r\n        if (this.state.sceneContext.baseLayers !== prevState.sceneContext.baseLayers) {\r\n            this.applyBaseLayer();\r\n        }\r\n\r\n        if (this.state.sceneContext.colorLayers !== prevState.sceneContext.colorLayers) {\r\n            this.applyColorLayerUpdates(this.state.sceneContext.colorLayers, prevState.sceneContext.colorLayers);\r\n        }\r\n        // Update scene objects\r\n        if (this.state.sceneContext.sceneObjects !== prevState.sceneContext.sceneObjects) {\r\n            this.applySceneObjectUpdates(this.state.sceneContext.sceneObjects);\r\n        }\r\n    }\r\n    applyBaseLayer = () => {\r\n        const baseLayer = this.state.sceneContext.baseLayers.find(e => e.visibility === true);\r\n        this.removeLayer(\"__baselayer\");\r\n        if (!baseLayer) {\r\n            return;\r\n        }\r\n        const layerCreator = LayerRegistry[baseLayer.type];\r\n        if (layerCreator?.create3d) {\r\n            const layer3d = layerCreator.create3d(baseLayer, this.props.projection);\r\n            this.addLayer(\"__baselayer\", layer3d);\r\n            this.map.insertLayerAfter(layer3d, null);\r\n        }\r\n    };\r\n    setBaseLayer = (layer, visibility) => {\r\n        this.setState(state => ({\r\n            sceneContext: {\r\n                ...state.sceneContext,\r\n                baseLayers: state.sceneContext.baseLayers.map(entry => (\r\n                    {...entry, visibility: entry.name === layer.name ? visibility : false}\r\n                ))\r\n            }\r\n        }));\r\n    };\r\n    collectColorLayers = (prevColorLayers) => {\r\n        const prevLayersMap = prevColorLayers.reduce((res, layer) => (\r\n            {...res, [layer.id]: layer}\r\n        ), {});\r\n\r\n        return this.props.layers.map(layer => {\r\n            if (layer.role !== LayerRole.THEME && layer.role !== LayerRole.USERLAYER) {\r\n                return null;\r\n            }\r\n            const layerCreator = LayerRegistry[layer.type];\r\n            if (!layerCreator || !layerCreator.create3d) {\r\n                return null;\r\n            }\r\n            const prevLayer = prevLayersMap[layer.id];\r\n            return {\r\n                ...layer,\r\n                visibility: prevLayer?.visibility ?? false,\r\n                opacity: prevLayer?.opacity ?? 255\r\n            };\r\n        }).filter(Boolean);\r\n    };\r\n    applyColorLayerUpdates = (layers, prevLayers) => {\r\n        const layersMap = layers.reduce((res, layer) => ({...res, [layer.id]: layer}), {});\r\n        const prevLayersMap = prevLayers.reduce((res, layer) => ({...res, [layer.id]: layer}), {});\r\n\r\n        // Add-update new layers\r\n        let prevLayer = this.getLayer(\"__baselayer\");\r\n        [...layers].reverse().forEach(layer => {\r\n            const layerCreator = LayerRegistry[layer.type];\r\n            let mapLayer = this.getLayer(layer.id);\r\n            if (mapLayer) {\r\n                layerCreator.update3d(mapLayer.source, layer, prevLayersMap[layer.id], this.props.projection);\r\n            } else {\r\n                mapLayer = layerCreator.create3d(layer, this.props.projection);\r\n                this.addLayer(layer.id, mapLayer);\r\n            }\r\n            this.map.insertLayerAfter(mapLayer, prevLayer);\r\n            mapLayer.visible = layer.visibility;\r\n            mapLayer.opacity = layer.opacity / 255;\r\n            prevLayer = mapLayer;\r\n        });\r\n        // Remove old layers\r\n        Object.keys(prevLayers).forEach(layer => {\r\n            if (!(layer.id in layersMap)) {\r\n                this.removeLayer(layer.id);\r\n            }\r\n        });\r\n        this.instance.notifyChange(this.map);\r\n    };\r\n    applySceneObjectUpdates = (sceneObjects) => {\r\n        Object.entries(sceneObjects).forEach(([objectId, options]) => {\r\n            const object = this.objectMap[objectId];\r\n            object.visible = options.visible;\r\n            object.opacity = options.opacity;\r\n            this.instance.notifyChange(object);\r\n        });\r\n    };\r\n    addLayer = (layerId, layer) => {\r\n        layer.userData.layerId = layerId;\r\n        this.map.addLayer(layer);\r\n    };\r\n    getLayer = (layerId) => {\r\n        return this.map.getLayers(l => l.userData.layerId === layerId)[0] ?? null;\r\n    };\r\n    removeLayer = (layerId) => {\r\n        this.map.getLayers(l => l.userData.layerId === layerId).forEach(layer => {\r\n            this.map.removeLayer(layer, {dispose: true});\r\n        });\r\n    };\r\n    updateColorLayer = (layerId, diff) => {\r\n        this.setState(state => ({\r\n            sceneContext: {\r\n                ...state.sceneContext,\r\n                colorLayers: state.sceneContext.colorLayers.map(entry => {\r\n                    return entry.id === layerId ? {...entry, ...diff} : entry;\r\n                })\r\n            }\r\n        }));\r\n    };\r\n    addSceneObject = (objectId, object, options = {}) => {\r\n        this.sceneObjectGroup.add(object);\r\n        this.objectMap[objectId] = object;\r\n        this.setState((state) => {\r\n            const objectState = {\r\n                visible: true,\r\n                opacity: 100,\r\n                layertree: false,\r\n                ...options\r\n            };\r\n            return {\r\n                sceneContext: {\r\n                    ...state.sceneContext,\r\n                    sceneObjects: {...state.sceneContext.sceneObjects, [objectId]: objectState}\r\n                }\r\n            };\r\n        });\r\n    };\r\n    getSceneObject = (objectId) => {\r\n        return this.objectMap[objectId];\r\n    };\r\n    removeSceneObject = (objectId) => {\r\n        if (!this.objectMap[objectId]) {\r\n            return;\r\n        }\r\n        this.setState((state) => {\r\n            this.instance.remove(this.objectMap[objectId]);\r\n            delete this.objectMap[objectId];\r\n            const newSceneObjects = {...state.sceneContext.sceneObjects};\r\n            delete newSceneObjects[objectId];\r\n            return {\r\n                sceneContext: {\r\n                    ...state.sceneContext,\r\n                    sceneObjects: newSceneObjects\r\n                }\r\n            };\r\n        });\r\n    };\r\n    updateSceneObject = (objectId, options) => {\r\n        this.setState((state) => {\r\n            return {\r\n                sceneContext: {\r\n                    ...state.sceneContext,\r\n                    sceneObjects: {\r\n                        ...state.sceneContext.sceneObjects,\r\n                        [objectId]: {\r\n                            ...state.sceneContext.sceneObjects[objectId],\r\n                            ...options\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n        });\r\n    };\r\n    render() {\r\n        const baseLayer = this.state.sceneContext.baseLayers.find(l => l.visibility === true);\r\n        const style = {\r\n            marginTop: this.props.mapMargins.top,\r\n            marginRight: this.props.mapMargins.right,\r\n            marginBottom: this.props.mapMargins.bottom,\r\n            marginLeft: this.props.mapMargins.left\r\n        };\r\n        return (\r\n            <div className=\"map3d-body\">\r\n                <div className=\"map3d-map\" onMouseDown={this.stopAnimations} ref={this.setupContainer} style={style} />\r\n                {this.state.sceneContext.scene ? (\r\n                    <UnloadWrapper key={this.state.sceneId} onUnload={this.onUnload} sceneId={this.state.sceneId}>\r\n                        <MapControls3D ref={this.setupControls} sceneContext={this.state.sceneContext} />\r\n                        <BackgroundSwitcher bottombarHeight={10} changeLayerVisibility={this.setBaseLayer} layers={this.state.sceneContext.baseLayers} />\r\n                        <TopBar3D options={this.props.options} sceneContext={this.state.sceneContext} searchProviders={this.props.searchProviders} />\r\n                        <LayerTree3D sceneContext={this.state.sceneContext} />\r\n                        <BottomBar3D sceneContext={this.state.sceneContext} />\r\n                        <OverviewMap3D baseLayer={baseLayer} sceneContext={this.state.sceneContext} />\r\n                        <Map3DLight sceneContext={this.state.sceneContext} />\r\n                        <Measure3D sceneContext={this.state.sceneContext} />\r\n                        <Compare3D sceneContext={this.state.sceneContext} />\r\n                        <Draw3D sceneContext={this.state.sceneContext} />\r\n                        <MapExport3D sceneContext={this.state.sceneContext} theme={this.props.theme} />\r\n                    </UnloadWrapper>\r\n                ) : null}\r\n            </div>\r\n        );\r\n    }\r\n    setupContainer = (el) => {\r\n        if (el) {\r\n            this.container = el;\r\n            this.setupInstance();\r\n        }\r\n    };\r\n    setupInstance = () => {\r\n        if (this.instance) {\r\n            this.disposeInstance();\r\n        }\r\n        const projection = this.props.projection;\r\n        this.props.setMapCrs(projection);\r\n\r\n        // Setup instance\r\n        this.instance = new Instance({\r\n            target: this.container,\r\n            crs: projection,\r\n            renderer: {\r\n                clearColor: 0x000000,\r\n                preserveDrawingBuffer: true\r\n            }\r\n        });\r\n        this.sceneObjectGroup = new Group();\r\n        this.instance.add(this.sceneObjectGroup);\r\n\r\n        // Setup map\r\n        const bounds = CoordinatesUtils.reprojectBbox(this.props.theme.bbox.bounds, this.props.theme.bbox.crs, projection);\r\n        const extent = new Extent(projection, bounds[0], bounds[2], bounds[1], bounds[3]);\r\n        this.map = new Map({\r\n            extent: extent,\r\n            backgroundColor: \"white\",\r\n            hillshading: true\r\n        });\r\n        this.instance.add(this.map);\r\n\r\n        // Setup camera\r\n        const center = extent.center();\r\n        this.instance.view.camera.position.set(center.x, center.y, 0.5 * (extent.east - extent.west));\r\n\r\n        // Skybox\r\n        const cubeTextureLoader = new CubeTextureLoader();\r\n        cubeTextureLoader.setPath(ConfigUtils.getAssetsPath() + \"/3d/skybox/\");\r\n        const cubeTexture = cubeTextureLoader.load([\r\n            \"px.jpg\",\r\n            \"nx.jpg\",\r\n            \"py.jpg\",\r\n            \"ny.jpg\",\r\n            \"pz.jpg\",\r\n            \"nz.jpg\"\r\n        ]);\r\n        this.instance.scene.background = cubeTexture;\r\n\r\n        // Setup elevation\r\n        let demUrl = this.props.theme.map3d?.dtm?.url ?? \"\";\r\n        if (demUrl.startsWith(\":\")) {\r\n            demUrl = location.href.split(\"?\")[0] + ConfigUtils.getAssetsPath() + demUrl.substr(1);\r\n        }\r\n        const demCrs = this.props.theme.map3d?.dtm?.crs || \"EPSG:3857\";\r\n        if (demUrl) {\r\n            const demSource = new GeoTIFFSource({\r\n                url: demUrl,\r\n                crs: demCrs\r\n            });\r\n            const demMin = this.props.theme.map3d.dtm.min ?? undefined;\r\n            const demMax = this.props.theme.map3d.dtm.max ?? undefined;\r\n            const elevationLayer = new ElevationLayer({\r\n                name: 'dem',\r\n                extent: extent,\r\n                source: demSource,\r\n                minmax: demMin !== undefined && demMax !== undefined ? { demMin, demMax } : undefined\r\n            });\r\n            this.addLayer(\"__dtm\", elevationLayer);\r\n        }\r\n\r\n        // Collect baselayers\r\n        let visibleBaseLayer = null;\r\n        const baseLayers = (this.props.theme.map3d?.basemaps || []).map(e => {\r\n            const baseLayer = {\r\n                ...this.props.layers.find(bl => bl.name === e.name),\r\n                visibility: e.visibility === true\r\n            };\r\n            if (baseLayer.visibility) {\r\n                visibleBaseLayer = baseLayer;\r\n            }\r\n            return baseLayer;\r\n        });\r\n        if (visibleBaseLayer) {\r\n            this.setBaseLayer(visibleBaseLayer, true);\r\n        }\r\n\r\n        // Collect color layers\r\n        const colorLayers = this.collectColorLayers([]);\r\n\r\n        // Add 3d tiles\r\n        this.objectMap = {};\r\n        const sceneObjects = {};\r\n        (this.props.theme.map3d?.tiles3d || []).forEach(entry => {\r\n            let tilesUrl = entry.url;\r\n            if (tilesUrl.startsWith(\":\")) {\r\n                tilesUrl = location.href.split(\"?\")[0] + ConfigUtils.getAssetsPath() + tilesUrl.substr(1);\r\n            }\r\n            const tiles = new Tiles3D(\r\n                new Tiles3DSource(tilesUrl)\r\n            );\r\n            tiles.userData.layertree = true;\r\n            this.instance.add(tiles);\r\n            this.objectMap[entry.name] = tiles;\r\n            sceneObjects[entry.name] = {visible: true, opacity: 100, layertree: true, title: entry.title ?? entry.name};\r\n        });\r\n\r\n        this.setState(state => ({\r\n            sceneContext: {\r\n                ...state.sceneContext,\r\n                scene: this.instance,\r\n                map: this.map,\r\n                mapCrs: projection,\r\n                dtmUrl: demUrl,\r\n                dtmCrs: demCrs,\r\n                baseLayers: baseLayers,\r\n                colorLayers: colorLayers,\r\n                sceneObjects: sceneObjects\r\n            },\r\n            sceneId: uuidv1()\r\n        }));\r\n\r\n        // this.inspector = Inspector.attach(\"map3dinspector\", this.instance);\r\n    };\r\n    disposeInstance = () => {\r\n        if (this.inspector) {\r\n            this.inspector.detach();\r\n        }\r\n        this.map.dispose({disposeLayers: true});\r\n        this.instance.dispose();\r\n        Object.values(this.objectMap).forEach(object => {\r\n            this.instance.remove(object);\r\n            object.traverse(obj => obj.dispose?.());\r\n        });\r\n        this.inspector = null;\r\n        this.map = null;\r\n        this.objectMap = {};\r\n        this.sceneObjectGroup = null;\r\n        this.instance = null;\r\n        this.setState((state) => ({\r\n            sceneContext: {...state.sceneContext, ...Map3D.defaultSceneState}\r\n        }));\r\n        this.props.setCurrentTask(null);\r\n    };\r\n    onUnload = (key) => {\r\n        // Ensure scene has not already been disposed\r\n        if (this.state.sceneId === key) {\r\n            this.disposeInstance();\r\n        }\r\n    };\r\n    setupControls = (instance) => {\r\n        this.setState(state => ({sceneContext: {\r\n            ...state.sceneContext,\r\n            setViewToExtent: instance?.setViewToExtent\r\n\r\n        }}));\r\n        instance?.setViewToExtent?.(this.props.mapBBox.bounds, this.props.mapBBox.rotation);\r\n    };\r\n    getTerrainHeight = (scenePos) => {\r\n        const dtmPos = CoordinatesUtils.reproject(scenePos, this.state.sceneContext.mapCrs, this.state.sceneContext.dtmCrs);\r\n        return new Promise((resolve) => {\r\n            fromUrl(this.state.sceneContext.dtmUrl).then(tiff => {\r\n\r\n                tiff.getImage().then(image => {\r\n                    const { ModelTiepoint, ModelPixelScale } = image.fileDirectory;\r\n\r\n                    // Extract scale and tiepoint values\r\n                    const [scaleX, scaleY] = [ModelPixelScale[0], ModelPixelScale[1]];\r\n                    const [tiepointX, tiepointY] = [ModelTiepoint[3], ModelTiepoint[4]]; // Tiepoint world coordinates\r\n\r\n                    // Calculate pixel indices (rounded to nearest integers)\r\n                    const pixelX = Math.round((dtmPos[0] - tiepointX) / scaleX);\r\n                    const pixelY = Math.round((tiepointY - dtmPos[1]) / scaleY); // Inverted Y-axis in image\r\n\r\n                    image.readRasters({ window: [pixelX, pixelY, pixelX + 1, pixelY + 1] }).then(raster => {\r\n                        resolve(raster[0][0]);\r\n                    });\r\n                });\r\n            });\r\n        });\r\n    };\r\n    getSceneIntersection = (x, y, objects = true) => {\r\n        const raycaster = new Raycaster();\r\n        const camera = this.instance.view.camera;\r\n        raycaster.setFromCamera(new Vector2(x, y), camera);\r\n        // Query object intersection\r\n        const objInter = objects ? raycaster.intersectObjects([\r\n            this.sceneObjectGroup,\r\n            ...this.instance.getEntities().filter(e => e !== this.map).map(entity => entity.object3d)\r\n        ], true)[0] : undefined;\r\n        // Query highest resolution terrain tile (i.e. tile with no children)\r\n        const terrInter = raycaster.intersectObjects([this.map.object3d]).filter(result => result.object.children.length === 0)[0];\r\n        // Return closest result\r\n        if (objInter && terrInter) {\r\n            return objInter.distance < terrInter.distance ? objInter : terrInter;\r\n        }\r\n        return objInter ?? terrInter;\r\n    };\r\n    redrawScene = (ev) => {\r\n        const width = ev.target.innerWidth;\r\n        const height = ev.target.innerHeight;\r\n        this.instance.renderer.setSize(width, height);\r\n        this.instance.view.camera.aspect = width / height;\r\n        this.instance.view.camera.updateProjectionMatrix();\r\n        this.instance.renderer.render(this.instance.scene, this.instance.view.camera);\r\n    };\r\n    setViewToExtent = (bounds, rotation) => {\r\n        this.state.sceneContext.setViewToExtent(bounds, rotation);\r\n    };\r\n}\r\n\r\nexport default connect((state) => ({\r\n    mapMargins: state.windows.mapMargins\r\n}), {\r\n    setMapCrs: setMapCrs,\r\n    setCurrentTask: setCurrentTask\r\n})(Map3D);\r\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `span.map3d-search-pin-label {\r\n    -webkit-text-stroke: 0.8px black;\r\n    text-stroke: 0.8px black;\r\n    color: white;\r\n    font-weight: bold;\r\n    font-size: 16px;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/SearchField3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,gCAAgC;IAChC,wBAAwB;IACxB,YAAY;IACZ,iBAAiB;IACjB,eAAe;AACnB\",\"sourcesContent\":[\"span.map3d-search-pin-label {\\r\\n    -webkit-text-stroke: 0.8px black;\\r\\n    text-stroke: 0.8px black;\\r\\n    color: white;\\r\\n    font-weight: bold;\\r\\n    font-size: 16px;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.map3d-nav-pan,\r\ndiv.map3d-nav-rotate {\r\n    position: absolute;\r\n    right: 1em;\r\n    z-index: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    flex-wrap: wrap;\r\n    width: 4em;\r\n    height: 4em;\r\n    border-radius: 2em;\r\n    color: var(--map-button-text-color);\r\n    background-color: var(--map-button-bg-color);\r\n    box-shadow: 0px 5px 10px rgba(136, 136, 136, 0.5);\r\n}\r\n\r\ndiv.map3d-nav-pan > span,\r\ndiv.map3d-nav-rotate > span {\r\n    flex: 0 0 1.25em;\r\n}\r\n\r\ndiv.map3d-nav-pan {\r\n    top: 4em;\r\n}\r\n\r\ndiv.map3d-nav-pan > span.icon-home {\r\n    font-size: 120%;\r\n}\r\n\r\ndiv.map3d-nav-rotate {\r\n    top: 9em;\r\n}\r\n\r\ndiv.map3d-firstperson-button {\r\n    position: absolute;\r\n    width: 2em;\r\n    height: 2em;\r\n    right: 2em;\r\n    top: 14em;\r\n    z-index: 1;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    color: var(--map-button-text-color);\r\n    background-color: var(--map-button-bg-color);\r\n    box-shadow: 0px 5px 10px rgba(136, 136, 136, 0.5);\r\n    border-radius: 4px;\r\n    cursor: pointer;\r\n    transition: background-color 0.5s, color 0.5s;\r\n}\r\n\r\ndiv.map3d-firstperson-button-active {\r\n    background-color: var(--map-button-text-color);\r\n    color: var(--map-button-bg-color);\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/MapControls3D.css\"],\"names\":[],\"mappings\":\"AAAA;;IAEI,kBAAkB;IAClB,UAAU;IACV,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,eAAe;IACf,UAAU;IACV,WAAW;IACX,kBAAkB;IAClB,mCAAmC;IACnC,4CAA4C;IAC5C,iDAAiD;AACrD;;AAEA;;IAEI,gBAAgB;AACpB;;AAEA;IACI,QAAQ;AACZ;;AAEA;IACI,eAAe;AACnB;;AAEA;IACI,QAAQ;AACZ;;AAEA;IACI,kBAAkB;IAClB,UAAU;IACV,WAAW;IACX,UAAU;IACV,SAAS;IACT,UAAU;IACV,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,mCAAmC;IACnC,4CAA4C;IAC5C,iDAAiD;IACjD,kBAAkB;IAClB,eAAe;IACf,6CAA6C;AACjD;;AAEA;IACI,8CAA8C;IAC9C,iCAAiC;AACrC\",\"sourcesContent\":[\"div.map3d-nav-pan,\\r\\ndiv.map3d-nav-rotate {\\r\\n    position: absolute;\\r\\n    right: 1em;\\r\\n    z-index: 1;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    flex-wrap: wrap;\\r\\n    width: 4em;\\r\\n    height: 4em;\\r\\n    border-radius: 2em;\\r\\n    color: var(--map-button-text-color);\\r\\n    background-color: var(--map-button-bg-color);\\r\\n    box-shadow: 0px 5px 10px rgba(136, 136, 136, 0.5);\\r\\n}\\r\\n\\r\\ndiv.map3d-nav-pan > span,\\r\\ndiv.map3d-nav-rotate > span {\\r\\n    flex: 0 0 1.25em;\\r\\n}\\r\\n\\r\\ndiv.map3d-nav-pan {\\r\\n    top: 4em;\\r\\n}\\r\\n\\r\\ndiv.map3d-nav-pan > span.icon-home {\\r\\n    font-size: 120%;\\r\\n}\\r\\n\\r\\ndiv.map3d-nav-rotate {\\r\\n    top: 9em;\\r\\n}\\r\\n\\r\\ndiv.map3d-firstperson-button {\\r\\n    position: absolute;\\r\\n    width: 2em;\\r\\n    height: 2em;\\r\\n    right: 2em;\\r\\n    top: 14em;\\r\\n    z-index: 1;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    color: var(--map-button-text-color);\\r\\n    background-color: var(--map-button-bg-color);\\r\\n    box-shadow: 0px 5px 10px rgba(136, 136, 136, 0.5);\\r\\n    border-radius: 4px;\\r\\n    cursor: pointer;\\r\\n    transition: background-color 0.5s, color 0.5s;\\r\\n}\\r\\n\\r\\ndiv.map3d-firstperson-button-active {\\r\\n    background-color: var(--map-button-text-color);\\r\\n    color: var(--map-button-bg-color);\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.map3d-topbar {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    top: 0;\r\n    height: 3.5em;\r\n    z-index: 100;\r\n    color: var(--panel-text-color);\r\n    background-color: var(--panel-bg-color);\r\n    box-shadow: 0 -2px 4px rgba(136, 136, 136, 0.5);\r\n    backdrop-filter: blur(3px);\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\ndiv.map3d-topbar div.search-widget-container {\r\n    margin: 0 0.75em;\r\n    width: 25em;\r\n}\r\n\r\nspan.map3d-topbar-spacer {\r\n    flex: 1 1 auto;\r\n}\r\n\r\ndiv.map3d-topbar div.AppMenu {\r\n    flex: 0 0 auto;\r\n    color: var(--panel-text-color);\r\n}\r\n\r\ndiv.map3d-topbar div.AppMenu span.icon-menu-hamburger {\r\n    padding: 0.25em;\r\n    margin: 0 1em;\r\n    border: 2px solid var(--panel-text-color);\r\n}\r\n\r\ndiv.map3d-topbar div.AppMenu.appmenu-visible {\r\n    color: var(--app-submenu-text-color-hover);\r\n}\r\n\r\ndiv.map3d-topbar div.AppMenu.appmenu-visible span.icon-menu-hamburger {\r\n    border: 2px solid var(--app-submenu-text-color-hover);\r\n}\r\n\r\ndiv.map3d-topbar div.AppMenu div.appmenu-menu-container {\r\n    background-color: var(--app-menu-bg-color);\r\n}\r\n\r\ndiv.map3d-topbar div.AppMenu ul.appmenu-menu li:last-child {\r\n    border-bottom: 1px solid var(--app-menu-text-color);\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/TopBar3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,MAAM;IACN,aAAa;IACb,YAAY;IACZ,8BAA8B;IAC9B,uCAAuC;IACvC,+CAA+C;IAC/C,0BAA0B;IAC1B,aAAa;IACb,mBAAmB;AACvB;;AAEA;IACI,gBAAgB;IAChB,WAAW;AACf;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,cAAc;IACd,8BAA8B;AAClC;;AAEA;IACI,eAAe;IACf,aAAa;IACb,yCAAyC;AAC7C;;AAEA;IACI,0CAA0C;AAC9C;;AAEA;IACI,qDAAqD;AACzD;;AAEA;IACI,0CAA0C;AAC9C;;AAEA;IACI,mDAAmD;AACvD\",\"sourcesContent\":[\"div.map3d-topbar {\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    top: 0;\\r\\n    height: 3.5em;\\r\\n    z-index: 100;\\r\\n    color: var(--panel-text-color);\\r\\n    background-color: var(--panel-bg-color);\\r\\n    box-shadow: 0 -2px 4px rgba(136, 136, 136, 0.5);\\r\\n    backdrop-filter: blur(3px);\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.search-widget-container {\\r\\n    margin: 0 0.75em;\\r\\n    width: 25em;\\r\\n}\\r\\n\\r\\nspan.map3d-topbar-spacer {\\r\\n    flex: 1 1 auto;\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.AppMenu {\\r\\n    flex: 0 0 auto;\\r\\n    color: var(--panel-text-color);\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.AppMenu span.icon-menu-hamburger {\\r\\n    padding: 0.25em;\\r\\n    margin: 0 1em;\\r\\n    border: 2px solid var(--panel-text-color);\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.AppMenu.appmenu-visible {\\r\\n    color: var(--app-submenu-text-color-hover);\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.AppMenu.appmenu-visible span.icon-menu-hamburger {\\r\\n    border: 2px solid var(--app-submenu-text-color-hover);\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.AppMenu div.appmenu-menu-container {\\r\\n    background-color: var(--app-menu-bg-color);\\r\\n}\\r\\n\\r\\ndiv.map3d-topbar div.AppMenu ul.appmenu-menu li:last-child {\\r\\n    border-bottom: 1px solid var(--app-menu-text-color);\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `#LayerTree3D div.layertree3d-item-container {\r\n    padding: 0.25em 0.25em 0.25em 0.5em;\r\n}\r\n\r\n\r\n#LayerTree3D div.layertree3d-item {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 1.75em;\r\n}\r\n\r\n#LayerTree3D span.layertree3d-item-checkbox {\r\n    margin-right: 0.5em;\r\n    flex: 0 0 auto;\r\n}\r\n\r\n#LayerTree3D div.layertree3d-item-disabled > span.layertree3d-item-title {\r\n    color: var(--text-color-disabled);\r\n}\r\n\r\n#LayerTree3D span.layertree3d-item-title {\r\n    flex: 1 1 auto;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n}\r\n\r\n#LayerTree3D span.layertree3d-item-transparency {\r\n    flex: 0 0 5em;\r\n    margin: 0 0.5em;\r\n}\r\n\r\n#LayerTree3D input.layertree3d-item-transparency-slider {\r\n    width: 100%;\r\n}\r\n\r\n#LayerTree3D div.layertree3d-section {\r\n    font-weight: bold;\r\n    margin-left: -0.25em;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/LayerTree3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,mCAAmC;AACvC;;;AAGA;IACI,aAAa;IACb,mBAAmB;IACnB,cAAc;AAClB;;AAEA;IACI,mBAAmB;IACnB,cAAc;AAClB;;AAEA;IACI,iCAAiC;AACrC;;AAEA;IACI,cAAc;IACd,mBAAmB;IACnB,gBAAgB;IAChB,uBAAuB;AAC3B;;AAEA;IACI,aAAa;IACb,eAAe;AACnB;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,iBAAiB;IACjB,oBAAoB;AACxB\",\"sourcesContent\":[\"#LayerTree3D div.layertree3d-item-container {\\r\\n    padding: 0.25em 0.25em 0.25em 0.5em;\\r\\n}\\r\\n\\r\\n\\r\\n#LayerTree3D div.layertree3d-item {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    height: 1.75em;\\r\\n}\\r\\n\\r\\n#LayerTree3D span.layertree3d-item-checkbox {\\r\\n    margin-right: 0.5em;\\r\\n    flex: 0 0 auto;\\r\\n}\\r\\n\\r\\n#LayerTree3D div.layertree3d-item-disabled > span.layertree3d-item-title {\\r\\n    color: var(--text-color-disabled);\\r\\n}\\r\\n\\r\\n#LayerTree3D span.layertree3d-item-title {\\r\\n    flex: 1 1 auto;\\r\\n    white-space: nowrap;\\r\\n    overflow: hidden;\\r\\n    text-overflow: ellipsis;\\r\\n}\\r\\n\\r\\n#LayerTree3D span.layertree3d-item-transparency {\\r\\n    flex: 0 0 5em;\\r\\n    margin: 0 0.5em;\\r\\n}\\r\\n\\r\\n#LayerTree3D input.layertree3d-item-transparency-slider {\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#LayerTree3D div.layertree3d-section {\\r\\n    font-weight: bold;\\r\\n    margin-left: -0.25em;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.map3d-body {\r\n    margin: -0.25em;\r\n    height: calc(100% + 0.5em);\r\n    position: relative;\r\n}\r\n\r\ndiv.map3d-titlebar {\r\n    flex: 0 0 3.25em;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\ndiv.map3d-titlebar > span:first-child {\r\n    flex: 1 1 auto;\r\n    padding: 0 0.5em;\r\n    font-weight: bold;\r\n    font-size: 150%;\r\n}\r\n\r\ndiv.map3d-titlebar > span.icon-remove {\r\n    font-size: 150%;\r\n    margin: 0 0.5em;\r\n}\r\n\r\ndiv.map3d-map {\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n}\r\n\r\ndiv#map3dinspector {\r\n    position: fixed;\r\n    z-index: 5;\r\n    right: 0;\r\n    top: 3.5em;\r\n}\r\n\r\ndiv#map3dinspector input {\r\n    color: black!important;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/Map3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,eAAe;IACf,0BAA0B;IAC1B,kBAAkB;AACtB;;AAEA;IACI,gBAAgB;IAChB,aAAa;IACb,mBAAmB;AACvB;;AAEA;IACI,cAAc;IACd,gBAAgB;IAChB,iBAAiB;IACjB,eAAe;AACnB;;AAEA;IACI,eAAe;IACf,eAAe;AACnB;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,MAAM;IACN,QAAQ;IACR,SAAS;AACb;;AAEA;IACI,eAAe;IACf,UAAU;IACV,QAAQ;IACR,UAAU;AACd;;AAEA;IACI,sBAAsB;AAC1B\",\"sourcesContent\":[\"div.map3d-body {\\r\\n    margin: -0.25em;\\r\\n    height: calc(100% + 0.5em);\\r\\n    position: relative;\\r\\n}\\r\\n\\r\\ndiv.map3d-titlebar {\\r\\n    flex: 0 0 3.25em;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\ndiv.map3d-titlebar > span:first-child {\\r\\n    flex: 1 1 auto;\\r\\n    padding: 0 0.5em;\\r\\n    font-weight: bold;\\r\\n    font-size: 150%;\\r\\n}\\r\\n\\r\\ndiv.map3d-titlebar > span.icon-remove {\\r\\n    font-size: 150%;\\r\\n    margin: 0 0.5em;\\r\\n}\\r\\n\\r\\ndiv.map3d-map {\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n}\\r\\n\\r\\ndiv#map3dinspector {\\r\\n    position: fixed;\\r\\n    z-index: 5;\\r\\n    right: 0;\\r\\n    top: 3.5em;\\r\\n}\\r\\n\\r\\ndiv#map3dinspector input {\\r\\n    color: black!important;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `#DateTime3D div.datetime3d-body {\r\n    padding: 0.25em;\r\n}\r\n\r\n#DateTime3D div.datetime3d-body > table {\r\n    width: 100%;\r\n}\r\n\r\n#DateTime3D div.datetime3d-body > table td > input {\r\n    width: 100%;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/Map3DLight.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,eAAe;AACnB;;AAEA;IACI,WAAW;AACf;;AAEA;IACI,WAAW;AACf\",\"sourcesContent\":[\"#DateTime3D div.datetime3d-body {\\r\\n    padding: 0.25em;\\r\\n}\\r\\n\\r\\n#DateTime3D div.datetime3d-body > table {\\r\\n    width: 100%;\\r\\n}\\r\\n\\r\\n#DateTime3D div.datetime3d-body > table td > input {\\r\\n    width: 100%;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.mapexport3d-event-container {\r\n    z-index: 2;\r\n    position: absolute;\r\n    left: 0;\r\n    top: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n}\r\n\r\ndiv.mapexport3d-frame {\r\n    position: absolute;\r\n    box-shadow: rgba(0, 0, 0, 0.5) 0 0 0 30000px;\r\n    white-space: nowrap;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    font-size: small;\r\n    overflow: hidden;\r\n    user-select: none;\r\n}\r\n\r\nspan.mapexport3d-frame-label {\r\n    padding: 0.25em;\r\n    background: rgba(255, 255, 255, 0.5);\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/MapExport3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,UAAU;IACV,kBAAkB;IAClB,OAAO;IACP,MAAM;IACN,QAAQ;IACR,SAAS;AACb;;AAEA;IACI,kBAAkB;IAClB,4CAA4C;IAC5C,mBAAmB;IACnB,aAAa;IACb,mBAAmB;IACnB,uBAAuB;IACvB,gBAAgB;IAChB,gBAAgB;IAChB,iBAAiB;AACrB;;AAEA;IACI,eAAe;IACf,oCAAoC;AACxC\",\"sourcesContent\":[\"div.mapexport3d-event-container {\\r\\n    z-index: 2;\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    top: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n}\\r\\n\\r\\ndiv.mapexport3d-frame {\\r\\n    position: absolute;\\r\\n    box-shadow: rgba(0, 0, 0, 0.5) 0 0 0 30000px;\\r\\n    white-space: nowrap;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    justify-content: center;\\r\\n    font-size: small;\\r\\n    overflow: hidden;\\r\\n    user-select: none;\\r\\n}\\r\\n\\r\\nspan.mapexport3d-frame-label {\\r\\n    padding: 0.25em;\\r\\n    background: rgba(255, 255, 255, 0.5);\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.draw3d-numeric-input-body {\r\n    font-size: 90%;\r\n}\r\n\r\ndiv.draw3d-numeric-input-body > table {\r\n    width: 100%;\r\n}\r\n`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/Draw3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,cAAc;AAClB;;AAEA;IACI,WAAW;AACf\",\"sourcesContent\":[\"div.draw3d-numeric-input-body {\\r\\n    font-size: 90%;\\r\\n}\\r\\n\\r\\ndiv.draw3d-numeric-input-body > table {\\r\\n    width: 100%;\\r\\n}\\r\\n\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `#Compare3D div.compare3d-title {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 0 0.125em;\r\n}\r\n\r\n#Compare3D div.compare3d-title > span.icon {\r\n    margin-right: 0.5em;\r\n}\r\n\r\n#Compare3D div.compare3d-objects {\r\n    display: flex;\r\n    background-color: var(--list-bg-color);\r\n    margin: 0.25em;\r\n}\r\n\r\n#Compare3D div.compare3d-section {\r\n    flex: 1 1 auto;\r\n    border: 1px solid var(--border-color);\r\n}\r\n\r\n#Compare3D div.compare3d-section:first-child {\r\n    border-right: 1px solid var(--border-color);\r\n}\r\n\r\n#Compare3D div.compare3d-section:last-child {\r\n    border-left: 1px solid var(--border-color);\r\n}\r\n\r\n#Compare3D div.compare3d-item {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 0.25em;\r\n}\r\n\r\n#Compare3D div.compare3d-item-toggleall {\r\n    border-bottom: 1px solid var(--border-color);\r\n}\r\n\r\n#Compare3D span.compare3d-item-checkbox {\r\n    margin-right: 0.5em;\r\n    flex: 0 0 auto;\r\n}\r\n\r\n#Compare3D div.compare3d-title {\r\n    font-weight: bold;\r\n    margin: 0.25em;\r\n}\r\n\r\n#Compare3D table.compare3d-planeconfig {\r\n    width: 100%;\r\n    margin-bottom: 0.25em;\r\n}\r\n\r\n#Compare3D table.compare3d-planeconfig td {\r\n    padding: 0 0.25em 0 0.5em;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/Compare3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,aAAa;IACb,mBAAmB;IACnB,kBAAkB;AACtB;;AAEA;IACI,mBAAmB;AACvB;;AAEA;IACI,aAAa;IACb,sCAAsC;IACtC,cAAc;AAClB;;AAEA;IACI,cAAc;IACd,qCAAqC;AACzC;;AAEA;IACI,2CAA2C;AAC/C;;AAEA;IACI,0CAA0C;AAC9C;;AAEA;IACI,aAAa;IACb,mBAAmB;IACnB,eAAe;AACnB;;AAEA;IACI,4CAA4C;AAChD;;AAEA;IACI,mBAAmB;IACnB,cAAc;AAClB;;AAEA;IACI,iBAAiB;IACjB,cAAc;AAClB;;AAEA;IACI,WAAW;IACX,qBAAqB;AACzB;;AAEA;IACI,yBAAyB;AAC7B\",\"sourcesContent\":[\"#Compare3D div.compare3d-title {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    padding: 0 0.125em;\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-title > span.icon {\\r\\n    margin-right: 0.5em;\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-objects {\\r\\n    display: flex;\\r\\n    background-color: var(--list-bg-color);\\r\\n    margin: 0.25em;\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-section {\\r\\n    flex: 1 1 auto;\\r\\n    border: 1px solid var(--border-color);\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-section:first-child {\\r\\n    border-right: 1px solid var(--border-color);\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-section:last-child {\\r\\n    border-left: 1px solid var(--border-color);\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-item {\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n    padding: 0.25em;\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-item-toggleall {\\r\\n    border-bottom: 1px solid var(--border-color);\\r\\n}\\r\\n\\r\\n#Compare3D span.compare3d-item-checkbox {\\r\\n    margin-right: 0.5em;\\r\\n    flex: 0 0 auto;\\r\\n}\\r\\n\\r\\n#Compare3D div.compare3d-title {\\r\\n    font-weight: bold;\\r\\n    margin: 0.25em;\\r\\n}\\r\\n\\r\\n#Compare3D table.compare3d-planeconfig {\\r\\n    width: 100%;\\r\\n    margin-bottom: 0.25em;\\r\\n}\\r\\n\\r\\n#Compare3D table.compare3d-planeconfig td {\\r\\n    padding: 0 0.25em 0 0.5em;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n","// Imports\nimport ___CSS_LOADER_API_SOURCEMAP_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/sourceMaps.js\";\nimport ___CSS_LOADER_API_IMPORT___ from \"../../../../node_modules/css-loader/dist/runtime/api.js\";\nvar ___CSS_LOADER_EXPORT___ = ___CSS_LOADER_API_IMPORT___(___CSS_LOADER_API_SOURCEMAP_IMPORT___);\n// Module\n___CSS_LOADER_EXPORT___.push([module.id, `div.map3d-bottombar {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    height: 3em;\r\n    z-index: 100;\r\n    color: var(--panel-text-color);\r\n    background-color: var(--panel-bg-color);\r\n    box-shadow: 0 -2px 4px rgba(136, 136, 136, 0.5);\r\n    backdrop-filter: blur(3px);\r\n    font-size: 75%;\r\n    display: flex;\r\n    align-items: center;\r\n}\r\n\r\ndiv.map3d-bottombar-progress {\r\n    margin: 0.25em;\r\n    position: relative;\r\n    flex: 0 0 10em;\r\n    height: 2em;\r\n    border: 1px solid var(--border-color);\r\n    background-color: var(--border-color);\r\n}\r\n\r\ndiv.map3d-bottombar-spacer {\r\n    flex: 1 1 auto;\r\n}\r\n\r\ndiv.map3d-bottombar-progressbar {\r\n    position: absolute;\r\n    left: 0;\r\n    bottom: 0;\r\n    top: 0;\r\n    background-color: var(--color-active);\r\n}\r\n\r\ndiv.map3d-bottombar-progress-label {\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n    top: 0;\r\n    line-height: 2em;\r\n    text-align: center;\r\n    color: white;\r\n}\r\n\r\ndiv.map3d-bottombar-position {\r\n    margin-left: 0.5em;\r\n    border: 1px solid var(--border-color);\r\n    padding: 0.25em;\r\n    background-color: var(--input-bg-color);\r\n    flex: 0 0 15em;\r\n    text-align: center;\r\n    height: 2em;\r\n    cursor: text;\r\n}\r\n\r\ndiv.map3d-bottombar-projection {\r\n    border-color: var(--border-color);\r\n    border-style: solid;\r\n    border-width: 1px 1px 1px 0;\r\n    background-color: var(--input-bg-color);\r\n    padding: 0.25em 0.5em;\r\n    height: 2em;\r\n}`, \"\",{\"version\":3,\"sources\":[\"webpack://./qwc2/components/map3d/style/BottomBar3D.css\"],\"names\":[],\"mappings\":\"AAAA;IACI,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,SAAS;IACT,WAAW;IACX,YAAY;IACZ,8BAA8B;IAC9B,uCAAuC;IACvC,+CAA+C;IAC/C,0BAA0B;IAC1B,cAAc;IACd,aAAa;IACb,mBAAmB;AACvB;;AAEA;IACI,cAAc;IACd,kBAAkB;IAClB,cAAc;IACd,WAAW;IACX,qCAAqC;IACrC,qCAAqC;AACzC;;AAEA;IACI,cAAc;AAClB;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,SAAS;IACT,MAAM;IACN,qCAAqC;AACzC;;AAEA;IACI,kBAAkB;IAClB,OAAO;IACP,QAAQ;IACR,SAAS;IACT,MAAM;IACN,gBAAgB;IAChB,kBAAkB;IAClB,YAAY;AAChB;;AAEA;IACI,kBAAkB;IAClB,qCAAqC;IACrC,eAAe;IACf,uCAAuC;IACvC,cAAc;IACd,kBAAkB;IAClB,WAAW;IACX,YAAY;AAChB;;AAEA;IACI,iCAAiC;IACjC,mBAAmB;IACnB,2BAA2B;IAC3B,uCAAuC;IACvC,qBAAqB;IACrB,WAAW;AACf\",\"sourcesContent\":[\"div.map3d-bottombar {\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    height: 3em;\\r\\n    z-index: 100;\\r\\n    color: var(--panel-text-color);\\r\\n    background-color: var(--panel-bg-color);\\r\\n    box-shadow: 0 -2px 4px rgba(136, 136, 136, 0.5);\\r\\n    backdrop-filter: blur(3px);\\r\\n    font-size: 75%;\\r\\n    display: flex;\\r\\n    align-items: center;\\r\\n}\\r\\n\\r\\ndiv.map3d-bottombar-progress {\\r\\n    margin: 0.25em;\\r\\n    position: relative;\\r\\n    flex: 0 0 10em;\\r\\n    height: 2em;\\r\\n    border: 1px solid var(--border-color);\\r\\n    background-color: var(--border-color);\\r\\n}\\r\\n\\r\\ndiv.map3d-bottombar-spacer {\\r\\n    flex: 1 1 auto;\\r\\n}\\r\\n\\r\\ndiv.map3d-bottombar-progressbar {\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    bottom: 0;\\r\\n    top: 0;\\r\\n    background-color: var(--color-active);\\r\\n}\\r\\n\\r\\ndiv.map3d-bottombar-progress-label {\\r\\n    position: absolute;\\r\\n    left: 0;\\r\\n    right: 0;\\r\\n    bottom: 0;\\r\\n    top: 0;\\r\\n    line-height: 2em;\\r\\n    text-align: center;\\r\\n    color: white;\\r\\n}\\r\\n\\r\\ndiv.map3d-bottombar-position {\\r\\n    margin-left: 0.5em;\\r\\n    border: 1px solid var(--border-color);\\r\\n    padding: 0.25em;\\r\\n    background-color: var(--input-bg-color);\\r\\n    flex: 0 0 15em;\\r\\n    text-align: center;\\r\\n    height: 2em;\\r\\n    cursor: text;\\r\\n}\\r\\n\\r\\ndiv.map3d-bottombar-projection {\\r\\n    border-color: var(--border-color);\\r\\n    border-style: solid;\\r\\n    border-width: 1px 1px 1px 0;\\r\\n    background-color: var(--input-bg-color);\\r\\n    padding: 0.25em 0.5em;\\r\\n    height: 2em;\\r\\n}\"],\"sourceRoot\":\"\"}]);\n// Exports\nexport default ___CSS_LOADER_EXPORT___;\n"],"names":["___CSS_LOADER_EXPORT___","push","module","id","options","styleTagTransform","setAttributes","insert","domAPI","insertStyleElement","locals","BottomBar3D","_React$Component","_this","_classCallCheck","_len","arguments","length","args","Array","_key","_defineProperty","_callSuper","concat","cursorPosition","progress","ev","rect","currentTarget","getBoundingClientRect","x","clientX","left","width","y","clientY","top","height","clearTimeout","cursorPositionTimeout","setTimeout","getCursorPosition","intersection","props","sceneContext","getSceneIntersection","p","point","setState","z","el","setBottombarHeight","clientHeight","_inherits","key","value","_this2","this","scene","viewport","addEventListener","scheduleGetCursorPosition","Math","round","React","className","ref","storeHeight","style","state","map","toFixed","join","mapCrs","CoordinatesUtils","getAvailableCRS","label","PropTypes","connect","Compare3D","enabled","clippedObjects","planeX","planeY","planeA","Vector3","alpha","PI","normal","sin","cos","leftPlane","Plane","rightPlane","setFromNormalAndCoplanarPoint","multiplyScalar","Object","entries","forEach","_ref","_ref2","_slicedToArray","objectId","config","planes","right","clippingPlanes","getSceneObject","notifyChange","positionArrows","keys","active","disableArrows","addSceneObject","arrows","view","controls","centerArrowsInView","renderer","domElement","dragArrows","_this$props$sceneCont","_this$props$sceneCont2","removeEventListener","call","removeSceneObject","mousePos","event","target","Vector2","camera","raycaster","Raycaster","setFromCamera","intersectObject","plane","position","startPos","ray","intersectPlane","planePos","planeNormal","moveArrows","pos","delta","clone","copy","sub","dot","once","cameraTarget","dir","curPos","newPos","add","distance","distanceTo","scale","max","coordinates","Coordinates","result","getElevation","samples","sort","a","b","resolution","elevation","rotation","set","updateMatrixWorld","objects","_objectSpread","__terrain","layertree","title","LocaleUtils","tr","sceneObjects","objectIds","filter","role","onClick","toggleCompare","Icon","icon","section","clipState","toggleAllIcon","toggleAllValue","toggleAllState","reduce","res","_clipState$id","toggleAllObjects","disabled","_objects$objectId$tit","_clipState$objectId","_objects$objectId$tit2","toggleObject","NumberInput","onChange","suffix","newState","getAzimuthalAngle","_state$clippedObjects","GLTFLoader","load","gltf","traverse","object","isMesh","material","depthTest","depthWrite","renderOrder","leftArrow","rightArrow","Group","clearClippingPlane","obj","_obj$dispose","dispose","prevProps","prevState","enableArrows","updateClippingPlane","_this3","SideBar","body","renderBody","task","CreateTool3D","drawCursor","setPoints","button","drawShape","drawGroup","drawGroupId","points","geometry","s","baseSize","geomType","BoxGeometry","shape","Shape","moveTo","lineTo","ExtrudeGeometry","depth","CylinderGeometry","ConeGeometry","sqrt","toNonIndexed","computeVertexNormals","SphereGeometry","rotateX","MeshStandardMaterial","color","_construct","Color","_toConsumableArray","c","mesh","Mesh","objectCreated","GiroShape","showVertices","moveDrawCursor","drawShapeOnRelease","size","ColorButton","onColorChanged","colorChanged","min","mobile","baseSizeChanged","NumericInput3D","rot","selectedObject","toArray","slice","idx","_this$props$selectedO","apply","update","_this$props$selectedO2","newRot","order","_this$props$selectedO3","newScale","transformControls","getHelper","updateStateFromObject","document","createElement","parentElement","appendChild","removeChild","contents","ResizeableWindow","fitHeight","initialWidth","initialX","onClose","toggleNumericInput","scrollable","decimals","updatePosition","updateRotation","updateScale","ReactDOM","EditTool3D","mode","numericInput","dragging","selectShape","parent","objectPicked","reset","TransformControls","setMode","toolChanged","selectShapeOnRelease","onKeyDown","attach","updateTransformHelper","detach","setRGB","remove","editButtons","extraButtons","tooltip","ButtonBar","buttons","Draw3D","action","find","undefined","addDrawGroup","_ref3","_ref4","_ref5","_ref6","children","message","name","prompt","uuidv4","activeButton","drawButtons","data","drawGroups","_ref7","_ref8","_ref9","_ref0","createDrawGroup","actionChanged","renderControl","deleteSelectedObject","TaskBar","onHide","onShow","LayerTree3D","_entry$title","_entry$title2","entry","classes","classNames","visible","updateSceneObject","opacity","parseInt","step","type","colorLayers","visibility","updateColorLayer","Map3DLight","systemTime","timestamp","date","Date","year","getFullYear","month","String","getMonth","padStart","day","getDate","hours","getHours","minutes","getMinutes","getSeconds","ymd","hm","ToggleSwitch","toggleSystemTime","Input","updateDate","updateTime","setCurrentTimestamp","setTimestampTimeout","split","Number","setFullYear","setMonth","setDate","setHours","setMinutes","secondsRemaining","getMilliseconds","force","directionalLight","wgsPos","reproject","sunPos","suncalc","az","azimuth","alt","altitude","intensity","hillshading","zenith","elevationLayersOnly","render","now","setSeconds","componentDidUpdate","_prevProps$sceneConte","ambientLight","AmbientLight","DirectionalLight","updateLightPosition","lightPositionInterval","setInterval","clearInterval","MapControls3D","firstPerson","repeat","ctrlKey","tilt","pan","leaveFirstPerson","extent","bounds","west","south","east","north","setViewToExtent","dx","dy","keyboard","d","animationInterrupted","lastTimestamp","animate","k","_pan","requestAnimationFrame","yaw","_rotateUp","_rotateLeft","camerapos","oldPosition","oldYaw","newPosition","startTime","elapsed","currentPosition","lerpVectors","applyAxisAngle","_elevationResult$samp","angle","center","elevationResult","fov","cameraHeight","tan","oldTarget","newTarget","rotateAngle","_terrInter$point$z","_terrInter$point","prevTarget","distanceToSquared","terrInter","intersectObjects","object3d","terrainHeight","personHeight","targetHeight","setupFirstPerson","mouseX","mouseY","getTerrainHeight","then","maxPolarAngle","panSpeed","enableZoom","cameraPos","sceneElement","tabIndex","MapControls","zoomToCursor","enableDamping","dampingFactor","keyHandler","setControls","targetPos","updateControlsTarget","switchToFirstPersonView","firstPersonButtonClasses","onMouseDown","home","resetTilt","toggleFirstPersonControls","e","t","r","Symbol","n","iterator","o","toStringTag","i","prototype","Generator","u","create","_regeneratorDefine2","f","G","v","bind","l","TypeError","done","GeneratorFunction","GeneratorFunctionPrototype","getPrototypeOf","setPrototypeOf","__proto__","displayName","_regenerator","w","m","defineProperty","_invoke","enumerable","configurable","writable","asyncGeneratorStep","Promise","resolve","_extends","assign","hasOwnProperty","ownKeys","getOwnPropertySymbols","getOwnPropertyDescriptor","getOwnPropertyDescriptors","defineProperties","_arrayLikeToArray","_defineProperties","_toPropertyKey","_getPrototypeOf","_typeof","ReferenceError","_assertThisInitialized","_possibleConstructorReturn","_isNativeReflectConstruct","Reflect","construct","constructor","Boolean","valueOf","_setPrototypeOf","toPrimitive","_toPrimitive","MapExport3D","minimized","selectedFormat","layout","exporting","_this$props$theme","isEmpty","theme","print","layouts","localeCompare","numeric","item","_this$state$layout","_this$state$layout2","_this$state$layout3","exportDisabled","mapName","onSubmit","formatChanged","isArray","_arrayWithHoles","next","_iterableToArrayLimit","toString","from","test","_unsupportedIterableToArray","_nonIterableRest","format","layoutChanged","pop","labels","_this$props$theme$pri","startsWith","opts","rows","toUpperCase","printLabelConfig","renderPrintLabelField","MiscUtils","getCsrfToken","readOnly","version","Spinner","boxStyle","onPointerDown","startSelection","shiftKey","pointerEvents","userSelect","dispatchEvent","PointerEvent","constrainRatio","ratio","onMouseMove","preventDefault","form","_this$state","toDataURL","canvas","ctx","getContext","img","Image","src","onload","drawImage","toBlob","blob","arrayBuffer","imgBuffer","exportToPdf","imageData","getImageData","Blob","utif","FileSaver","replace","defaultValue","autopopulated","printLabelForSearchResult","getSearchMarkerLabel","printLabelForAttribution","getAttributionLabel","hideAutopopulatedFields","colSpan","capitalizeFirst","cols","resize","minMaxTooltip","minMaxIcon","extraTitlebarContent","extraClasses","extra","renderExportFrame","_callee","formData","response","_yield$import","PDFDocument","doc","page","pngImage","pdfData","_context","formDataEntries","FormData","fromEntries","extraPrintParameters","pair","encodeURIComponent","headers","responseType","axios","post","printUrl","getPages","embedPng","save","alert","_exportToPdf","_next","_throw","_x","_x2","setCurrentTask","ChartJS","register","CategoryScale","LinearScale","PointElement","LineElement","Title","Tooltip","Filler","HeightProfilePrintDialog","_React$PureComponent","initialized","imageUrl","externalWindow","close","container","getElementById","printBtn","marginBottom","innerHTML","imageEl","portalEl","overflowX","refreshTimeout","refreshImage","offsetWidth","chart","_createClass","templatePath","resolveAssetsPath","window","open","setWindowContent","windowResized","closePrintWindow","scheduleRefreshImage","HeightProfile","printdialog","marker","saveRef","interactive","distanceStr","heightStr","aslStr","datasets","fill","backgroundColor","borderColor","borderWidth","pointRadius","totLength","maxHeight","stepSizeFact","pow","ceil","log10","stepSize","prec","heightProfilePrecision","responsive","maintainAspectRatio","animation","duration","plugins","legend","display","intersect","displayColors","bodyFont","weight","callbacks","MeasureUtils","formatMeasurement","parsed","scales","ticks","font","callback","text","padding","onHover","evt","activeEls","chartArea","chartX","updateMarker","onMouseLeave","hideMarker","Line","dist","findIndex","lambda","csv","sample","profilePrintWindow","showVertexLabels","showLine","vertexLabelFormatter","_this4","extraControls","exportProfile","dockable","initialHeight","initiallyDocked","onExternalWindowResized","resizeChart","splitScreenWhenDocked","usePortal","renderHeightProfile","Measure3D","lenUnit","areaUnit","elevUnit","abortController","AbortController","measureTool","DrawTool","instance","drawLayer","ColorLayer","source","VectorSource","ol","GeoJSON","featureStyleFunction","addLayer","clearResult","abort","removeLayer","unitSelector","getFormattedCoordinate","ConfigUtils","getConfigProp","ground","CopyButton","Style","Fill","stroke","Stroke","clear","measurementObjects","signal","endCondition","conditions","doubleClick","createPoint","measurePoint","createLineString","measureLine","createPolygon","measureArea","createVerticalMeasure","measureHeight","elevationLabelFormatter","index","restart","lineString","features","readFeatures","toGeoJSON","dataProjection","featureProjection","addFeatures","path","CurvePath","len2d","v0","v1","line","LineCurve","nSamples","maxSampleCount","minMeasureLength","getSpacedPoints","line3d","len3d","dz","profile","polygon","bbox","quadSize","numX","numY","deltaX","deltaY","area","elevationCache","iX","iY","_elevationCache","_elevationCache2","_elevationCache3","_elevationCache4","pointInPolygon","z1","z2","z3","z4","abs","triangleArea","cross","rebuildLabels","_this$state$result","renderModeSwitcher","renderResult","HeightProfile3D","OverviewMap3D","collapsed","Map","layers","viewConeLayer","setupView","overviewView","View","enableRotation","projection","setView","updateViewCone","_scene$view$controls$","_scene$view$controls","_scene$view$controls$2","getView","setCenter","setResolution","viewConeFeature","getGeometry","setCoordinates","getSource","changed","Feature","geom","Point","layer","Vector","feature","image","anchor","anchorXUnits","anchorYUnits","get","zIndex","initOverviewMap","baseLayer","OlLayer","SearchField3D","_result$crs","_result$feature","scenePos","crs","_result$crs2","olFeatures","highlightLayer","feat","FeatureStyles","VectorLayerUtils","computeFeatureBBox","bbWidth","bbHeight","sceneRect","px2m","minWidth","searchMinScaleDenom","minHeight","bbCenterX","bbCenterY","_result$label","searchMarker","pin","labelEl","innerText","CSS2DObject","scaleSearchMarker","parentNode","SearchWidget","queryGeometries","resultSelected","searchResultSelected","searchParams","mapcrs","displaycrs","searchProviders","values","TopBar3D","setTopbarHeight","AppMenu","appMenuClearsTask","buttonContents","menuButtonContents","menuItems","create3d","createFeatures","styleFunction","styleName","styleOptions","update3d","newOptions","oldOptions","setStyle","updateFeatures","rev","queryParameters","wmsToOpenlayersOptions","__t","TiledImageSource","TileWMS","url","params","tileLoadFunction","imageTile","wmsImageLoadFunction","getImage","_layer$source","updateParams","oldParams","newParams","__updateTimeout","LAYERS","createWMTSSource","vector","vectorLayer","wms","wmsLayer","wmts","wmtsLayer","UnloadWrapper","onUnload","sceneId","Map3D","_React$Component2","defaultSceneState","getLayer","layerId","baseLayers","layerCreator","LayerRegistry","layer3d","insertLayerAfter","prevColorLayers","prevLayersMap","_prevLayer$visibility","_prevLayer$opacity","LayerRole","THEME","USERLAYER","prevLayer","prevLayers","layersMap","reverse","mapLayer","objectMap","userData","_this2$map$getLayers$","getLayers","diff","sceneObjectGroup","objectState","newSceneObjects","setupInstance","_this2$props$theme$ma","_this2$props$theme$ma2","_this2$props$theme$ma3","_this2$props$theme$ma6","_this2$props$theme$ma7","disposeInstance","setMapCrs","Instance","clearColor","preserveDrawingBuffer","reprojectBbox","Extent","cubeTextureLoader","CubeTextureLoader","setPath","getAssetsPath","cubeTexture","background","demUrl","map3d","dtm","location","href","substr","demCrs","_this2$props$theme$ma4","_this2$props$theme$ma5","demSource","GeoTIFFSource","demMin","demMax","elevationLayer","ElevationLayer","minmax","visibleBaseLayer","basemaps","bl","setBaseLayer","collectColorLayers","tiles3d","tilesUrl","tiles","Tiles3D","Tiles3DSource","dtmUrl","dtmCrs","uuidv1","inspector","disposeLayers","_instance$setViewToEx","mapBBox","dtmPos","fromUrl","tiff","_image$fileDirectory","fileDirectory","ModelTiepoint","ModelPixelScale","scaleX","scaleY","tiepointX","tiepointY","pixelX","pixelY","readRasters","raster","objInter","getEntities","entity","innerWidth","innerHeight","setSize","aspect","updateProjectionMatrix","innerRef","applyBaseLayer","applyColorLayerUpdates","applySceneObjectUpdates","marginTop","mapMargins","marginRight","bottom","marginLeft","stopAnimations","setupContainer","setupControls","BackgroundSwitcher","bottombarHeight","changeLayerVisibility","initialY","windows"],"ignoreList":[],"sourceRoot":""}